"use strict";(self.webpackChunkknowledgebuilder=self.webpackChunkknowledgebuilder||[]).push([[90],{90:(ko,G,c)=>{c.r(G),c.d(G,{HabitBuilderModule:()=>Oo});var A=c(9808),r=c(3075),x=c(7455),dt=c(7607),_t=c(558),$=c(9560),F=c(4521),t=c(5e3),M=c(6087),y=c(4847),gt=c(5439),q=c.n(gt),E=c(6451),j=c(9646),V=c(8675),z=c(3900),X=c(8746),W=c(4004),K=c(262),m=c(9144),b=c(3984),H=c(8966),R=c(4594),D=c(7423),J=c(7238),Q=c(5245),s=c(8279);function Ct(e,a){1&e&&(t.TgZ(0,"th",18),t._uU(1,"#"),t.qZA())}function ft(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",19),t._uU(1),t.TgZ(2,"button",1),t.NdJ("click",function(){const l=t.CHM(o).$implicit;return t.oxw().onDisplayHabit(l.ID)}),t.ALo(3,"transloco"),t.TgZ(4,"mat-icon"),t._uU(5,"launch"),t.qZA(),t.qZA(),t.TgZ(6,"button",20),t.NdJ("click",function(){const l=t.CHM(o).$implicit;return t.oxw().onDeleteHabit(l.ID)}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"remove_circle"),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(1),t.hij("",o.ID," | "),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,3,"Common.Display")),t.xp6(4),t.s9C("matTooltip",t.lcZ(7,5,"Common.Delete"))}}function ht(e,a){1&e&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function Zt(e,a){if(1&e&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&e){const o=a.$implicit,i=t.oxw();t.xp6(1),t.AsE("",i.getUserDisplayAs(o.targetUser)," (",o.targetUser,")")}}function bt(e,a){1&e&&(t.TgZ(0,"th",21),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Name")))}function Tt(e,a){if(1&e&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.name)}}function At(e,a){1&e&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Type")))}function qt(e,a){if(1&e&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit,i=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,i.getHabitCategoryName(o.category)))}}function vt(e,a){1&e&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.Frequency")))}function Ut(e,a){if(1&e&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit,i=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,i.getHabitFrequencyName(o.frequency)))}}function xt(e,a){1&e&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.CompleteCategory")))}function Ht(e,a){if(1&e&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit,i=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,i.getHabitCompleteCategoryName(o.completeCategory)))}}function Dt(e,a){1&e&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Validity")))}function yt(e,a){if(1&e&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.validity)}}function wt(e,a){1&e&&t._UZ(0,"tr",22)}function Nt(e,a){1&e&&t._UZ(0,"tr",23)}let tt=(()=>{class e{constructor(o,i,n){this.odataSrv=o,this.dialog=i,this.uiUtilSrv=n,this.dataSource=[],this.displayedColumns=["id","targetUser","name","category","frequency","compCategory","validity"],this.recordCount=0,this.isLoadingResults=!1,this.refreshEvent=new t.vpe}ngOnInit(){this.refreshList()}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,E.T)(this.sort.sortChange,this.paginator.page,this.refreshEvent).pipe((0,V.O)({}),(0,z.w)(()=>{const o=this.paginator.pageSize,i=o*this.paginator.pageIndex;let n=q()().format(m.Jt);return this.odataSrv.getUserHabits(o,i,this.sort.active,this.sort.direction,`ValidFrom le ${n} and ValidTo ge ${n}`)}),(0,X.x)(()=>this.isLoadingResults=!1),(0,W.U)(o=>(this.recordCount=o.totalCount,o.items)),(0,K.K)(()=>(0,j.of)([]))).subscribe({next:o=>this.dataSource=o,error:o=>this.uiUtilSrv.showSnackInfo(o)})}getHabitCategoryName(o){return(0,m.xk)(o)}getHabitCompleteCategoryName(o){return(0,m.E0)(o)}getHabitFrequencyName(o){return(0,m.lC)(o)}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const i=this.odataSrv.currentUserDetail.awardUsers.findIndex(n=>n.targetUser===o);if(-1!==i)return this.odataSrv.currentUserDetail.awardUsers[i].displayAs}return""}onCreateHabit(){this.uiUtilSrv.navigateHabitCreatePage()}resetPaging(){this.paginator.pageIndex=0}refreshList(){this.refreshEvent.emit()}onDeleteHabit(o){this.odataSrv.deleteUserHabit(o).subscribe({next:i=>{this.refreshList()},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})}onDisplayHabit(o){this.uiUtilSrv.navigateHabitDisplayPage(o)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(b.CB),t.Y36(H.uw),t.Y36(b.dM))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-habit-list"]],viewQuery:function(o,i){if(1&o&&(t.Gf(M.NW,5),t.Gf(y.YE,5)),2&o){let n;t.iGM(n=t.CRH())&&(i.paginator=n.first),t.iGM(n=t.CRH())&&(i.sort=n.first)}},decls:36,vars:11,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary",3,"matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","targetUser"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","category"],["matColumnDef","frequency"],["matColumnDef","compCategory"],["matColumnDef","validity"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","warn",3,"matTooltip","click"],["mat-header-cell","","mat-sort-header",""],["mat-header-row",""],["mat-row",""]],template:function(o,i){1&o&&(t.TgZ(0,"mat-toolbar"),t.TgZ(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.TgZ(5,"button",1),t.NdJ("click",function(){return i.onCreateHabit()}),t.ALo(6,"transloco"),t.TgZ(7,"mat-icon"),t._uU(8,"add_circle"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",2),t.TgZ(10,"div",3),t.TgZ(11,"table",4),t.NdJ("matSortChange",function(){return i.resetPaging()}),t.ynx(12,5),t.YNc(13,Ct,2,0,"th",6),t.YNc(14,ft,10,7,"td",7),t.BQk(),t.ynx(15,8),t.YNc(16,ht,3,3,"th",6),t.YNc(17,Zt,2,2,"td",7),t.BQk(),t.ynx(18,9),t.YNc(19,bt,3,3,"th",10),t.YNc(20,Tt,2,1,"td",7),t.BQk(),t.ynx(21,11),t.YNc(22,At,3,3,"th",6),t.YNc(23,qt,3,3,"td",7),t.BQk(),t.ynx(24,12),t.YNc(25,vt,3,3,"th",6),t.YNc(26,Ut,3,3,"td",7),t.BQk(),t.ynx(27,13),t.YNc(28,xt,3,3,"th",6),t.YNc(29,Ht,3,3,"td",7),t.BQk(),t.ynx(30,14),t.YNc(31,Dt,3,3,"th",6),t.YNc(32,yt,2,1,"td",7),t.BQk(),t.YNc(33,wt,1,0,"tr",15),t.YNc(34,Nt,1,0,"tr",16),t.qZA(),t.qZA(),t._UZ(35,"mat-paginator",17),t.qZA()),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,7,"Habit.Habits")),t.xp6(3),t.s9C("matTooltip",t.lcZ(6,9,"Common.Create")),t.xp6(6),t.Q6J("dataSource",i.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.recordCount)("pageSize",20))},directives:[R.Ye,D.lW,J.gM,Q.Hw,s.BZ,y.YE,s.w1,s.fO,s.ge,s.Dz,s.ev,y.nU,s.as,s.XQ,s.nj,s.Gk,M.NW],pipes:[x.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}"]}),e})();var f=c(3778),T=c(9224),g=c(3489),w=c(4107),N=c(508),k=c(7531),C=c(6856);function Ot(e,a){if(1&e&&(t.TgZ(0,"mat-option",27),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.targetUser),t.xp6(1),t.Oqu(o.displayAs)}}function Lt(e,a){if(1&e&&(t.TgZ(0,"mat-option",27),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.value),t.xp6(1),t.Oqu(t.lcZ(2,2,o.i18nterm))}}function St(e,a){if(1&e&&(t.TgZ(0,"mat-option",27),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij("",t.lcZ(2,2,o.i18nterm)," ")}}function Rt(e,a){1&e&&(t.TgZ(0,"th",28),t._uU(1,"#"),t.qZA())}function kt(e,a){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.ruleID)}}function Pt(e,a){1&e&&(t.TgZ(0,"th",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.ContinuousCompletedCounts")))}function Ft(e,a){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.continuousCompletedCounts)}}function Mt(e,a){1&e&&(t.TgZ(0,"th",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function It(e,a){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.point)}}function Yt(e,a){1&e&&t._UZ(0,"tr",30)}function Jt(e,a){1&e&&t._UZ(0,"tr",31)}let et=(()=>{class e{constructor(o,i,n,l){this.activateRoute=o,this._formBuilder=i,this.uiUtilSrv=n,this.odataSrv=l,this.routerID=-1,this.uiMode=f.sk.Display,this.currentMode="Common.Display",this.arCategories=[],this.arFrequencies=[],this.arCompleteCategories=[],this.currentObject=new m.ke,this.displayedColumns=["ruleID","completedCountRange","point"],this.arCategories=(0,m.ZP)(),this.arFrequencies=(0,m.AX)(),this.arCompleteCategories=(0,m.nX)(),this.detailFormGroup=this._formBuilder.group({targetuserCtrl:["",r.kI.required],nameCtrl:["",r.kI.required],ctgyCtrl:[m.cb.Positive,r.kI.required],validFromCtrl:[void 0,r.kI.required],validToCtrl:[void 0,r.kI.required],freqCtrl:[m.Hs.Daily,r.kI.required],compCtgyCtrl:[m.Kd.NumberOfTimes,r.kI.required],compCondCtrl:[0],startDateCtrl:[void 0]})}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const i=this.odataSrv.currentUserDetail.awardUsers.findIndex(n=>n.targetUser===o);if(-1!==i)return this.odataSrv.currentUserDetail.awardUsers[i].displayAs}return""}get isDisplayMode(){return this.uiMode===f.sk.Display}get isUpdateMode(){return this.uiMode===f.sk.Update}get isEditable(){return this.uiMode===f.sk.Update}ngOnInit(){this.activateRoute.url.subscribe({next:o=>{o instanceof Array&&o.length>0&&("display"===o[0].path?(this.uiMode=f.sk.Display,this.currentMode="Common.Display",this.routerID=+o[1].path):"edit"===o[0].path&&(this.uiMode=f.sk.Update,this.currentMode="Common.Change",this.routerID=+o[1].path)),-1!==this.routerID&&this.odataSrv.readUserHabit(this.routerID).subscribe({next:i=>{var n,l,u,d,p,h,Z,U;this.currentObject=i,null===(n=this.detailFormGroup.get("targetuserCtrl"))||void 0===n||n.setValue(this.currentObject.targetUser),null===(l=this.detailFormGroup.get("nameCtrl"))||void 0===l||l.setValue(this.currentObject.name),null===(u=this.detailFormGroup.get("validFromCtrl"))||void 0===u||u.setValue(this.currentObject.validFrom),null===(d=this.detailFormGroup.get("validToCtrl"))||void 0===d||d.setValue(this.currentObject.validTo),null===(p=this.detailFormGroup.get("freqCtrl"))||void 0===p||p.setValue(this.currentObject.frequency),null===(h=this.detailFormGroup.get("compCtgyCtrl"))||void 0===h||h.setValue(this.currentObject.completeCategory),null===(Z=this.detailFormGroup.get("compCondCtrl"))||void 0===Z||Z.setValue(this.currentObject.completeCondition),null===(U=this.detailFormGroup.get("startDateCtrl"))||void 0===U||U.setValue(this.currentObject.startDate),this.uiMode===f.sk.Display?this.detailFormGroup.disable():(this.detailFormGroup.enable(),this.detailFormGroup.markAsPristine())},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})},error:o=>{this.uiUtilSrv.showSnackInfo(o)}})}onSave(){}onBackToList(){this.uiUtilSrv.navigateHabitListPage()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(F.gz),t.Y36(r.qu),t.Y36(b.dM),t.Y36(b.CB))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-habit-detail"]],decls:74,vars:43,consts:[[3,"formGroup"],["appearance","fill",1,"control-full-width"],["required","","formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["matInput","","required","","formControlName","nameCtrl"],["appearance","fill"],[3,"rangePicker"],["matStartDate","","formControlName","validFromCtrl","placeholder","Start date"],["matEndDate","","formControlName","validToCtrl","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],["required","","formControlName","freqCtrl"],["required","","formControlName","compCtgyCtrl"],["matInput","","required","","type","number","formControlName","compCondCtrl"],["matInput","","required","","type","number","formControlName","startDateCtrl"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","ruleID"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","completedCountRange"],["matColumnDef","point"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","","color","primary",3,"disabled","click"],["mat-button","",3,"click"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(o,i){if(1&o&&(t.TgZ(0,"mat-card"),t.TgZ(1,"mat-card-header"),t.TgZ(2,"mat-card-title"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.ALo(7,"transloco"),t.qZA(),t.qZA(),t.TgZ(8,"mat-card-content"),t.TgZ(9,"form",0),t.TgZ(10,"mat-form-field",1),t.TgZ(11,"mat-label"),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"mat-select",2),t.YNc(15,Ot,2,2,"mat-option",3),t.qZA(),t.qZA(),t.TgZ(16,"mat-form-field",1),t.TgZ(17,"mat-label"),t._uU(18),t.ALo(19,"transloco"),t.qZA(),t._UZ(20,"input",4),t.qZA(),t.TgZ(21,"mat-form-field",5),t.TgZ(22,"mat-label"),t._uU(23),t.ALo(24,"transloco"),t.qZA(),t.TgZ(25,"mat-date-range-input",6),t._UZ(26,"input",7),t._UZ(27,"input",8),t.qZA(),t._UZ(28,"mat-datepicker-toggle",9),t._UZ(29,"mat-date-range-picker",null,10),t.qZA(),t.TgZ(31,"mat-form-field",1),t.TgZ(32,"mat-label"),t._uU(33),t.ALo(34,"transloco"),t.qZA(),t.TgZ(35,"mat-select",11),t.YNc(36,Lt,3,4,"mat-option",3),t.qZA(),t.qZA(),t.TgZ(37,"mat-form-field",1),t.TgZ(38,"mat-label"),t._uU(39),t.ALo(40,"transloco"),t.qZA(),t.TgZ(41,"mat-select",12),t.YNc(42,St,3,4,"mat-option",3),t.qZA(),t.qZA(),t.TgZ(43,"mat-form-field",1),t.TgZ(44,"mat-label"),t._uU(45),t.ALo(46,"transloco"),t.qZA(),t._UZ(47,"input",13),t.qZA(),t.TgZ(48,"mat-form-field",1),t.TgZ(49,"mat-label"),t._uU(50),t.ALo(51,"transloco"),t.qZA(),t._UZ(52,"input",14),t.qZA(),t.qZA(),t.TgZ(53,"div",15),t.TgZ(54,"div",16),t.TgZ(55,"table",17),t.ynx(56,18),t.YNc(57,Rt,2,0,"th",19),t.YNc(58,kt,2,1,"td",20),t.BQk(),t.ynx(59,21),t.YNc(60,Pt,3,3,"th",19),t.YNc(61,Ft,2,1,"td",20),t.BQk(),t.ynx(62,22),t.YNc(63,Mt,3,3,"th",19),t.YNc(64,It,2,1,"td",20),t.BQk(),t.YNc(65,Yt,1,0,"tr",23),t.YNc(66,Jt,1,0,"tr",24),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(67,"mat-card-actions"),t.TgZ(68,"button",25),t.NdJ("click",function(){return i.onSave()}),t._uU(69),t.ALo(70,"transloco"),t.qZA(),t.TgZ(71,"button",26),t.NdJ("click",function(){return i.onBackToList()}),t._uU(72),t.ALo(73,"transloco"),t.qZA(),t.qZA(),t.qZA()),2&o){const n=t.MAs(30);t.xp6(3),t.Oqu(t.lcZ(4,21,"Habit.Habit")),t.xp6(3),t.Oqu(t.lcZ(7,23,i.currentMode)),t.xp6(3),t.Q6J("formGroup",i.detailFormGroup),t.xp6(3),t.Oqu(t.lcZ(13,25,"Award.TargetUser")),t.xp6(3),t.Q6J("ngForOf",i.arTargetUsers),t.xp6(3),t.Oqu(t.lcZ(19,27,"Common.Name")),t.xp6(5),t.Oqu(t.lcZ(24,29,"Award.Validity")),t.xp6(2),t.Q6J("rangePicker",n),t.xp6(3),t.Q6J("for",n),t.xp6(5),t.Oqu(t.lcZ(34,31,"Habit.Frequency")),t.xp6(3),t.Q6J("ngForOf",i.arFrequencies),t.xp6(3),t.Oqu(t.lcZ(40,33,"Habit.CompleteCategory")),t.xp6(3),t.Q6J("ngForOf",i.arCompleteCategories),t.xp6(3),t.Oqu(t.lcZ(46,35,"Habit.CompleteCondition")),t.xp6(5),t.Oqu(t.lcZ(51,37,"Habit.StartDate")),t.xp6(5),t.Q6J("dataSource",i.currentObject.arRules),t.xp6(10),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(2),t.Q6J("disabled",i.isDisplayMode),t.xp6(1),t.Oqu(t.lcZ(70,39,"Common.Save")),t.xp6(3),t.Oqu(t.lcZ(73,41,"Common.ReturnToList"))}},directives:[T.a8,T.dk,T.n5,T.$j,T.dn,r._Y,r.JL,r.sg,g.KE,g.hX,w.gD,r.Q7,r.JJ,r.u,A.sg,N.ey,k.Nt,r.Fj,C.wx,C.zY,C.By,C.nW,g.R9,C._g,r.wV,s.BZ,s.w1,s.fO,s.ge,s.Dz,s.ev,s.as,s.XQ,s.nj,s.Gk,T.hq,D.lW],pipes:[x.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:200px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}"]}),e})();var v=c(5615),ot=c(4623);function Qt(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Habit.Habit"))}function Bt(e,a){if(1&e&&(t.TgZ(0,"mat-option",38),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.targetUser),t.xp6(1),t.Oqu(o.displayAs)}}function Gt(e,a){if(1&e&&(t.TgZ(0,"mat-option",38),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.value),t.xp6(1),t.Oqu(t.lcZ(2,2,o.i18nterm))}}function $t(e,a){if(1&e&&(t.TgZ(0,"mat-option",38),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij("",t.lcZ(2,2,o.i18nterm)," ")}}function Et(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Habit.ContinuousCompletedCounts"))}function jt(e,a){if(1&e&&(t.TgZ(0,"mat-list",39),t.TgZ(1,"mat-list-item"),t._uU(2),t.qZA(),t.qZA()),2&e){const o=a.$implicit;t.xp6(2),t.Oqu(o.toString())}}function Vt(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Award.Point"))}function zt(e,a){1&e&&(t.TgZ(0,"th",40),t._uU(1,"ID"),t.qZA())}function Xt(e,a){if(1&e&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.ruleID)}}function Wt(e,a){1&e&&(t.TgZ(0,"th",40),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.ContinuousDays")))}function Kt(e,a){if(1&e&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.continuousDays)}}function te(e,a){1&e&&(t.TgZ(0,"th",40),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function ee(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",41),t.TgZ(1,"mat-form-field",42),t.TgZ(2,"input",43),t.NdJ("ngModelChange",function(n){return t.CHM(o).$implicit.point=n})("ngModelChange",function(n){return t.CHM(o),t.oxw().onPointCellChanged(n)}),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(2),t.Q6J("ngModel",o.point)}}function oe(e,a){1&e&&t._UZ(0,"tr",44)}function ie(e,a){1&e&&t._UZ(0,"tr",45)}function ae(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Common.Done"))}class it{constructor(){this.from=0,this.to=0}toString(){return`[${this.from} - ${this.to})`}}const at=e=>{var a,o,i,n,l,u,d,p,h,Z,U,O,P,L,S;const _=new m.ke;switch(_.category=m.cb.Positive,_.targetUser=null===(a=e.get("targetuserCtrl"))||void 0===a?void 0:a.value,_.validFrom=q()(null===(o=e.get("validFromCtrl"))||void 0===o?void 0:o.value),_.validTo=q()(null===(i=e.get("validToCtrl"))||void 0===i?void 0:i.value),_.name=null===(n=e.get("nameCtrl"))||void 0===n?void 0:n.value,_.frequency=null===(l=e.get("freqCtrl"))||void 0===l?void 0:l.value,_.completeCategory=null===(u=e.get("compCtgyCtrl"))||void 0===u?void 0:u.value,_.frequency){case m.Hs.Weekly:_.completeCategory===m.Kd.NumberOfCount?(_.startDate=null===(d=e.get("startDateCtrl"))||void 0===d?void 0:d.value,_.completeCondition=null===(p=e.get("compCondCtrl"))||void 0===p?void 0:p.value):(_.startDate=null===(h=e.get("startDateCtrl"))||void 0===h?void 0:h.value,_.completeCondition=null===(Z=e.get("compCondCtrl"))||void 0===Z?void 0:Z.value);break;case m.Hs.Monthly:_.completeCategory===m.Kd.NumberOfCount?(_.startDate=null===(U=e.get("startDateCtrl"))||void 0===U?void 0:U.value,_.completeCondition=null===(O=e.get("compCondCtrl"))||void 0===O?void 0:O.value):(_.startDate=null===(P=e.get("startDateCtrl"))||void 0===P?void 0:P.value,_.completeCondition=null===(L=e.get("compCondCtrl"))||void 0===L?void 0:L.value);break;default:_.completeCategory===m.Kd.NumberOfCount?(_.startDate=void 0,_.completeCondition=null===(S=e.get("compCondCtrl"))||void 0===S?void 0:S.value):(_.startDate=void 0,_.completeCondition=1)}return _},ne=e=>at(e).isValid?null:{invalidInputs:!0};let re=(()=>{class e{constructor(o,i,n){this._formBuilder=o,this.uiUtilSrv=i,this.odataSrv=n,this.arRuleTypes=[],this.contDays=[],this.arRules=[],this.displayedColumns=["ruleID","continuousDays","point"],this.pointCompleted=!1,this.createdHabitID=-1,this.arCategories=[],this.arFrequencies=[],this.arCompleteCategories=[],this.arCategories=(0,m.ZP)(),this.arFrequencies=(0,m.AX)(),this.arCompleteCategories=(0,m.nX)(),this.currentObject=new m.ke,this.firstFormGroup=this._formBuilder.group({targetuserCtrl:new r.NI(""),nameCtrl:new r.NI("",r.kI.required),validFromCtrl:new r.NI(q()(),r.kI.required),validToCtrl:new r.NI(q()(),r.kI.required),freqCtrl:new r.NI(m.Hs.Weekly,r.kI.required),compCtgyCtrl:new r.NI(m.Kd.NumberOfTimes,r.kI.required),compCondCtrl:new r.NI,startDateCtrl:new r.NI},{validators:ne}),this.secondFormGroup=this._formBuilder.group({rawCtrl:new r.NI("",r.kI.required)})}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const i=this.odataSrv.currentUserDetail.awardUsers.findIndex(n=>n.targetUser===o);if(-1!==i)return this.odataSrv.currentUserDetail.awardUsers[i].displayAs}return""}ngOnInit(){var o,i,n;null===(o=this.firstFormGroup.get("freqCtrl"))||void 0===o||o.valueChanges.subscribe(l=>{this.onFreqencyAndCompleteCategoryChange(l)}),null===(i=this.firstFormGroup.get("compCtgyCtrl"))||void 0===i||i.valueChanges.subscribe(l=>{this.onFreqencyAndCompleteCategoryChange(l)}),null===(n=this.secondFormGroup.get("rawCtrl"))||void 0===n||n.valueChanges.subscribe(l=>{this.onContDayChange(l)})}onFreqencyAndCompleteCategoryChange(o){var i,n,l,u,d,p,h;const Z=null===(i=this.firstFormGroup.get("compCtgyCtrl"))||void 0===i?void 0:i.value;(null===(n=this.firstFormGroup.get("freqCtrl"))||void 0===n?void 0:n.value)===m.Hs.Daily?(Z===m.Kd.NumberOfTimes?null===(l=this.firstFormGroup.get("compCondCtrl"))||void 0===l||l.disable():null===(u=this.firstFormGroup.get("compCondCtrl"))||void 0===u||u.enable(),null===(d=this.firstFormGroup.get("startDateCtrl"))||void 0===d||d.disable()):(null===(p=this.firstFormGroup.get("compCondCtrl"))||void 0===p||p.enable(),null===(h=this.firstFormGroup.get("startDateCtrl"))||void 0===h||h.enable())}onContDayChange(o){if(this.contDays=[],o){let n=o.split(";").map(d=>{if(d){const p=+d;if(!isNaN(p)&&p>0)return Math.trunc(p)}return 0});n=n.filter(d=>d>0),n.sort();let l=0;n.forEach(d=>{if(0!==l){const p=new it;p.from=l,p.to=d,this.contDays.push(p)}l=d});const u=new it;u.from=l,u.to=9999,this.contDays.push(u)}}onPointCellChanged(o){let i=0;this.arRules.forEach(n=>{(isNaN(n.point)||0===n.point)&&i++}),this.pointCompleted=0===i}onInitialRules(){this.arRules=[],this.contDays.forEach((o,i)=>{let n=new m.hp;n.ruleID=i+1,n.continuousRecordFrom=o.from,n.continuousRecordTo=o.to,this.arRules.push(n)})}onSave(){let o=at(this.firstFormGroup);!o.isValid||(this.arRules.forEach(i=>{o.arRules.push(i)}),this.odataSrv.createUserHabit(o).subscribe({next:i=>{i&&i.ID&&(this.createdHabitID=i.ID)},error:i=>{this.uiUtilSrv.showSnackInfo(i,1e3)}}))}onGoToList(){this.uiUtilSrv.navigateHabitListPage()}onDisplayHabit(){this.createdHabitID&&this.uiUtilSrv.navigateHabitDisplayPage(this.createdHabitID)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(r.qu),t.Y36(b.dM),t.Y36(b.CB))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-habit-create"]],decls:126,vars:86,consts:[[1,"toolbar-spacer"],["linear",""],["stepper",""],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],["appearance","fill",1,"control-full-width"],["formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["matInput","","required","","formControlName","nameCtrl"],["appearance","fill"],[3,"rangePicker"],["matStartDate","","formControlName","validFromCtrl","placeholder","Start date"],["matEndDate","","formControlName","validToCtrl","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],["required","","formControlName","freqCtrl"],["required","","formControlName","compCtgyCtrl"],["matInput","","type","number","formControlName","compCondCtrl"],["matInput","","type","number","formControlName","startDateCtrl"],["mat-button","","color","primary","matStepperNext","",3,"disabled"],["matInput","","formControlName","rawCtrl"],["dense","",4,"ngFor","ngForOf"],["mat-button","","matStepperPrevious",""],["mat-button","","color","primary","matStepperNext","",3,"click"],[3,"completed"],["mat-raised-button","","disabled",""],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","ruleID"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","continuousDays"],["matColumnDef","point"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","","color","primary","matStepperNext","",3,"disabled","click"],["mat-button","",3,"click"],["mat-button","","color","warn",3,"click"],[3,"value"],["dense",""],["mat-header-cell",""],["mat-cell",""],[1,"control-full-width"],["matInput","","type","number",1,"input-point",3,"ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""]],template:function(o,i){if(1&o){const n=t.EpF();t.TgZ(0,"mat-toolbar"),t.TgZ(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.TgZ(5,"h3"),t._uU(6),t.ALo(7,"transloco"),t.qZA(),t.qZA(),t.TgZ(8,"mat-vertical-stepper",1,2),t.TgZ(10,"mat-step",3),t.TgZ(11,"form",4),t.YNc(12,Qt,2,3,"ng-template",5),t.TgZ(13,"mat-form-field",6),t.TgZ(14,"mat-label"),t._uU(15),t.ALo(16,"transloco"),t.qZA(),t.TgZ(17,"mat-select",7),t.YNc(18,Bt,2,2,"mat-option",8),t.qZA(),t.qZA(),t.TgZ(19,"mat-form-field",6),t.TgZ(20,"mat-label"),t._uU(21),t.ALo(22,"transloco"),t.qZA(),t._UZ(23,"input",9),t.qZA(),t.TgZ(24,"mat-form-field",10),t.TgZ(25,"mat-label"),t._uU(26),t.ALo(27,"transloco"),t.qZA(),t.TgZ(28,"mat-date-range-input",11),t._UZ(29,"input",12),t._UZ(30,"input",13),t.qZA(),t._UZ(31,"mat-datepicker-toggle",14),t._UZ(32,"mat-date-range-picker",null,15),t.qZA(),t.TgZ(34,"mat-form-field",6),t.TgZ(35,"mat-label"),t._uU(36),t.ALo(37,"transloco"),t.qZA(),t.TgZ(38,"mat-select",16),t.YNc(39,Gt,3,4,"mat-option",8),t.qZA(),t.TgZ(40,"mat-hint"),t._uU(41),t.ALo(42,"transloco"),t.qZA(),t.qZA(),t.TgZ(43,"mat-form-field",6),t.TgZ(44,"mat-label"),t._uU(45),t.ALo(46,"transloco"),t.qZA(),t.TgZ(47,"mat-select",17),t.YNc(48,$t,3,4,"mat-option",8),t.qZA(),t.TgZ(49,"mat-hint"),t._uU(50),t.ALo(51,"transloco"),t.qZA(),t.qZA(),t.TgZ(52,"mat-form-field",6),t.TgZ(53,"mat-label"),t._uU(54),t.ALo(55,"transloco"),t.qZA(),t._UZ(56,"input",18),t.TgZ(57,"mat-hint"),t._uU(58),t.ALo(59,"transloco"),t.qZA(),t.qZA(),t.TgZ(60,"mat-form-field",6),t.TgZ(61,"mat-label"),t._uU(62),t.ALo(63,"transloco"),t.qZA(),t._UZ(64,"input",19),t.TgZ(65,"mat-hint"),t._uU(66),t.ALo(67,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(68,"div"),t.TgZ(69,"button",20),t._uU(70),t.ALo(71,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(72,"mat-step",3),t.TgZ(73,"form",4),t.YNc(74,Et,2,3,"ng-template",5),t.TgZ(75,"mat-form-field",6),t.TgZ(76,"mat-label"),t._uU(77),t.ALo(78,"transloco"),t.qZA(),t._UZ(79,"input",21),t.qZA(),t.qZA(),t.YNc(80,jt,3,1,"mat-list",22),t.TgZ(81,"div"),t.TgZ(82,"button",23),t._uU(83),t.ALo(84,"transloco"),t.qZA(),t.TgZ(85,"button",24),t.NdJ("click",function(){return i.onInitialRules()}),t._uU(86),t.ALo(87,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(88,"mat-step",25),t.YNc(89,Vt,2,3,"ng-template",5),t.TgZ(90,"mat-toolbar"),t.TgZ(91,"button",26),t._uU(92,"RESET RULES"),t.qZA(),t.qZA(),t.TgZ(93,"table",27),t.ynx(94,28),t.YNc(95,zt,2,0,"th",29),t.YNc(96,Xt,2,1,"td",30),t.BQk(),t.ynx(97,31),t.YNc(98,Wt,3,3,"th",29),t.YNc(99,Kt,2,1,"td",30),t.BQk(),t.ynx(100,32),t.YNc(101,te,3,3,"th",29),t.YNc(102,ee,3,1,"td",30),t.BQk(),t.YNc(103,oe,1,0,"tr",33),t.YNc(104,ie,1,0,"tr",34),t.qZA(),t.TgZ(105,"button",23),t._uU(106),t.ALo(107,"transloco"),t.qZA(),t.TgZ(108,"button",35),t.NdJ("click",function(){return i.onSave()}),t._uU(109),t.ALo(110,"transloco"),t.qZA(),t.qZA(),t.TgZ(111,"mat-step"),t.YNc(112,ae,2,3,"ng-template",5),t.TgZ(113,"p"),t._uU(114),t.ALo(115,"transloco"),t.qZA(),t.TgZ(116,"p"),t._uU(117),t.ALo(118,"transloco"),t.qZA(),t.TgZ(119,"div"),t.TgZ(120,"button",36),t.NdJ("click",function(){return i.onDisplayHabit()}),t._uU(121),t.ALo(122,"transloco"),t.qZA(),t.TgZ(123,"button",37),t.NdJ("click",function(){return t.CHM(n),t.MAs(9).reset()}),t._uU(124),t.ALo(125,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const n=t.MAs(33);t.xp6(2),t.Oqu(t.lcZ(3,40,"Habit.Habit")),t.xp6(4),t.Oqu(t.lcZ(7,42,"Common.Create")),t.xp6(4),t.Q6J("stepControl",i.firstFormGroup),t.xp6(1),t.Q6J("formGroup",i.firstFormGroup),t.xp6(4),t.Oqu(t.lcZ(16,44,"Award.TargetUser")),t.xp6(3),t.Q6J("ngForOf",i.arTargetUsers),t.xp6(3),t.Oqu(t.lcZ(22,46,"Common.Name")),t.xp6(5),t.Oqu(t.lcZ(27,48,"Award.Validity")),t.xp6(2),t.Q6J("rangePicker",n),t.xp6(3),t.Q6J("for",n),t.xp6(5),t.Oqu(t.lcZ(37,50,"Habit.Frequency")),t.xp6(3),t.Q6J("ngForOf",i.arFrequencies),t.xp6(2),t.Oqu(t.lcZ(42,52,"Habit.FrequencyHint")),t.xp6(4),t.Oqu(t.lcZ(46,54,"Habit.CompleteCategory")),t.xp6(3),t.Q6J("ngForOf",i.arCompleteCategories),t.xp6(2),t.Oqu(t.lcZ(51,56,"Habit.CompleteCategoryHint")),t.xp6(4),t.Oqu(t.lcZ(55,58,"Habit.CompleteCondition")),t.xp6(4),t.Oqu(t.lcZ(59,60,"Habit.CompleteConditionHint")),t.xp6(4),t.Oqu(t.lcZ(63,62,"Habit.StartDate")),t.xp6(4),t.Oqu(t.lcZ(67,64,"Habit.StartDateHint")),t.xp6(3),t.Q6J("disabled",!i.firstFormGroup.valid),t.xp6(1),t.Oqu(t.lcZ(71,66,"Common.Next")),t.xp6(2),t.Q6J("stepControl",i.secondFormGroup),t.xp6(1),t.Q6J("formGroup",i.secondFormGroup),t.xp6(4),t.Oqu(t.lcZ(78,68,"Habit.ContinuousCompletedCounts")),t.xp6(3),t.Q6J("ngForOf",i.contDays),t.xp6(3),t.Oqu(t.lcZ(84,70,"Common.Previous")),t.xp6(3),t.Oqu(t.lcZ(87,72,"Common.Next")),t.xp6(2),t.Q6J("completed",i.pointCompleted),t.xp6(5),t.Q6J("dataSource",i.arRules),t.xp6(10),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(2),t.Oqu(t.lcZ(107,74,"Common.Previous")),t.xp6(2),t.Q6J("disabled",!i.pointCompleted),t.xp6(1),t.Oqu(t.lcZ(110,76,"Common.Next")),t.xp6(5),t.AsE("",t.lcZ(115,78,"AwardRuleGroupCreatedInfo1"),", ID: ",i.createdHabitID," "),t.xp6(3),t.Oqu(t.lcZ(118,80,"AwardRuleGroupCreatedInfo2")),t.xp6(4),t.Oqu(t.lcZ(122,82,"Common.Display")),t.xp6(3),t.Oqu(t.lcZ(125,84,"Common.CreateAnotherOne"))}},directives:[R.Ye,v.Vq,v.C0,r._Y,r.JL,r.sg,v.VY,g.KE,g.hX,w.gD,r.JJ,r.u,A.sg,N.ey,k.Nt,r.Fj,r.Q7,C.wx,C.zY,C.By,C.nW,g.R9,C._g,g.bx,r.wV,D.lW,v.Ic,ot.i$,ot.Tg,v.fd,s.BZ,s.w1,s.fO,s.ge,s.Dz,s.ev,r.On,s.as,s.XQ,s.nj,s.Gk],pipes:[x.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.input-point[_ngcontent-%COMP%]{text-align:center}"]}),e})();function le(e,a){1&e&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function se(e,a){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const o=a.$implicit,i=t.oxw();t.xp6(1),t.AsE("",i.getUserDisplayAs(o.targetUser)," (",o.targetUser,")")}}function ce(e,a){1&e&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Name")))}function me(e,a){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",o.habitName," ")}}function ue(e,a){1&e&&(t.TgZ(0,"th",21),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Quiz.Date")))}function pe(e,a){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.recordDateString)}}function de(e,a){1&e&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.SubID")))}function _e(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",20),t._uU(1),t.TgZ(2,"button",1),t.NdJ("click",function(){const l=t.CHM(o).$implicit;return t.oxw().onDisplayRecord(l)}),t.ALo(3,"transloco"),t.TgZ(4,"mat-icon"),t._uU(5,"launch"),t.qZA(),t.qZA(),t.TgZ(6,"button",22),t.NdJ("click",function(){const l=t.CHM(o).$implicit;return t.oxw().onDeleteRecord(l)}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"remove_circle"),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",o.subID," "),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,3,"Common.Display")),t.xp6(4),t.s9C("matTooltip",t.lcZ(7,5,"Common.Delete"))}}function ge(e,a){1&e&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.CompleteFact")))}function Ce(e,a){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.completeFact)}}function fe(e,a){1&e&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.Rule")))}function he(e,a){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.ruleID)}}function Ze(e,a){1&e&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.ContinuousDays")))}function be(e,a){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.continuousCount)}}function Te(e,a){1&e&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Comment")))}function Ae(e,a){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.comment)}}function qe(e,a){1&e&&t._UZ(0,"tr",23)}function ve(e,a){1&e&&t._UZ(0,"tr",24)}let nt=(()=>{class e{constructor(o,i,n){this.odataSrv=o,this.dialog=i,this.uiUtilSrv=n,this.arRecords=[],this.displayedColumns=["targetUser","habitname","recordDate","subID","completeFact","ruleID","contDays","comment"],this.recordCount=0,this.isLoadingResults=!1,this.refreshEvent=new t.vpe}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const i=this.odataSrv.currentUserDetail.awardUsers.findIndex(n=>n.targetUser===o);if(-1!==i)return this.odataSrv.currentUserDetail.awardUsers[i].displayAs}return""}ngOnInit(){}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,E.T)(this.sort.sortChange,this.paginator.page,this.refreshEvent).pipe((0,V.O)({}),(0,z.w)(()=>{const o=this.paginator.pageSize;return this.odataSrv.getUserHabitRecordViews(o,o*this.paginator.pageIndex,this.sort.active,this.sort.direction)}),(0,X.x)(()=>this.isLoadingResults=!1),(0,W.U)(o=>(this.recordCount=o.totalCount,o.items)),(0,K.K)(()=>(0,j.of)([]))).subscribe({next:o=>this.arRecords=o,error:o=>this.uiUtilSrv.showSnackInfo(o)})}onCreateRecord(){this.uiUtilSrv.navigateHabitRecordCreatePage()}onRefreshList(){this.refreshEvent.emit()}resetPaging(){this.paginator.pageIndex=0}onDisplayRecord(o){this.uiUtilSrv.currentUserHabitRecord=o,this.uiUtilSrv.navigateHabitRecordDisplayPage()}onDeleteRecord(o){this.odataSrv.deleteUserHabitRecord(o.habitID,o.recordDateString,o.subID).subscribe({next:i=>{this.uiUtilSrv.showSnackInfo("Delete successfully")},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(b.CB),t.Y36(H.uw),t.Y36(b.dM))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-habit-record-list"]],viewQuery:function(o,i){if(1&o&&(t.Gf(M.NW,5),t.Gf(y.YE,5)),2&o){let n;t.iGM(n=t.CRH())&&(i.paginator=n.first),t.iGM(n=t.CRH())&&(i.sort=n.first)}},decls:39,vars:11,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary",3,"matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource","matSortChange"],["matColumnDef","targetUser"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","habitname"],["matColumnDef","recordDate"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","subID"],["matColumnDef","completeFact"],["matColumnDef","ruleID"],["matColumnDef","contDays"],["matColumnDef","comment"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],["mat-icon-button","","color","warn",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""]],template:function(o,i){1&o&&(t.TgZ(0,"mat-toolbar"),t.TgZ(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.TgZ(5,"button",1),t.NdJ("click",function(){return i.onCreateRecord()}),t.ALo(6,"transloco"),t.TgZ(7,"mat-icon"),t._uU(8,"add_circle"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",2),t.TgZ(10,"div",3),t.TgZ(11,"table",4),t.NdJ("matSortChange",function(){return i.resetPaging()}),t.ynx(12,5),t.YNc(13,le,3,3,"th",6),t.YNc(14,se,2,2,"td",7),t.BQk(),t.ynx(15,8),t.YNc(16,ce,3,3,"th",6),t.YNc(17,me,2,1,"td",7),t.BQk(),t.ynx(18,9),t.YNc(19,ue,3,3,"th",10),t.YNc(20,pe,2,1,"td",7),t.BQk(),t.ynx(21,11),t.YNc(22,de,3,3,"th",6),t.YNc(23,_e,10,7,"td",7),t.BQk(),t.ynx(24,12),t.YNc(25,ge,3,3,"th",6),t.YNc(26,Ce,2,1,"td",7),t.BQk(),t.ynx(27,13),t.YNc(28,fe,3,3,"th",6),t.YNc(29,he,2,1,"td",7),t.BQk(),t.ynx(30,14),t.YNc(31,Ze,3,3,"th",6),t.YNc(32,be,2,1,"td",7),t.BQk(),t.ynx(33,15),t.YNc(34,Te,3,3,"th",6),t.YNc(35,Ae,2,1,"td",7),t.BQk(),t.YNc(36,qe,1,0,"tr",16),t.YNc(37,ve,1,0,"tr",17),t.qZA(),t.qZA(),t._UZ(38,"mat-paginator",18),t.qZA()),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,7,"Habit.Records")),t.xp6(3),t.s9C("matTooltip",t.lcZ(6,9,"Common.Create")),t.xp6(6),t.Q6J("dataSource",i.arRecords),t.xp6(25),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.recordCount)("pageSize",20))},directives:[R.Ye,D.lW,J.gM,Q.Hw,s.BZ,y.YE,s.w1,s.fO,s.ge,s.Dz,s.ev,y.nU,s.as,s.XQ,s.nj,s.Gk,M.NW],pipes:[x.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}"]}),e})();function Ue(e,a){if(1&e&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.targetUser),t.xp6(1),t.Oqu(o.displayAs)}}let rt=(()=>{class e{constructor(o,i,n,l){this._formBuilder=o,this.activateRoute=i,this.uiUtilSrv=n,this.odataSrv=l,this.uiMode=f.sk.Create,this.currentMode="Common.Display",this.currentObject=null,this.detailFormGroup=this._formBuilder.group({targetuserCtrl:new r.NI("",r.kI.required),habitIDCtrl:new r.NI(-1),dateCtrl:new r.NI(q()(),r.kI.required),subIDCtrl:new r.NI(1,r.kI.required),compFactCtrl:new r.NI(1,r.kI.required),commentCtrl:new r.NI("")})}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const i=this.odataSrv.currentUserDetail.awardUsers.findIndex(n=>n.targetUser===o);if(-1!==i)return this.odataSrv.currentUserDetail.awardUsers[i].displayAs}return""}get isDisplayMode(){return this.uiMode===f.sk.Display}get isCreateMode(){return this.uiMode===f.sk.Create}get isUpdateMode(){return this.uiMode===f.sk.Update}get isEditable(){return this.uiMode===f.sk.Create||this.uiMode===f.sk.Update}ngOnInit(){this.activateRoute.url.subscribe({next:o=>{var i,n,l,u,d,p;o instanceof Array&&o.length>0&&("record"===o[0].path&&"display"===o[1].path?(this.uiMode=f.sk.Display,this.currentMode="Common.Display"):"record"===o[0].path&&"edit"===o[1].path&&(this.uiMode=f.sk.Update,this.currentMode="Common.Change")),this.uiUtilSrv.currentUserHabitRecord?(null===(i=this.detailFormGroup.get("targetuserCtrl"))||void 0===i||i.setValue(this.uiUtilSrv.currentUserHabitRecord.targetUser),null===(n=this.detailFormGroup.get("habitIDCtrl"))||void 0===n||n.setValue(this.uiUtilSrv.currentUserHabitRecord.habitID),null===(l=this.detailFormGroup.get("dateCtrl"))||void 0===l||l.setValue(this.uiUtilSrv.currentUserHabitRecord.recordDate),null===(u=this.detailFormGroup.get("subIDCtrl"))||void 0===u||u.setValue(this.uiUtilSrv.currentUserHabitRecord.subID),null===(d=this.detailFormGroup.get("compFactCtrl"))||void 0===d||d.setValue(this.uiUtilSrv.currentUserHabitRecord.completeFact),null===(p=this.detailFormGroup.get("commentCtrl"))||void 0===p||p.setValue(this.uiUtilSrv.currentUserHabitRecord.comment),this.uiMode===f.sk.Display?this.detailFormGroup.disable():this.detailFormGroup.enable(),this.uiUtilSrv.clearHabitRecordDisplay()):(this.uiMode=f.sk.Invalid,this.detailFormGroup.disable())},error:o=>{this.uiUtilSrv.showSnackInfo(o)}})}onOK(){}onReturnToList(){this.uiUtilSrv.navigateHabitRecordListPage()}onCreateNewOne(){this.detailFormGroup.reset()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(r.qu),t.Y36(F.gz),t.Y36(b.dM),t.Y36(b.CB))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-habit-record-detail"]],decls:59,vars:42,consts:[[3,"formGroup"],["appearance","fill",1,"control-full-width"],["required","","formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","formControlName","habitIDCtrl"],["appearance","fill"],["matInput","","formControlName","dateCtrl",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","type","number","formControlName","subIDCtrl"],["matInput","","type","number","formControlName","compFactCtrl"],["matInput","","type","string","formControlName","commentCtrl"],["mat-button","","color","primary",3,"disabled","click"],["mat-button","",3,"click"],["mat-button","",3,"disabled","click"],[3,"value"]],template:function(o,i){if(1&o&&(t.TgZ(0,"mat-card"),t.TgZ(1,"mat-card-header"),t.TgZ(2,"mat-card-title"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.ALo(7,"transloco"),t.qZA(),t.qZA(),t.TgZ(8,"mat-card-content"),t.TgZ(9,"form",0),t.TgZ(10,"mat-form-field",1),t.TgZ(11,"mat-label"),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"mat-select",2),t.YNc(15,Ue,2,2,"mat-option",3),t.qZA(),t.qZA(),t.TgZ(16,"mat-form-field",1),t.TgZ(17,"mat-label"),t._uU(18,"#"),t.qZA(),t._UZ(19,"input",4),t.qZA(),t.TgZ(20,"mat-form-field",5),t.TgZ(21,"mat-label"),t._uU(22),t.ALo(23,"transloco"),t.qZA(),t._UZ(24,"input",6),t._UZ(25,"mat-datepicker-toggle",7),t._UZ(26,"mat-datepicker",null,8),t.qZA(),t.TgZ(28,"mat-form-field",1),t.TgZ(29,"mat-label"),t._uU(30),t.ALo(31,"transloco"),t.qZA(),t._UZ(32,"input",9),t.TgZ(33,"mat-hint"),t._uU(34),t.ALo(35,"transloco"),t.qZA(),t.qZA(),t.TgZ(36,"mat-form-field",1),t.TgZ(37,"mat-label"),t._uU(38),t.ALo(39,"transloco"),t.qZA(),t._UZ(40,"input",10),t.TgZ(41,"mat-hint"),t._uU(42),t.ALo(43,"transloco"),t.qZA(),t.qZA(),t.TgZ(44,"mat-form-field",1),t.TgZ(45,"mat-label"),t._uU(46),t.ALo(47,"transloco"),t.qZA(),t._UZ(48,"input",11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(49,"mat-card-actions"),t.TgZ(50,"button",12),t.NdJ("click",function(){return i.onOK()}),t._uU(51),t.ALo(52,"transloco"),t.qZA(),t.TgZ(53,"button",13),t.NdJ("click",function(){return i.onReturnToList()}),t._uU(54),t.ALo(55,"transloco"),t.qZA(),t.TgZ(56,"button",14),t.NdJ("click",function(){return i.onCreateNewOne()}),t._uU(57),t.ALo(58,"transloco"),t.qZA(),t.qZA(),t.qZA()),2&o){const n=t.MAs(27);t.xp6(3),t.Oqu(t.lcZ(4,18,"Habit.Record")),t.xp6(3),t.Oqu(t.lcZ(7,20,i.currentMode)),t.xp6(3),t.Q6J("formGroup",i.detailFormGroup),t.xp6(3),t.Oqu(t.lcZ(13,22,"Award.TargetUser")),t.xp6(3),t.Q6J("ngForOf",i.arTargetUsers),t.xp6(7),t.Oqu(t.lcZ(23,24,"Quiz.Date")),t.xp6(2),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(5),t.Oqu(t.lcZ(31,26,"Habit.SubID")),t.xp6(4),t.Oqu(t.lcZ(35,28,"Habit.SubIDHint")),t.xp6(4),t.Oqu(t.lcZ(39,30,"Habit.CompleteFact")),t.xp6(4),t.Oqu(t.lcZ(43,32,"Habit.CompleteFactHint")),t.xp6(4),t.Oqu(t.lcZ(47,34,"Common.Comment")),t.xp6(4),t.Q6J("disabled",!(i.isEditable&&i.detailFormGroup.valid)),t.xp6(1),t.Oqu(t.lcZ(52,36,"Common.Save")),t.xp6(3),t.Oqu(t.lcZ(55,38,"Common.ReturnToList")),t.xp6(2),t.Q6J("disabled",!i.isDisplayMode),t.xp6(1),t.Oqu(t.lcZ(58,40,"Common.CreateAnotherOne"))}},directives:[T.a8,T.dk,T.n5,T.$j,T.dn,r._Y,r.JL,r.sg,g.KE,g.hX,w.gD,r.Q7,r.JJ,r.u,A.sg,N.ey,k.Nt,r.wV,r.Fj,C.hl,C.nW,g.R9,C.Mq,g.bx,T.hq,D.lW],pipes:[x.Ot],styles:[""]}),e})();var lt=c(4128),xe=c(7446);function He(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Habit.PickAnUser"))}function De(e,a){if(1&e&&(t.TgZ(0,"mat-option",27),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.targetUser),t.xp6(1),t.Oqu(o.displayAs)}}function ye(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Habit.AvailableHabits"))}function we(e,a){1&e&&(t.TgZ(0,"th",28),t._uU(1,"ID"),t.qZA())}function Ne(e,a){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.HabitID)}}function Oe(e,a){1&e&&(t.TgZ(0,"th",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Name")))}function Le(e,a){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.HabitName)}}function Se(e,a){1&e&&(t.TgZ(0,"th",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.Frequency")))}function Re(e,a){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit,i=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,i.getHabitFrequencyName(o.Frequency)))}}function ke(e,a){1&e&&(t.TgZ(0,"th",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.CompleteCategory")))}function Pe(e,a){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit,i=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,i.getHabitCompleteCategoryName(o.CompleteCategory)))}}function Fe(e,a){1&e&&(t.TgZ(0,"th",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.CompleteFact")))}function Me(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"mat-checkbox",33),t.NdJ("ngModelChange",function(n){return t.CHM(o),t.oxw().$implicit.CompleteFact=n}),t.qZA(),t.qZA()}if(2&e){const o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngModel",o.CompleteFact)}}function Ie(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"mat-form-field"),t.TgZ(2,"input",34),t.NdJ("ngModelChange",function(n){return t.CHM(o),t.oxw().$implicit.CompleteFact=n}),t.ALo(3,"transloco"),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=t.oxw().$implicit;t.xp6(2),t.s9C("placeholder",t.lcZ(3,2,"Value")),t.Q6J("ngModel",o.CompleteFact)}}function Ye(e,a){1&e&&(t.TgZ(0,"div"),t._uU(1,"Nothing display"),t.qZA())}function Je(e,a){if(1&e&&(t.TgZ(0,"td",29),t.TgZ(1,"div",30),t.YNc(2,Me,2,1,"div",31),t.YNc(3,Ie,4,4,"div",31),t.YNc(4,Ye,2,0,"div",32),t.qZA(),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Q6J("ngSwitch",o.completeCategoryString),t.xp6(1),t.Q6J("ngSwitchCase",0),t.xp6(1),t.Q6J("ngSwitchCase",1)}}function Qe(e,a){1&e&&t._UZ(0,"tr",35)}function Be(e,a){1&e&&t._UZ(0,"tr",36)}function Ge(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Common.Done"))}class $e{constructor(){this.HabitID=void 0,this.HabitName="",this.Frequency=m.Hs.Daily,this.CompleteCategory=m.Kd.NumberOfTimes,this.CompleteFact=null}get completeCategoryString(){return(+this.CompleteCategory).toString()}}let Ee=(()=>{class e{constructor(o,i,n){this._formBuilder=o,this.uiUtilSrv=i,this.odataSrv=n,this.currentObject=null,this.arHabits=[],this.displayedColumns=["hid","name","frequency","compCategory","compFact"],this.firstFormGroup=this._formBuilder.group({targetuserCtrl:new r.NI("",r.kI.required),dateCtrl:new r.NI(q()(),r.kI.required)})}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const i=this.odataSrv.currentUserDetail.awardUsers.findIndex(n=>n.targetUser===o);if(-1!==i)return this.odataSrv.currentUserDetail.awardUsers[i].displayAs}return""}getHabitCompleteCategoryName(o){return(0,m.E0)(o)}getHabitFrequencyName(o){return(0,m.lC)(o)}ngOnInit(){}onUserSelected(){var o,i;let n=null===(o=this.firstFormGroup.get("targetuserCtrl"))||void 0===o?void 0:o.value,l=null===(i=this.firstFormGroup.get("dateCtrl"))||void 0===i?void 0:i.value.format(m.Jt);this.odataSrv.getUserHabits(100,0,void 0,void 0,`TargetUser eq '${n}' and ValidFrom le ${l} and ValidTo ge ${l}`).subscribe({next:u=>{this.arHabits=[],u.items.forEach(d=>{let p=new $e;p.HabitID=d.ID,p.HabitName=d.name,p.Frequency=d.frequency,p.CompleteCategory=d.completeCategory,p.CompleteFact=null,this.arHabits.push(p)})},error:u=>{this.uiUtilSrv.showSnackInfo(u,1500)}})}get isHabitStepCompleted(){if(!this.arHabits)return!1;let o=!1;return this.arHabits.forEach(i=>{i.CompleteFact&&(o=!0)}),o}onSaveRecord(){let o=[];this.arHabits.forEach(i=>{var n;if(null!==i.CompleteFact){console.log(`${i.HabitID}, ${i.CompleteFact}`);const l=new m.Dh;l.completeFact=+i.CompleteFact,l.habitID=i.HabitID,l.recordDate=null===(n=this.firstFormGroup.get("dateCtrl"))||void 0===n?void 0:n.value,o.push(this.odataSrv.createUserHabitRecord(l))}}),(0,lt.D)(o).subscribe({next:i=>{console.log(i)},error:i=>{this.uiUtilSrv.showSnackInfo(i,1500)}})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(r.qu),t.Y36(b.dM),t.Y36(b.CB))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-habit-record-create"]],decls:64,vars:35,consts:[[1,"toolbar-spacer"],["linear",""],["stepper",""],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],["appearance","fill",1,"control-full-width"],["required","","formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],["matInput","","formControlName","dateCtrl",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["mat-button","","color","primary","matStepperNext","",3,"disabled","click"],[3,"completed"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","hid"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","frequency"],["matColumnDef","compCategory"],["matColumnDef","compFact"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","","matStepperPrevious",""],["mat-button","","color","warn",3,"click"],[3,"value"],["mat-header-cell",""],["mat-cell",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"ngModel","ngModelChange"],["matInput","","type","number","name","compfact_num",3,"placeholder","ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""]],template:function(o,i){if(1&o){const n=t.EpF();t.TgZ(0,"mat-toolbar"),t.TgZ(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.qZA(),t.TgZ(5,"mat-vertical-stepper",1,2),t.TgZ(7,"mat-step",3),t.TgZ(8,"form",4),t.YNc(9,He,2,3,"ng-template",5),t.TgZ(10,"mat-form-field",6),t.TgZ(11,"mat-label"),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"mat-select",7),t.YNc(15,De,2,2,"mat-option",8),t.qZA(),t.qZA(),t.TgZ(16,"mat-form-field",9),t.TgZ(17,"mat-label"),t._uU(18),t.ALo(19,"transloco"),t.qZA(),t._UZ(20,"input",10),t._UZ(21,"mat-datepicker-toggle",11),t._UZ(22,"mat-datepicker",null,12),t.qZA(),t.qZA(),t.TgZ(24,"div"),t.TgZ(25,"button",13),t.NdJ("click",function(){return i.onUserSelected()}),t._uU(26),t.ALo(27,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(28,"mat-step",14),t.YNc(29,ye,2,3,"ng-template",5),t.TgZ(30,"table",15),t.ynx(31,16),t.YNc(32,we,2,0,"th",17),t.YNc(33,Ne,2,1,"td",18),t.BQk(),t.ynx(34,19),t.YNc(35,Oe,3,3,"th",17),t.YNc(36,Le,2,1,"td",18),t.BQk(),t.ynx(37,20),t.YNc(38,Se,3,3,"th",17),t.YNc(39,Re,3,3,"td",18),t.BQk(),t.ynx(40,21),t.YNc(41,ke,3,3,"th",17),t.YNc(42,Pe,3,3,"td",18),t.BQk(),t.ynx(43,22),t.YNc(44,Fe,3,3,"th",17),t.YNc(45,Je,5,3,"td",18),t.BQk(),t.YNc(46,Qe,1,0,"tr",23),t.YNc(47,Be,1,0,"tr",24),t.qZA(),t.TgZ(48,"div"),t.TgZ(49,"button",25),t._uU(50),t.ALo(51,"transloco"),t.qZA(),t.TgZ(52,"button",13),t.NdJ("click",function(){return i.onSaveRecord()}),t._uU(53),t.ALo(54,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(55,"mat-step"),t.YNc(56,Ge,2,3,"ng-template",5),t.TgZ(57,"p"),t._uU(58),t.ALo(59,"transloco"),t.qZA(),t.TgZ(60,"div"),t.TgZ(61,"button",26),t.NdJ("click",function(){return t.CHM(n),t.MAs(6).reset()}),t._uU(62),t.ALo(63,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const n=t.MAs(23);t.xp6(2),t.Oqu(t.lcZ(3,19,"Habit.Records")),t.xp6(5),t.Q6J("stepControl",i.firstFormGroup),t.xp6(1),t.Q6J("formGroup",i.firstFormGroup),t.xp6(4),t.Oqu(t.lcZ(13,21,"Award.TargetUser")),t.xp6(3),t.Q6J("ngForOf",i.arTargetUsers),t.xp6(3),t.Oqu(t.lcZ(19,23,"Quiz.Date")),t.xp6(2),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(4),t.Q6J("disabled",!i.firstFormGroup.valid),t.xp6(1),t.Oqu(t.lcZ(27,25,"Common.Next")),t.xp6(2),t.Q6J("completed",i.isHabitStepCompleted),t.xp6(2),t.Q6J("dataSource",i.arHabits),t.xp6(16),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(3),t.Oqu(t.lcZ(51,27,"Common.Previous")),t.xp6(2),t.Q6J("disabled",!i.isHabitStepCompleted),t.xp6(1),t.Oqu(t.lcZ(54,29,"Common.Next")),t.xp6(5),t.Oqu(t.lcZ(59,31,"Habit.HabitRecordCreatedInfo")),t.xp6(4),t.Oqu(t.lcZ(63,33,"Common.CreateAnotherOne"))}},directives:[R.Ye,v.Vq,v.C0,r._Y,r.JL,r.sg,v.VY,g.KE,g.hX,w.gD,r.Q7,r.JJ,r.u,A.sg,N.ey,k.Nt,r.Fj,C.hl,C.nW,g.R9,C.Mq,D.lW,v.Ic,s.BZ,s.w1,s.fO,s.ge,s.Dz,s.ev,A.RF,A.n9,xe.oG,r.On,r.wV,A.ED,s.as,s.XQ,s.nj,s.Gk,v.fd],pipes:[x.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}"]}),e})();var je=c(4834);function Ve(e,a){if(1&e&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.targetUser),t.xp6(1),t.Oqu(o.displayAs)}}function ze(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1,"#"),t.qZA())}function Xe(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",24),t._uU(1),t.TgZ(2,"button",25),t.NdJ("click",function(){const l=t.CHM(o).$implicit;return t.oxw(2).onDeleteManualPoint(l.ID)}),t.ALo(3,"transloco"),t.TgZ(4,"mat-icon"),t._uU(5,"remove_circle"),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(1),t.hij("",o.ID," | "),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,2,"Common.Delete"))}}function We(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function Ke(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit,i=t.oxw(2);t.xp6(1),t.AsE("",i.getUserDisplayAs(o.targetUser)," (",o.targetUser,")")}}function to(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Quiz.Date")))}function eo(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.recordDateString)}}function oo(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function io(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.point)}}function ao(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Comment")))}function no(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.comment)}}function ro(e,a){1&e&&t._UZ(0,"tr",26)}function lo(e,a){1&e&&t._UZ(0,"tr",27)}function so(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"div",11),t.TgZ(1,"mat-toolbar"),t.TgZ(2,"h3"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t._UZ(5,"div",0),t.TgZ(6,"button",7),t.NdJ("click",function(){return t.CHM(o),t.oxw().onHideManualPoints()}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"visibility_off"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div",12),t.TgZ(11,"table",13),t.ynx(12,14),t.YNc(13,ze,2,0,"th",15),t.YNc(14,Xe,6,4,"td",16),t.BQk(),t.ynx(15,17),t.YNc(16,We,3,3,"th",15),t.YNc(17,Ke,2,2,"td",16),t.BQk(),t.ynx(18,18),t.YNc(19,to,3,3,"th",15),t.YNc(20,eo,2,1,"td",16),t.BQk(),t.ynx(21,19),t.YNc(22,oo,3,3,"th",15),t.YNc(23,io,2,1,"td",16),t.BQk(),t.ynx(24,20),t.YNc(25,ao,3,3,"th",15),t.YNc(26,no,2,1,"td",16),t.BQk(),t.YNc(27,ro,1,0,"tr",21),t.YNc(28,lo,1,0,"tr",22),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,5,"Award.Point")),t.xp6(3),t.s9C("matTooltip",t.lcZ(7,7,"Common.Hide")),t.xp6(5),t.Q6J("dataSource",o.dataSourceManualPoints),t.xp6(16),t.Q6J("matHeaderRowDef",o.displayedColumnsManualPoint),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumnsManualPoint)}}function co(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function mo(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit,i=t.oxw(2);t.xp6(1),t.AsE("",i.getUserDisplayAs(o.targetUser)," (",o.targetUser,")")}}function uo(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Quiz.Date")))}function po(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.recordDateString)}}function _o(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1,"ID"),t.qZA())}function go(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.habitID)}}function Co(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Name")))}function fo(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.habitName)}}function ho(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1,"From"),t.qZA())}function Zo(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.ruleDaysFrom)}}function bo(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1,"To"),t.qZA())}function To(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.ruleDaysTo)}}function Ao(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function qo(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.rulePoint)}}function vo(e,a){1&e&&t._UZ(0,"tr",26)}function Uo(e,a){1&e&&t._UZ(0,"tr",27)}function xo(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"div",11),t.TgZ(1,"mat-toolbar"),t.TgZ(2,"h3"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t._UZ(5,"div",0),t.TgZ(6,"button",7),t.NdJ("click",function(){return t.CHM(o),t.oxw().onHideHabitPoints()}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"visibility_off"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div",12),t.TgZ(11,"table",13),t.ynx(12,17),t.YNc(13,co,3,3,"th",15),t.YNc(14,mo,2,2,"td",16),t.BQk(),t.ynx(15,18),t.YNc(16,uo,3,3,"th",15),t.YNc(17,po,2,1,"td",16),t.BQk(),t.ynx(18,28),t.YNc(19,_o,2,0,"th",15),t.YNc(20,go,2,1,"td",16),t.BQk(),t.ynx(21,29),t.YNc(22,Co,3,3,"th",15),t.YNc(23,fo,2,1,"td",16),t.BQk(),t.ynx(24,30),t.YNc(25,ho,2,0,"th",15),t.YNc(26,Zo,2,1,"td",16),t.BQk(),t.ynx(27,31),t.YNc(28,bo,2,0,"th",15),t.YNc(29,To,2,1,"td",16),t.BQk(),t.ynx(30,19),t.YNc(31,Ao,3,3,"th",15),t.YNc(32,qo,2,1,"td",16),t.BQk(),t.YNc(33,vo,1,0,"tr",21),t.YNc(34,Uo,1,0,"tr",22),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,5,"Award.Point")),t.xp6(3),t.s9C("matTooltip",t.lcZ(7,7,"Common.Hide")),t.xp6(5),t.Q6J("dataSource",o.dataSourceHabitPoints),t.xp6(22),t.Q6J("matHeaderRowDef",o.displayedColumnsHabitPoint),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumnsHabitPoint)}}function Ho(e,a){if(1&e&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.targetUser),t.xp6(1),t.hij(" ",o.displayAs," ")}}let Do=(()=>{class e{constructor(o,i,n){this.odataSrv=o,this.dialog=i,this.uiUtilSrv=n,this.displayedColumnsManualPoint=["id","targetUser","recordDate","point","comment"],this.dataSourceManualPoints=[],this.displayedColumnsHabitPoint=["targetUser","recordDate","habitid","habitName","ruleDaysFrom","ruleDaysTo","point"],this.dataSourceHabitPoints=[],this.selectedUser=null,this.selectedPeriod="2",this.showManualPointResult=!1,this.showHabitPointResult=!1}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const i=this.odataSrv.currentUserDetail.awardUsers.findIndex(n=>n.targetUser===o);if(-1!==i)return this.odataSrv.currentUserDetail.awardUsers[i].displayAs}return""}ngOnInit(){this.selectedPeriod="2"}onReportParameterSelectionChange(o){null!==this.selectedUser&&this.refreshData()}refreshData(){let o=q()(),i=q().duration(1,"months").asDays();"1"===this.selectedPeriod&&(i=q().duration(1,"weeks").asDays());let n=o.clone().subtract(i,"days"),l=[];const u=i;for(;i>=0;)l.push(o.clone().subtract(i,"days").format(m.Jt)),i--;let d=`TargetUser eq '${this.selectedUser}' and RecordDate ge ${n.format(m.Jt)} and RecordDate le ${o.format(m.Jt)}`,p=[],h=[];h.push(this.odataSrv.getHabitOpeningPointsByUserDate(this.selectedUser,u)),h.push(this.odataSrv.getHabitPointsByUserDateReport(d)),h.push(this.odataSrv.getUserOpeningPointReport(this.selectedUser,u)),h.push(this.odataSrv.getUserHabitPointReports(d)),(0,lt.D)([h]).subscribe({next:Z=>{let O=Z[1],L=Z[3],S=[],_=[],st=[],I=0,Y=0,ct=Z[0]+Z[2];l.forEach(mt=>{let ut=O.findIndex(B=>B.recordDateString===mt);I=-1!==ut?O[ut].point:0,S.push(I);let pt=L.findIndex(B=>B.recordDateString===mt);-1!==pt?Y+=L[pt].point:Y=0,_.push(Y),ct+=I+Y,st.push(ct)}),p.push({name:"Points from Habits",type:"bar",emphasis:{focus:"series"},data:S}),p.push({name:"Manual Points",type:"bar",emphasis:{focus:"series"},data:_}),p.push({name:"Total Points",type:"bar",emphasis:{focus:"series"},data:st}),this.chartOption={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:l}],yAxis:[{type:"value"}],series:p}},error:Z=>{this.uiUtilSrv.showSnackInfo(Z)}})}onChartClick(o){0===o.seriesIndex?(this.showHabitPointResult=!0,this.dataSourceHabitPoints=[],this.odataSrv.getUserHabitRecordViews(100,0,void 0,void 0,`RecordDate eq ${o.name} and TargetUser eq '${this.selectedUser}' and RulePoint gt 0`).subscribe({next:n=>{this.dataSourceHabitPoints=n.items},error:n=>{this.uiUtilSrv.showSnackInfo(n)}})):1===o.seriesIndex&&o.name&&(this.showManualPointResult=!0,this.dataSourceManualPoints=[],this.odataSrv.getHabitPoints(`RecordDate eq ${o.name} and TargetUser eq '${this.selectedUser}'`).subscribe({next:n=>{this.dataSourceManualPoints=n},error:n=>{this.uiUtilSrv.showSnackInfo(n)}}))}onHideManualPoints(){this.showManualPointResult=!1}onHideHabitPoints(){this.showHabitPointResult=!1}onDeleteManualPoint(o){this.odataSrv.deleteHabitPoint(o).subscribe({next:i=>{this.uiUtilSrv.showSnackInfo("DONE"),this.showManualPointResult=!1,this.refreshData()},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})}onCreatePoint(){this.dialog.open(yo,{width:"600px",closeOnNavigation:!1,data:new m._Y}).afterClosed().subscribe(i=>{i&&this.odataSrv.createHabitPoint(i).subscribe({next:n=>{this.refreshData()},error:n=>{this.uiUtilSrv.showSnackInfo(n)}})})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(b.CB),t.Y36(H.uw),t.Y36(b.dM))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-habit-points-list"]],decls:32,vars:24,consts:[[1,"toolbar-spacer"],[1,"form-field-item"],["required","",3,"ngModel","ngModelChange","selectionChange"],["value","1"],["value","2"],[1,"form-field-user"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","color","primary",3,"matTooltip","click"],["echarts","",1,"demo-chart",2,"width","100%","height","450px",3,"options","chartClick"],["class","example-container mat-elevation-z8",4,"ngIf"],[3,"value"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","targetUser"],["matColumnDef","recordDate"],["matColumnDef","point"],["matColumnDef","comment"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","warn",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""],["matColumnDef","habitid"],["matColumnDef","habitName"],["matColumnDef","ruleDaysFrom"],["matColumnDef","ruleDaysTo"]],template:function(o,i){1&o&&(t.TgZ(0,"mat-toolbar"),t.TgZ(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.qZA(),t.TgZ(5,"mat-toolbar"),t.TgZ(6,"mat-form-field",1),t.TgZ(7,"mat-label"),t._uU(8),t.ALo(9,"transloco"),t.qZA(),t.TgZ(10,"mat-select",2),t.NdJ("ngModelChange",function(l){return i.selectedPeriod=l})("selectionChange",function(l){return i.onReportParameterSelectionChange(l)}),t.TgZ(11,"mat-option",3),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"mat-option",4),t._uU(15),t.ALo(16,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"mat-form-field",5),t.TgZ(18,"mat-label"),t._uU(19),t.ALo(20,"transloco"),t.qZA(),t.TgZ(21,"mat-select",2),t.NdJ("ngModelChange",function(l){return i.selectedUser=l})("selectionChange",function(l){return i.onReportParameterSelectionChange(l)}),t.YNc(22,Ve,2,2,"mat-option",6),t.qZA(),t.qZA(),t.TgZ(23,"button",7),t.NdJ("click",function(){return i.onCreatePoint()}),t.ALo(24,"transloco"),t.TgZ(25,"mat-icon"),t._uU(26,"add_circle"),t.qZA(),t.qZA(),t.qZA(),t._UZ(27,"mat-divider"),t.TgZ(28,"div",8),t.NdJ("chartClick",function(l){return i.onChartClick(l)}),t.qZA(),t._UZ(29,"mat-divider"),t.YNc(30,so,29,9,"div",9),t.YNc(31,xo,35,9,"div",9)),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,12,"Award.Point")),t.xp6(6),t.Oqu(t.lcZ(9,14,"Habit.Frequency")),t.xp6(2),t.Q6J("ngModel",i.selectedPeriod),t.xp6(2),t.Oqu(t.lcZ(13,16,"Habit.ByWeek")),t.xp6(3),t.Oqu(t.lcZ(16,18,"Habit.ByMonth")),t.xp6(4),t.Oqu(t.lcZ(20,20,"Award.TargetUser")),t.xp6(2),t.Q6J("ngModel",i.selectedUser),t.xp6(1),t.Q6J("ngForOf",i.arTargetUsers),t.xp6(1),t.s9C("matTooltip",t.lcZ(24,22,"Common.Create")),t.xp6(5),t.Q6J("options",i.chartOption),t.xp6(2),t.Q6J("ngIf",i.showManualPointResult),t.xp6(1),t.Q6J("ngIf",i.showHabitPointResult))},directives:[R.Ye,g.KE,g.hX,w.gD,r.Q7,r.JJ,r.On,N.ey,A.sg,D.lW,J.gM,Q.Hw,je.d,$._w,A.O5,s.BZ,s.w1,s.fO,s.ge,s.Dz,s.ev,s.as,s.XQ,s.nj,s.Gk],pipes:[x.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.form-field-item[_ngcontent-%COMP%]{width:150px}.form-field-user[_ngcontent-%COMP%]{width:200px}"]}),e})(),yo=(()=>{class e{constructor(o,i,n){this.dialogRef=o,this.oDataSrv=i,this.data=n}onNoClick(){this.dialogRef.close()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(H.so),t.Y36(b.CB),t.Y36(H.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-habit-point-crtdlg"]],decls:35,vars:27,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"example-form"],["appearance","fill",1,"control-full-width"],["name","targetuser",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],["matInput","","name","recorddate",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["matInput","","type","number","name","point",3,"ngModel","ngModelChange"],["matInput","","name","comment",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"disabled","mat-dialog-close"],[3,"value"]],template:function(o,i){if(1&o&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"transloco"),t.qZA(),t.TgZ(3,"div",1),t.TgZ(4,"form",2),t.TgZ(5,"mat-form-field",3),t.TgZ(6,"mat-label"),t._uU(7),t.ALo(8,"transloco"),t.qZA(),t.TgZ(9,"mat-select",4),t.NdJ("ngModelChange",function(l){return i.data.targetUser=l}),t.YNc(10,Ho,2,2,"mat-option",5),t.qZA(),t.qZA(),t.TgZ(11,"mat-form-field",6),t.TgZ(12,"mat-label"),t._uU(13),t.ALo(14,"transloco"),t.qZA(),t.TgZ(15,"input",7),t.NdJ("ngModelChange",function(l){return i.data.recordDate=l}),t.qZA(),t._UZ(16,"mat-datepicker-toggle",8),t._UZ(17,"mat-datepicker",null,9),t.qZA(),t.TgZ(19,"mat-form-field",3),t.TgZ(20,"mat-label"),t._uU(21),t.ALo(22,"transloco"),t.qZA(),t.TgZ(23,"input",10),t.NdJ("ngModelChange",function(l){return i.data.point=l}),t.qZA(),t.qZA(),t.TgZ(24,"mat-form-field",3),t.TgZ(25,"mat-label"),t._uU(26),t.ALo(27,"transloco"),t.qZA(),t.TgZ(28,"input",11),t.NdJ("ngModelChange",function(l){return i.data.comment=l}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(29,"div",12),t.TgZ(30,"button",13),t.NdJ("click",function(){return i.onNoClick()}),t._uU(31),t.ALo(32,"transloco"),t.qZA(),t.TgZ(33,"button",14),t._uU(34,"OK"),t.qZA(),t.qZA()),2&o){const n=t.MAs(18);t.xp6(1),t.Oqu(t.lcZ(2,15,"Habit.CreateManualPoint")),t.xp6(6),t.Oqu(t.lcZ(8,17,"Award.TargetUser")),t.xp6(2),t.Q6J("ngModel",i.data.targetUser),t.xp6(1),t.Q6J("ngForOf",null==i.oDataSrv.currentUserDetail?null:i.oDataSrv.currentUserDetail.awardUsers),t.xp6(3),t.Oqu(t.lcZ(14,19,"Quiz.Date")),t.xp6(2),t.Q6J("matDatepicker",n)("ngModel",i.data.recordDate),t.xp6(1),t.Q6J("for",n),t.xp6(5),t.Oqu(t.lcZ(22,21,"Award.Point")),t.xp6(2),t.Q6J("ngModel",i.data.point),t.xp6(3),t.Oqu(t.lcZ(27,23,"Common.Comment")),t.xp6(2),t.Q6J("ngModel",i.data.comment),t.xp6(3),t.Oqu(t.lcZ(32,25,"Common.NoThanks")),t.xp6(2),t.Q6J("disabled",!i.data.isValid)("mat-dialog-close",i.data)}},directives:[H.uh,H.xY,r._Y,r.JL,r.F,g.KE,g.hX,w.gD,r.JJ,r.On,A.sg,N.ey,k.Nt,C.hl,r.Fj,C.nW,g.R9,C.Mq,r.wV,H.H8,D.lW,H.ZT],pipes:[x.Ot],encapsulation:2}),e})();const wo=[{path:"",component:tt},{path:"points",component:Do},{path:"list",component:tt},{path:"create",component:re},{path:"edit/:id",component:et},{path:"display/:id",component:et},{path:"record",component:nt},{path:"record/list",component:nt},{path:"record/create",component:Ee},{path:"record/edit",component:rt},{path:"record/display",component:rt}];let No=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[F.Bz.forChild(wo)],F.Bz]}),e})(),Oo=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[A.ez,r.u5,r.UX,dt.U,x.y4,_t.D,$.Ns,No]]}),e})()}}]);