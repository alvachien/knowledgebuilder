(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{caho:function(e,t,c){"use strict";c.r(t),c.d(t,"PreviewModule",function(){return N});var i=c("ofXK"),o=c("3Pt+"),s=c("QPBi"),n=c("jIBr"),r=c("tyNb"),a=c("VHTt"),b=c("2ChS"),l=c("fXoL"),d=c("o0su"),h=c("MutI"),u=c("FKr1");let m=(()=>{class e{constructor(e,t,c){this._bottomSheetRef=e,this.odataSrv=t,this.data=c}createNewScore(e,t){t.preventDefault();const c=new a.n;c.RefID=this.data.excitemid,c.Score=e,c.User=this.odataSrv.currentUser,this.odataSrv.createExerciseItemUserScore(c).subscribe({next:e=>{this.data.resultFlag=!0,this.data.newScore=e,this._bottomSheetRef.dismiss(this.data)},error:e=>{this.data.resultFlag=!1,this.data.newScore=null,this.data.errorInfo=e,this._bottomSheetRef.dismiss(this.data)}})}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(b.d),l.Qb(d.b),l.Qb(b.a))},e.\u0275cmp=l.Kb({type:e,selectors:[["app-preview-newscore-sheet"]],decls:19,vars:9,consts:[["mat-list-item","",3,"click"],["mat-line",""]],template:function(e,t){1&e&&(l.Wb(0,"mat-nav-list"),l.Wb(1,"a",0),l.ec("click",function(e){return t.createNewScore(0,e)}),l.Wb(2,"span",1),l.Fc(3),l.jc(4,"transloco"),l.Vb(),l.Wb(5,"span",1),l.Fc(6,"Add a new score of 0"),l.Vb(),l.Vb(),l.Wb(7,"a",0),l.ec("click",function(e){return t.createNewScore(60,e)}),l.Wb(8,"span",1),l.Fc(9),l.jc(10,"transloco"),l.Vb(),l.Wb(11,"span",1),l.Fc(12,"Add a new score of 60"),l.Vb(),l.Vb(),l.Wb(13,"a",0),l.ec("click",function(e){return t.createNewScore(100,e)}),l.Wb(14,"span",1),l.Fc(15),l.jc(16,"transloco"),l.Vb(),l.Wb(17,"span",1),l.Fc(18,"Add a new score of 100"),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Eb(3),l.Hc("",l.kc(4,3,"NewPractice"),": 0"),l.Eb(6),l.Hc("",l.kc(10,5,"NewPractice"),": 60"),l.Eb(6),l.Hc("",l.kc(16,7,"NewPractice"),": 100"))},directives:[h.e,h.b,u.k],pipes:[s.d],encapsulation:2}),e})();var f=c("0MNC"),p=c("bTqV"),v=c("f0Cb"),w=c("lR5k"),g=c("bSwM"),x=c("Qu3c"),E=c("5RNC"),I=c("kmnG");function S(e,t){if(1&e&&(l.Wb(0,"div",3),l.Wb(1,"h3"),l.Fc(2),l.Vb(),l.Rb(3,"mat-divider"),l.Wb(4,"h3"),l.Fc(5),l.jc(6,"transloco"),l.Vb(),l.Rb(7,"mat-divider"),l.Wb(8,"div",4),l.Rb(9,"markdown",5),l.Vb(),l.Vb()),2&e){const e=l.ic();l.Eb(2),l.Hc("ID: ",e.selectedKnowledge.ID,""),l.Eb(3),l.Ic("",l.kc(6,5,"Title"),": ",e.selectedKnowledge.Title,""),l.Eb(4),l.oc("data",e.selectedKnowledge.Content)("katexOptions",e.mathOptions)}}function k(e,t){1&e&&(l.Wb(0,"mat-label",15),l.Fc(1),l.jc(2,"transloco"),l.Vb()),2&e&&(l.Eb(1),l.Gc(l.kc(2,1,"FontSize")))}function j(e,t){if(1&e&&(l.Wb(0,"mat-label"),l.Wb(1,"span"),l.Fc(2),l.Vb(),l.Fc(3),l.jc(4,"date"),l.Vb()),2&e){const e=l.ic(2);l.Eb(1),l.Gb(e.isSuccessScore?"success-score":"fail-score"),l.Eb(1),l.Gc(e.selectedExerciseUserScore.Score),l.Eb(1),l.Hc(" (",l.lc(4,4,e.selectedExerciseUserScore.TakenDate,"yyyy-M-d"),")")}}function P(e,t){if(1&e&&(l.Wb(0,"h3"),l.Fc(1),l.Vb()),2&e){const e=l.ic(2);l.Eb(1),l.Hc("ID: ",e.selectedExercise.ID,"")}}function O(e,t){if(1&e&&(l.Wb(0,"h3"),l.Fc(1),l.jc(2,"transloco"),l.jc(3,"transloco"),l.Vb()),2&e){const e=l.ic(2);l.Eb(1),l.Ic("",l.kc(2,2,"Type"),": ",l.kc(3,4,e.getExerciseItemTypeName(e.selectedExercise.ItemType)),"")}}function V(e,t){if(1&e&&(l.Wb(0,"h3"),l.Fc(1),l.jc(2,"transloco"),l.Vb()),2&e){const e=l.ic(2);l.Eb(1),l.Ic("",l.kc(2,2,"Tags"),": ",e.selectedExercise.Tags.toString(),"")}}function W(e,t){1&e&&l.Rb(0,"mat-divider")}function y(e,t){if(1&e&&(l.Wb(0,"div",13),l.Rb(1,"mat-divider"),l.Wb(2,"h3"),l.Fc(3),l.jc(4,"transloco"),l.Vb(),l.Rb(5,"markdown",5),l.Vb()),2&e){const e=l.ic(2);l.Bc("font-size",e.fontSize,"px"),l.Eb(3),l.Gc(l.kc(4,5,"Answer")),l.Eb(2),l.oc("data",e.selectedExercise.Answer)("katexOptions",e.mathOptions)}}function M(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div",3),l.Wb(1,"div",6),l.Wb(2,"mat-checkbox",7),l.ec("ngModelChange",function(t){return l.xc(e),l.ic().focusMode=t}),l.jc(3,"transloco"),l.Fc(4),l.jc(5,"transloco"),l.Vb(),l.Wb(6,"mat-checkbox",8),l.ec("ngModelChange",function(t){return l.xc(e),l.ic().hideAnswer=t}),l.jc(7,"transloco"),l.Fc(8),l.jc(9,"transloco"),l.Vb(),l.Ec(10,k,3,3,"mat-label",9),l.Wb(11,"mat-slider",10),l.ec("ngModelChange",function(t){return l.xc(e),l.ic().fontSize=t}),l.jc(12,"transloco"),l.Vb(),l.Vb(),l.Wb(13,"div",6),l.Ec(14,j,5,7,"mat-label",11),l.Wb(15,"button",12),l.ec("click",function(){return l.xc(e),l.ic().onNewScore()}),l.Fc(16),l.jc(17,"transloco"),l.Vb(),l.Vb(),l.Rb(18,"mat-divider"),l.Ec(19,P,2,1,"h3",11),l.Ec(20,O,4,6,"h3",11),l.Ec(21,V,3,4,"h3",11),l.Ec(22,W,1,0,"mat-divider",11),l.Wb(23,"div",13),l.Wb(24,"h3"),l.Fc(25),l.jc(26,"transloco"),l.Vb(),l.Rb(27,"markdown",5),l.Vb(),l.Ec(28,y,6,7,"div",14),l.Vb()}if(2&e){const e=l.ic();l.Eb(2),l.pc("matTooltip",l.kc(3,21,"FocusMode")),l.oc("ngModel",e.focusMode),l.Eb(2),l.Gc(l.kc(5,23,"FocusMode")),l.Eb(2),l.pc("matTooltip",l.kc(7,25,"QuizMode")),l.oc("ngModel",e.hideAnswer),l.Eb(2),l.Gc(l.kc(9,27,"QuizMode")),l.Eb(2),l.oc("ngIf",!e.mobileQuery.matches),l.Eb(1),l.pc("matTooltip",l.kc(12,29,"FontSize")),l.oc("ngModel",e.fontSize),l.Eb(3),l.oc("ngIf",e.selectedExerciseUserScore),l.Eb(2),l.Gc(l.kc(17,31,"NewPractice")),l.Eb(3),l.oc("ngIf",!e.focusMode),l.Eb(1),l.oc("ngIf",!e.focusMode),l.Eb(1),l.oc("ngIf",!e.focusMode),l.Eb(1),l.oc("ngIf",!e.focusMode),l.Eb(1),l.Bc("font-size",e.fontSize,"px"),l.Eb(2),l.Gc(l.kc(26,33,"Content")),l.Eb(2),l.oc("data",e.selectedExercise.Content)("katexOptions",e.mathOptions),l.Eb(1),l.oc("ngIf",!e.hideAnswer)}}const F=[{path:"",component:(()=>{class e{constructor(e,t,c,i,o){this.odataSvc=e,this._bottomSheet=i,this.uiUtilSrv=o,this.selectedExerciseUserScore=null,this.listPreviewObjects=[],this.mathOptions={displayMode:!0,throwOnError:!1,errorColor:"#cc0000"},this.focusMode=!1,this.hideAnswer=!1,this.fontSize=20,this.mobileQuery=c.matchMedia("(max-width: 600px)"),this._mobileQueryListener=()=>t.detectChanges(),this.previewIdx=-1}getExerciseItemTypeName(e){return Object(a.J)(e)}get isSuccessScore(){return null!==this.selectedExerciseUserScore&&this.selectedExerciseUserScore.Score>=60}ngOnInit(){this.mobileQuery.addEventListener("change",this._mobileQueryListener),this.listPreviewObjects=this.uiUtilSrv.previewObjList.slice(),this.uiUtilSrv.previewObjList=[],this.listPreviewObjects.length>0&&(this.previewIdx=-1,this.onNextPreviewItem())}ngOnDestroy(){this.mobileQuery.removeEventListener("change",this._mobileQueryListener)}onPreviousPreviewItem(){this.previewIdx>0&&(this.previewIdx--,this.selectedObj=this.listPreviewObjects[this.previewIdx],this.fetchPreviewItem())}onNextPreviewItem(){this.previewIdx<this.listPreviewObjects.length&&(this.previewIdx++,this.selectedObj=this.listPreviewObjects[this.previewIdx],this.fetchPreviewItem())}get isNextPreviewButtonEnabled(){return this.previewIdx<this.listPreviewObjects.length-1}get isPreviousButtonEnabled(){return this.previewIdx>0}fetchPreviewItem(){var e,t;this.previewIdx>-1&&this.previewIdx<this.listPreviewObjects.length&&((null===(e=this.selectedObj)||void 0===e?void 0:e.refType)===a.D.KnowledgeItem?this.odataSvc.readKnowledgeItem(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:e=>{this.selectedKnowledge=e},error:e=>{this.uiUtilSrv.showSnackInfo(e)}}):(null===(t=this.selectedObj)||void 0===t?void 0:t.refType)===a.D.ExerciseItem&&(this.odataSvc.readExerciseItem(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:e=>{this.selectedExercise=e},error:e=>{this.uiUtilSrv.showSnackInfo(e)}}),this.odataSvc.getLastestExerciseItemUserScore(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:e=>{this.selectedExerciseUserScore=e},error:e=>{this.uiUtilSrv.showSnackInfo(e)}})))}onNewScore(){var e;this._bottomSheet.open(m,{data:{excitemid:null===(e=this.selectedExercise)||void 0===e?void 0:e.ID}}).afterDismissed().subscribe(e=>{e.resultFlag?e.newScore&&(this.selectedExerciseUserScore=e.newScore):this.uiUtilSrv.showSnackInfo(e.errorInfo)})}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(d.b),l.Qb(l.h),l.Qb(f.c),l.Qb(b.b),l.Qb(d.d))},e.\u0275cmp=l.Kb({type:e,selectors:[["app-preview"]],decls:22,vars:22,consts:[[1,"button-row"],["mat-raised-button","",3,"disabled","click"],["class","mat-typography","style","margin: 8px;",4,"ngIf"],[1,"mat-typography",2,"margin","8px"],[1,"control-full-width",2,"margin-top","16px","font-size","large"],["katex","",3,"data","katexOptions"],[1,"button-row",2,"margin","8px"],["color","primary","name","focusmode",2,"margin-left","4px",3,"ngModel","matTooltip","ngModelChange"],["color","primary","name","quizmode",2,"margin-left","4px",3,"ngModel","matTooltip","ngModelChange"],["style","margin-left: 4px;",4,"ngIf"],["thumbLabel","","step","2","min","10","max","40",3,"ngModel","matTooltip","ngModelChange"],[4,"ngIf"],["mat-raised-button","",3,"click"],[1,"control-full-width",2,"margin-top","16px"],["class","control-full-width","style","margin-top: 16px;",3,"font-size",4,"ngIf"],[2,"margin-left","4px"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Wb(1,"div"),l.Fc(2),l.Vb(),l.Wb(3,"button",1),l.ec("click",function(){return t.onPreviousPreviewItem()}),l.Fc(4),l.jc(5,"transloco"),l.Vb(),l.Wb(6,"button",1),l.ec("click",function(){return t.onNextPreviewItem()}),l.Fc(7),l.jc(8,"transloco"),l.Vb(),l.Vb(),l.Rb(9,"mat-divider"),l.Ec(10,S,10,7,"div",2),l.Ec(11,M,29,35,"div",2),l.Rb(12,"mat-divider"),l.Wb(13,"div",0),l.Wb(14,"div"),l.Fc(15),l.Vb(),l.Wb(16,"button",1),l.ec("click",function(){return t.onPreviousPreviewItem()}),l.Fc(17),l.jc(18,"transloco"),l.Vb(),l.Wb(19,"button",1),l.ec("click",function(){return t.onNextPreviewItem()}),l.Fc(20),l.jc(21,"transloco"),l.Vb(),l.Vb()),2&e&&(l.Eb(2),l.Ic(" ",t.previewIdx+1," / ",t.listPreviewObjects.length,""),l.Eb(1),l.oc("disabled",!t.isPreviousButtonEnabled),l.Eb(1),l.Gc(l.kc(5,14,"Common.Previous")),l.Eb(2),l.oc("disabled",!t.isNextPreviewButtonEnabled),l.Eb(1),l.Gc(l.kc(8,16,"Common.Next")),l.Eb(3),l.oc("ngIf",t.selectedObj&&1===t.selectedObj.refType&&t.selectedKnowledge),l.Eb(1),l.oc("ngIf",t.selectedObj&&2===t.selectedObj.refType&&t.selectedExercise),l.Eb(4),l.Ic(" ",t.previewIdx+1," / ",t.listPreviewObjects.length,""),l.Eb(1),l.oc("disabled",!t.isPreviousButtonEnabled),l.Eb(1),l.Gc(l.kc(18,18,"Common.Previous")),l.Eb(2),l.oc("disabled",!t.isNextPreviewButtonEnabled),l.Eb(1),l.Gc(l.kc(21,20,"Common.Next")))},directives:[p.b,v.a,i.m,w.a,g.a,o.n,o.q,x.a,E.a,I.g],pipes:[s.d,i.e],styles:[".button-row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.button-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:16px}.input-fontsize[_ngcontent-%COMP%]{margin-left:24px;width:100px}mat-slide-toggle[_ngcontent-%COMP%]{width:80px}mat-slider[_ngcontent-%COMP%]{margin-left:8px;width:80px}.success-score[_ngcontent-%COMP%]{color:green;font-size:16px}.fail-score[_ngcontent-%COMP%]{color:red;font-size:16px}"]}),e})()}];let C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.Ob({type:e}),e.\u0275inj=l.Nb({imports:[[r.e.forChild(F)],r.e]}),e})(),N=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.Ob({type:e}),e.\u0275inj=l.Nb({imports:[[i.c,o.i,o.s,s.c,n.a,w.b,C]]}),e})()}}]);