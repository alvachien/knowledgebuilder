(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"82/d":function(t,e,o){"use strict";o.r(e),o.d(e,"AwardModule",function(){return oo});var c=o("ofXK"),n=o("3Pt+"),a=o("QPBi"),i=o("jIBr"),r=o("iasb"),s=o("tyNb"),l=o("0IaG"),b=o("wd/R"),d=o.n(b),u=o("VHTt"),m=o("fXoL"),h=o("o0su"),p=o("/t3+"),f=o("bTqV"),g=o("Qu3c"),E=o("NFeN"),C=o("+0xr"),W=o("M9IT"),V=o("f0Cb"),D=o("kmnG"),v=o("d3UM"),w=o("qFsG"),k=o("iadO"),F=o("FKr1");function y(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.TargetUser")))}function G(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit,o=m.ic();m.Eb(1),m.Ic("",o.getUserDisplayAs(t.targetUser)," (",t.targetUser,")")}}function T(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Quiz.Date")))}function S(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.getRecordDateDisplayString())}}function U(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.Point")))}function R(t,e){if(1&t){const t=m.Xb();m.Wb(0,"td",16),m.Fc(1),m.Wb(2,"button",17),m.ec("click",function(){m.xc(t);const o=e.$implicit;return m.ic().onGetPoints(o.targetUser,o.recordDate)}),m.jc(3,"transloco"),m.Wb(4,"mat-icon"),m.Fc(5,"visibility"),m.Vb(),m.Vb(),m.Vb()}if(2&t){const t=e.$implicit;m.Eb(1),m.Hc(" ",t.point," | "),m.Eb(1),m.pc("matTooltip",m.kc(3,2,"Award.Point"))}}function j(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.AggregatedPoints")))}function x(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.aggPoint)}}function M(t,e){1&t&&m.Rb(0,"tr",18)}function A(t,e){1&t&&m.Rb(0,"tr",19)}function P(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1,"#"),m.Vb())}function I(t,e){if(1&t){const t=m.Xb();m.Wb(0,"td",16),m.Wb(1,"button",24),m.ec("click",function(){m.xc(t);const o=e.$implicit;return m.ic(2).onDeletePoint(o.id)}),m.jc(2,"transloco"),m.Wb(3,"mat-icon"),m.Fc(4,"remove_circle"),m.Vb(),m.Vb(),m.Vb()}if(2&t){const t=e.$implicit;m.Eb(1),m.pc("matTooltip",m.kc(2,2,"Common.Delete")),m.oc("disabled",t.matchedRuleID)}}function O(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.TargetUser")))}function $(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit,o=m.ic(2);m.Eb(1),m.Ic("",o.getUserDisplayAs(t.targetUser)," (",t.targetUser,")")}}function H(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Quiz.Date")))}function N(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.getRecordDateDisplayString())}}function _(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1,"Rule ID"),m.Vb())}function B(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.matchedRuleID)}}function q(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.ContinuousDays")))}function Q(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.countOfDay)}}function L(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.Point")))}function z(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.point)}}function K(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Common.Comment")))}function X(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.comment)}}function J(t,e){1&t&&m.Rb(0,"tr",18)}function Y(t,e){1&t&&m.Rb(0,"tr",19)}function Z(t,e){if(1&t){const t=m.Xb();m.Wb(0,"div"),m.Wb(1,"mat-toolbar"),m.Wb(2,"h3"),m.Fc(3),m.jc(4,"transloco"),m.Vb(),m.Rb(5,"div",0),m.Wb(6,"button",17),m.ec("click",function(){return m.xc(t),m.ic().onHidePoints()}),m.jc(7,"transloco"),m.Wb(8,"mat-icon"),m.Fc(9,"visibility_off"),m.Vb(),m.Vb(),m.Vb(),m.Wb(10,"div",2),m.Wb(11,"div",3),m.Wb(12,"table",4),m.Ub(13,20),m.Ec(14,P,2,0,"th",6),m.Ec(15,I,5,4,"td",7),m.Tb(),m.Ub(16,5),m.Ec(17,O,3,3,"th",6),m.Ec(18,$,2,2,"td",7),m.Tb(),m.Ub(19,8),m.Ec(20,H,3,3,"th",6),m.Ec(21,N,2,1,"td",7),m.Tb(),m.Ub(22,21),m.Ec(23,_,2,0,"th",6),m.Ec(24,B,2,1,"td",7),m.Tb(),m.Ub(25,22),m.Ec(26,q,3,3,"th",6),m.Ec(27,Q,2,1,"td",7),m.Tb(),m.Ub(28,9),m.Ec(29,L,3,3,"th",6),m.Ec(30,z,2,1,"td",7),m.Tb(),m.Ub(31,23),m.Ec(32,K,3,3,"th",6),m.Ec(33,X,2,1,"td",7),m.Tb(),m.Ec(34,J,1,0,"tr",11),m.Ec(35,Y,1,0,"tr",12),m.Vb(),m.Vb(),m.Vb(),m.Vb()}if(2&t){const t=m.ic();m.Eb(3),m.Jc("",m.kc(4,7,"Award.Point"),", ",t.selectedUser,", ",t.selectedDate,""),m.Eb(3),m.pc("matTooltip",m.kc(7,9,"Common.Hide")),m.Eb(6),m.oc("dataSource",t.dataSourcePoints),m.Eb(22),m.oc("matHeaderRowDef",t.displayedPointColumns),m.Eb(1),m.oc("matRowDefColumns",t.displayedPointColumns)}}function tt(t,e){if(1&t&&(m.Wb(0,"mat-option",15),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.oc("value",t.targetUser),m.Eb(1),m.Hc(" ",t.displayAs," ")}}const et="table[_ngcontent-%COMP%]{width:100%}.example-form[_ngcontent-%COMP%]{min-width:250px;max-width:500px;width:100%}.example-margin[_ngcontent-%COMP%]{margin:0 10px}";let ot=(()=>{class t{constructor(t,e,o){this.oDataSrv=t,this.dialog=e,this.uiUtilSrv=o,this.dataSource=[],this.dataSourcePoints=[],this.recordCount=0,this.displayedColumns=["targetUser","recordDate","point","aggpoint"],this.displayedPointColumns=["action","targetUser","recordDate","matchedRuleID","countOfDay","point","comment"],this.selectedUser="",this.selectedDate="",this.isPointShow=!1}ngOnInit(){this.refreshList()}get isExpertMode(){return this.oDataSrv.isLoggedin}getUserDisplayAs(t){if(t&&this.oDataSrv.currentUserDetail){const e=this.oDataSrv.currentUserDetail.awardUsers.findIndex(e=>e.targetUser===t);if(-1!==e)return this.oDataSrv.currentUserDetail.awardUsers[e].displayAs}return""}onCreateAward(){this.dialog.open(ct,{width:"600px",closeOnNavigation:!1,data:new u.c}).afterClosed().subscribe(t=>{console.log("The dialog was closed with result: "+t),t&&this.oDataSrv.createAwardPoint(t).subscribe({next:t=>{this.refreshList()},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})})}refreshList(){this.oDataSrv.getAwardPointReports(100,0).subscribe({next:t=>{this.dataSource=t.items.slice(),this.recordCount=t.totalCount},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}onGetPoints(t,e){this.oDataSrv.getAwardPoints(100,0,void 0,`TargetUser eq '${t}' AND RecordDate eq ${e.format(u.O)}`).subscribe({next:o=>{this.selectedUser=t,this.selectedDate=e.format(u.O),this.dataSourcePoints=[],this.dataSourcePoints=o.items.slice(),this.isPointShow=!0},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}onHidePoints(){this.selectedDate="",this.selectedUser="",this.dataSourcePoints=[],this.isPointShow=!1}onDeletePoint(t){this.oDataSrv.deleteAwardPoint(t).subscribe({next:t=>{this.onGetPoints(this.selectedUser,d()(this.selectedDate))},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}}return t.\u0275fac=function(e){return new(e||t)(m.Qb(h.d),m.Qb(l.b),m.Qb(h.f))},t.\u0275cmp=m.Kb({type:t,selectors:[["app-overview"]],decls:29,vars:13,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary",3,"disabled","matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","targetUser"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","recordDate"],["matColumnDef","point"],["matColumnDef","aggpoint"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],[4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""],["matColumnDef","action"],["matColumnDef","matchedRuleID"],["matColumnDef","countOfDay"],["matColumnDef","comment"],["mat-icon-button","","color","warn",3,"disabled","matTooltip","click"]],template:function(t,e){1&t&&(m.Wb(0,"mat-toolbar"),m.Wb(1,"h1"),m.Fc(2),m.jc(3,"transloco"),m.Vb(),m.Rb(4,"div",0),m.Wb(5,"button",1),m.ec("click",function(){return e.onCreateAward()}),m.jc(6,"transloco"),m.Wb(7,"mat-icon"),m.Fc(8,"add_circle"),m.Vb(),m.Vb(),m.Vb(),m.Wb(9,"div",2),m.Wb(10,"div",3),m.Wb(11,"table",4),m.Ub(12,5),m.Ec(13,y,3,3,"th",6),m.Ec(14,G,2,2,"td",7),m.Tb(),m.Ub(15,8),m.Ec(16,T,3,3,"th",6),m.Ec(17,S,2,1,"td",7),m.Tb(),m.Ub(18,9),m.Ec(19,U,3,3,"th",6),m.Ec(20,R,6,4,"td",7),m.Tb(),m.Ub(21,10),m.Ec(22,j,3,3,"th",6),m.Ec(23,x,2,1,"td",7),m.Tb(),m.Ec(24,M,1,0,"tr",11),m.Ec(25,A,1,0,"tr",12),m.Vb(),m.Vb(),m.Rb(26,"mat-paginator",13),m.Vb(),m.Rb(27,"mat-divider"),m.Ec(28,Z,36,11,"div",14)),2&t&&(m.Eb(2),m.Gc(m.kc(3,9,"Award.Overview")),m.Eb(3),m.pc("matTooltip",m.kc(6,11,"Common.Create")),m.oc("disabled",!e.isExpertMode),m.Eb(6),m.oc("dataSource",e.dataSource),m.Eb(13),m.oc("matHeaderRowDef",e.displayedColumns),m.Eb(1),m.oc("matRowDefColumns",e.displayedColumns),m.Eb(1),m.oc("length",e.recordCount)("pageSize",20),m.Eb(2),m.oc("ngIf",e.isPointShow))},directives:[p.a,f.b,g.a,E.a,C.j,C.c,C.e,C.b,C.g,C.i,W.a,V.a,c.m,C.d,C.a,C.f,C.h],pipes:[a.d],styles:[et]}),t})(),ct=(()=>{class t{constructor(t,e,o){this.dialogRef=t,this.oDataSrv=e,this.data=o}onNoClick(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(m.Qb(l.g),m.Qb(h.d),m.Qb(l.a))},t.\u0275cmp=m.Kb({type:t,selectors:[["app-overview-award-point-crtdlg"]],decls:33,vars:21,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"example-form"],["appearance","fill",1,"control-full-width"],["name","targetuser",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],["matInput","","name","recorddate",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["matInput","","type","number","name","point",3,"ngModel","ngModelChange"],["matInput","","name","comment",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"disabled","mat-dialog-close"],[3,"value"]],template:function(t,e){if(1&t&&(m.Wb(0,"h1",0),m.Fc(1,"CREATE AWARD POINT"),m.Vb(),m.Wb(2,"div",1),m.Wb(3,"form",2),m.Wb(4,"mat-form-field",3),m.Wb(5,"mat-label"),m.Fc(6),m.jc(7,"transloco"),m.Vb(),m.Wb(8,"mat-select",4),m.ec("ngModelChange",function(t){return e.data.targetUser=t}),m.Ec(9,tt,2,2,"mat-option",5),m.Vb(),m.Vb(),m.Wb(10,"mat-form-field",6),m.Wb(11,"mat-label"),m.Fc(12),m.jc(13,"transloco"),m.Vb(),m.Wb(14,"input",7),m.ec("ngModelChange",function(t){return e.data.recordDate=t}),m.Vb(),m.Rb(15,"mat-datepicker-toggle",8),m.Rb(16,"mat-datepicker",null,9),m.Vb(),m.Wb(18,"mat-form-field",3),m.Wb(19,"mat-label"),m.Fc(20),m.jc(21,"transloco"),m.Vb(),m.Wb(22,"input",10),m.ec("ngModelChange",function(t){return e.data.point=t}),m.Vb(),m.Vb(),m.Wb(23,"mat-form-field",3),m.Wb(24,"mat-label"),m.Fc(25),m.jc(26,"transloco"),m.Vb(),m.Wb(27,"input",11),m.ec("ngModelChange",function(t){return e.data.comment=t}),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(28,"div",12),m.Wb(29,"button",13),m.ec("click",function(){return e.onNoClick()}),m.Fc(30,"No Thanks"),m.Vb(),m.Wb(31,"button",14),m.Fc(32,"OK"),m.Vb(),m.Vb()),2&t){const t=m.vc(17);m.Eb(6),m.Gc(m.kc(7,13,"Award.TargetUser")),m.Eb(2),m.oc("ngModel",e.data.targetUser),m.Eb(1),m.oc("ngForOf",null==e.oDataSrv.currentUserDetail?null:e.oDataSrv.currentUserDetail.awardUsers),m.Eb(3),m.Gc(m.kc(13,15,"Quiz.Date")),m.Eb(2),m.oc("matDatepicker",t)("ngModel",e.data.recordDate),m.Eb(1),m.oc("for",t),m.Eb(5),m.Gc(m.kc(21,17,"Award.Point")),m.Eb(2),m.oc("ngModel",e.data.point),m.Eb(3),m.Gc(m.kc(26,19,"Common.Comment")),m.Eb(2),m.oc("ngModel",e.data.comment),m.Eb(4),m.oc("disabled",!e.data.isValid())("mat-dialog-close",e.data)}},directives:[l.h,l.e,n.v,n.o,n.p,D.c,D.g,v.a,n.n,n.q,c.l,w.b,k.d,n.c,k.f,D.i,k.c,n.r,l.c,f.b,l.d,F.n],pipes:[a.d],styles:[et]}),t})();var nt=o("tPNy");function at(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1,"#"),m.Vb())}function it(t,e){if(1&t){const t=m.Xb();m.Wb(0,"td",16),m.Fc(1),m.Wb(2,"button",17),m.ec("click",function(){m.xc(t);const o=e.$implicit;return m.ic().onDisplayRuleGroup(o.id)}),m.jc(3,"transloco"),m.Wb(4,"mat-icon"),m.Fc(5,"launch"),m.Vb(),m.Vb(),m.Wb(6,"button",18),m.ec("click",function(){m.xc(t);const o=e.$implicit;return m.ic().onDeleteRuleGroup(o.id)}),m.jc(7,"transloco"),m.Wb(8,"mat-icon"),m.Fc(9,"remove_circle"),m.Vb(),m.Vb(),m.Vb()}if(2&t){const t=e.$implicit;m.Eb(1),m.Hc("",t.id," | "),m.Eb(1),m.pc("matTooltip",m.kc(3,3,"Common.Display")),m.Eb(4),m.pc("matTooltip",m.kc(7,5,"Common.Delete"))}}function rt(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.TargetUser")))}function st(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit,o=m.ic();m.Eb(1),m.Ic("",o.getUserDisplayAs(t.targetUser)," (",t.targetUser,")")}}function lt(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Type")))}function bt(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t){const t=e.$implicit,o=m.ic();m.Eb(1),m.Gc(m.kc(2,1,o.getAwardRuleTypeName(t.ruleType)))}}function dt(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.Validity")))}function ut(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.validity)}}function mt(t,e){1&t&&(m.Wb(0,"th",15),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Common.Description")))}function ht(t,e){if(1&t&&(m.Wb(0,"td",16),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.desp)}}function pt(t,e){1&t&&m.Rb(0,"tr",19)}function ft(t,e){1&t&&m.Rb(0,"tr",20)}let gt=(()=>{class t{constructor(t,e,o){this.odataSrv=t,this.dialog=e,this.uiUtilSrv=o,this.dataSource=[],this.displayedColumns=["id","targetUser","ruleType","validity","desp"],this.recordCount=0}ngOnInit(){this.refreshList()}get isExpertMode(){return this.odataSrv.isLoggedin}getAwardRuleTypeName(t){return Object(nt.i)(t)}getUserDisplayAs(t){if(t&&this.odataSrv.currentUserDetail){const e=this.odataSrv.currentUserDetail.awardUsers.findIndex(e=>e.targetUser===t);if(-1!==e)return this.odataSrv.currentUserDetail.awardUsers[e].displayAs}return""}onCreateRuleGroup(){this.uiUtilSrv.navigateAwardRuleGenerationPage()}refreshList(){this.odataSrv.getAwardRuleGroups(100,0,void 0).subscribe({next:t=>{this.dataSource=t.items.slice(),this.recordCount=t.totalCount},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}onDeleteRuleGroup(t){this.odataSrv.deleteAwardRuleGroup(t).subscribe({next:t=>{this.refreshList()},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}onDisplayRuleGroup(t){this.uiUtilSrv.navigateAwardRuleGroupDisplayPage(t)}}return t.\u0275fac=function(e){return new(e||t)(m.Qb(h.d),m.Qb(l.b),m.Qb(h.f))},t.\u0275cmp=m.Kb({type:t,selectors:[["app-award-rule"]],decls:30,vars:12,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary",3,"disabled","matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","targetUser"],["matColumnDef","ruleType"],["matColumnDef","validity"],["matColumnDef","desp"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(m.Wb(0,"mat-toolbar"),m.Wb(1,"h1"),m.Fc(2),m.jc(3,"transloco"),m.Vb(),m.Rb(4,"div",0),m.Wb(5,"button",1),m.ec("click",function(){return e.onCreateRuleGroup()}),m.jc(6,"transloco"),m.Wb(7,"mat-icon"),m.Fc(8,"add_circle"),m.Vb(),m.Vb(),m.Vb(),m.Wb(9,"div",2),m.Wb(10,"div",3),m.Wb(11,"table",4),m.Ub(12,5),m.Ec(13,at,2,0,"th",6),m.Ec(14,it,10,7,"td",7),m.Tb(),m.Ub(15,8),m.Ec(16,rt,3,3,"th",6),m.Ec(17,st,2,2,"td",7),m.Tb(),m.Ub(18,9),m.Ec(19,lt,3,3,"th",6),m.Ec(20,bt,3,3,"td",7),m.Tb(),m.Ub(21,10),m.Ec(22,dt,3,3,"th",6),m.Ec(23,ut,2,1,"td",7),m.Tb(),m.Ub(24,11),m.Ec(25,mt,3,3,"th",6),m.Ec(26,ht,2,1,"td",7),m.Tb(),m.Ec(27,pt,1,0,"tr",12),m.Ec(28,ft,1,0,"tr",13),m.Vb(),m.Vb(),m.Rb(29,"mat-paginator",14),m.Vb()),2&t&&(m.Eb(2),m.Gc(m.kc(3,8,"Award.Rules")),m.Eb(3),m.pc("matTooltip",m.kc(6,10,"Common.Create")),m.oc("disabled",!e.isExpertMode),m.Eb(6),m.oc("dataSource",e.dataSource),m.Eb(16),m.oc("matHeaderRowDef",e.displayedColumns),m.Eb(1),m.oc("matRowDefColumns",e.displayedColumns),m.Eb(1),m.oc("length",e.recordCount)("pageSize",20))},directives:[p.a,f.b,g.a,E.a,C.j,C.c,C.e,C.b,C.g,C.i,W.a,C.d,C.a,C.f,C.h],pipes:[a.d],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),t})();var Et=o("bSwM");function Ct(t,e){1&t&&m.Rb(0,"th",23)}function Wt(t,e){if(1&t){const t=m.Xb();m.Wb(0,"td",24),m.Wb(1,"button",25),m.ec("click",function(){m.xc(t);const o=e.$implicit;return m.ic().onGetPoints(o.targetUser,o.recordDate)}),m.jc(2,"transloco"),m.Wb(3,"mat-icon"),m.Fc(4,"visibility"),m.Vb(),m.Vb(),m.Wb(5,"button",26),m.ec("click",function(){m.xc(t);const o=e.$implicit;return m.ic().onDeleteTrace(o.targetUser,o.recordDate)}),m.jc(6,"transloco"),m.Wb(7,"mat-icon"),m.Fc(8,"remove_circle"),m.Vb(),m.Vb(),m.Vb()}2&t&&(m.Eb(1),m.pc("matTooltip",m.kc(2,2,"Award.Point")),m.Eb(4),m.pc("matTooltip",m.kc(6,4,"Common.Delete")))}function Vt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.TargetUser")))}function Dt(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit,o=m.ic();m.Eb(1),m.Ic("",o.getUserDisplayAs(t.targetUser)," (",t.targetUser,")")}}function vt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Quiz.Date")))}function wt(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.getRecordDateDisplayString())}}function kt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.SchoolWorkTime")))}function Ft(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.schoolWorkTime)}}function yt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.GoToBedTime")))}function Gt(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.goToBedTime)}}function Tt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.HomeworkCount")))}function St(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.homeWorkCount)}}function Ut(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.BodyExerciseCount")))}function Rt(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.bodyExerciseCount)}}function jt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.ErrorsCollection")))}function xt(t,e){if(1&t&&(m.Wb(0,"td",24),m.Wb(1,"mat-checkbox",27),m.ec("ngModelChange",function(t){return e.$implicit.errorsCollection=t}),m.Vb(),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.oc("ngModel",t.errorsCollection)}}function Mt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.HandWriting")))}function At(t,e){if(1&t&&(m.Wb(0,"td",24),m.Wb(1,"mat-checkbox",27),m.ec("ngModelChange",function(t){return e.$implicit.handWriting=t}),m.Vb(),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.oc("ngModel",t.handWriting)}}function Pt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.CleanDesk")))}function It(t,e){if(1&t&&(m.Wb(0,"td",24),m.Wb(1,"mat-checkbox",27),m.ec("ngModelChange",function(t){return e.$implicit.cleanDesk=t}),m.Vb(),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.oc("ngModel",t.cleanDesk)}}function Ot(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.HouseKeepingCount")))}function $t(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.houseKeepingCount)}}function Ht(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.PoliteBehavior")))}function Nt(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.politeBehavior)}}function _t(t,e){1&t&&m.Rb(0,"tr",28)}function Bt(t,e){1&t&&m.Rb(0,"tr",29)}function qt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1,"#"),m.Vb())}function Qt(t,e){if(1&t){const t=m.Xb();m.Wb(0,"td",24),m.Fc(1),m.Wb(2,"button",34),m.ec("click",function(){m.xc(t);const o=e.$implicit;return m.ic(2).onDeletePoint(o.id)}),m.jc(3,"transloco"),m.Wb(4,"mat-icon"),m.Fc(5,"remove_circle"),m.Vb(),m.Vb(),m.Vb()}if(2&t){const t=e.$implicit;m.Eb(1),m.Hc(" ",t.id," | "),m.Eb(1),m.pc("matTooltip",m.kc(3,3,"Common.Delete")),m.oc("disabled",t.matchedRuleID)}}function Lt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.TargetUser")))}function zt(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.targetUser)}}function Kt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Quiz.Date")))}function Xt(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.getRecordDateDisplayString())}}function Jt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1,"Rule ID"),m.Vb())}function Yt(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.matchedRuleID)}}function Zt(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.ContinuousDays")))}function te(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.countOfDay)}}function ee(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.Point")))}function oe(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.point)}}function ce(t,e){1&t&&(m.Wb(0,"th",23),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Common.Comment")))}function ne(t,e){if(1&t&&(m.Wb(0,"td",24),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.comment)}}function ae(t,e){1&t&&m.Rb(0,"tr",28)}function ie(t,e){1&t&&m.Rb(0,"tr",29)}function re(t,e){if(1&t){const t=m.Xb();m.Wb(0,"div"),m.Wb(1,"mat-toolbar"),m.Wb(2,"h3"),m.Fc(3),m.jc(4,"transloco"),m.Vb(),m.Rb(5,"div",0),m.Wb(6,"button",25),m.ec("click",function(){return m.xc(t),m.ic().onHidePoints()}),m.jc(7,"transloco"),m.Wb(8,"mat-icon"),m.Fc(9,"visibility_off"),m.Vb(),m.Vb(),m.Vb(),m.Wb(10,"div",2),m.Wb(11,"div",3),m.Wb(12,"table",4),m.Ub(13,5),m.Ec(14,qt,2,0,"th",6),m.Ec(15,Qt,6,5,"td",7),m.Tb(),m.Ub(16,8),m.Ec(17,Lt,3,3,"th",6),m.Ec(18,zt,2,1,"td",7),m.Tb(),m.Ub(19,9),m.Ec(20,Kt,3,3,"th",6),m.Ec(21,Xt,2,1,"td",7),m.Tb(),m.Ub(22,30),m.Ec(23,Jt,2,0,"th",6),m.Ec(24,Yt,2,1,"td",7),m.Tb(),m.Ub(25,31),m.Ec(26,Zt,3,3,"th",6),m.Ec(27,te,2,1,"td",7),m.Tb(),m.Ub(28,32),m.Ec(29,ee,3,3,"th",6),m.Ec(30,oe,2,1,"td",7),m.Tb(),m.Ub(31,33),m.Ec(32,ce,3,3,"th",6),m.Ec(33,ne,2,1,"td",7),m.Tb(),m.Ec(34,ae,1,0,"tr",19),m.Ec(35,ie,1,0,"tr",20),m.Vb(),m.Vb(),m.Vb(),m.Vb()}if(2&t){const t=m.ic();m.Eb(3),m.Jc("",m.kc(4,7,"Award.Point"),", ",t.selectedUser,", ",t.selectedDate,""),m.Eb(3),m.pc("matTooltip",m.kc(7,9,"Common.Hide")),m.Eb(6),m.oc("dataSource",t.dataSourcePoints),m.Eb(22),m.oc("matHeaderRowDef",t.displayedPointColumns),m.Eb(1),m.oc("matRowDefColumns",t.displayedPointColumns)}}function se(t,e){if(1&t&&(m.Wb(0,"mat-option",22),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.oc("value",t.targetUser),m.Eb(1),m.Gc(t.displayAs)}}let le=(()=>{class t{constructor(t,e,o){this.odataSrv=t,this.dialog=e,this.uiUtilSrv=o,this.dataSourceTrace=[],this.dataSourcePoints=[],this.traceLength=0,this.displayedColumns=["action","targetUser","recordDate","schoolWorkTime","goToBedTime","homeWorkCount","bodyExerciseCount","errorsCollection","handWriting","cleanDesk","houseKeepingCount","politeBehavior"],this.displayedPointColumns=["action","targetUser","recordDate","matchedRuleID","countOfDay","point","comment"],this.selectedUser="",this.selectedDate="",this.isPointShow=!1}ngOnInit(){this.refreshList()}get isExpertMode(){return this.odataSrv.isLoggedin}getUserDisplayAs(t){if(t&&this.odataSrv.currentUserDetail){const e=this.odataSrv.currentUserDetail.awardUsers.findIndex(e=>e.targetUser===t);if(-1!==e)return this.odataSrv.currentUserDetail.awardUsers[e].displayAs}return""}onCreateTrace(){this.dialog.open(be,{width:"600px",closeOnNavigation:!1,data:new u.i}).afterClosed().subscribe(t=>{console.log("The dialog was closed with result: "+t),t&&this.odataSrv.createDailyTrace(t).subscribe({next:t=>{this.refreshList()},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})})}refreshList(){this.odataSrv.getDailyTrace(100,0).subscribe({next:t=>{this.dataSourceTrace=t.items.slice(),this.traceLength=t.totalCount},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}onGetPoints(t,e){this.odataSrv.getAwardPoints(100,0,void 0,`TargetUser eq '${t}' AND RecordDate eq ${e.format(u.O)}`).subscribe({next:o=>{this.selectedUser=t,this.selectedDate=e.format(u.O),this.dataSourcePoints=[],this.dataSourcePoints=o.items.slice(),this.isPointShow=!0},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}onDeleteTrace(t,e){this.odataSrv.deleteDailyTrace(t,e).subscribe({next:t=>{this.isPointShow=!1,this.refreshList()},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}onHidePoints(){this.selectedDate="",this.selectedUser="",this.dataSourcePoints=[],this.isPointShow=!1}onDeletePoint(t){this.odataSrv.deleteAwardPoint(t).subscribe({next:t=>{this.onGetPoints(this.selectedUser,d()(this.selectedDate))},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}}return t.\u0275fac=function(e){return new(e||t)(m.Qb(h.d),m.Qb(l.b),m.Qb(h.f))},t.\u0275cmp=m.Kb({type:t,selectors:[["app-daily-trace"]],decls:53,vars:13,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary",3,"disabled","matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","targetUser"],["matColumnDef","recordDate"],["matColumnDef","schoolWorkTime"],["matColumnDef","goToBedTime"],["matColumnDef","homeWorkCount"],["matColumnDef","bodyExerciseCount"],["matColumnDef","errorsCollection"],["matColumnDef","handWriting"],["matColumnDef","cleanDesk"],["matColumnDef","houseKeepingCount"],["matColumnDef","politeBehavior"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],[4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["disabled","",3,"ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""],["matColumnDef","matchedRuleID"],["matColumnDef","countOfDay"],["matColumnDef","point"],["matColumnDef","comment"],["mat-icon-button","","color","warn",3,"disabled","matTooltip","click"]],template:function(t,e){1&t&&(m.Wb(0,"mat-toolbar"),m.Wb(1,"h1"),m.Fc(2),m.jc(3,"transloco"),m.Vb(),m.Rb(4,"div",0),m.Wb(5,"button",1),m.ec("click",function(){return e.onCreateTrace()}),m.jc(6,"transloco"),m.Wb(7,"mat-icon"),m.Fc(8,"add_circle"),m.Vb(),m.Vb(),m.Vb(),m.Wb(9,"div",2),m.Wb(10,"div",3),m.Wb(11,"table",4),m.Ub(12,5),m.Ec(13,Ct,1,0,"th",6),m.Ec(14,Wt,9,6,"td",7),m.Tb(),m.Ub(15,8),m.Ec(16,Vt,3,3,"th",6),m.Ec(17,Dt,2,2,"td",7),m.Tb(),m.Ub(18,9),m.Ec(19,vt,3,3,"th",6),m.Ec(20,wt,2,1,"td",7),m.Tb(),m.Ub(21,10),m.Ec(22,kt,3,3,"th",6),m.Ec(23,Ft,2,1,"td",7),m.Tb(),m.Ub(24,11),m.Ec(25,yt,3,3,"th",6),m.Ec(26,Gt,2,1,"td",7),m.Tb(),m.Ub(27,12),m.Ec(28,Tt,3,3,"th",6),m.Ec(29,St,2,1,"td",7),m.Tb(),m.Ub(30,13),m.Ec(31,Ut,3,3,"th",6),m.Ec(32,Rt,2,1,"td",7),m.Tb(),m.Ub(33,14),m.Ec(34,jt,3,3,"th",6),m.Ec(35,xt,2,1,"td",7),m.Tb(),m.Ub(36,15),m.Ec(37,Mt,3,3,"th",6),m.Ec(38,At,2,1,"td",7),m.Tb(),m.Ub(39,16),m.Ec(40,Pt,3,3,"th",6),m.Ec(41,It,2,1,"td",7),m.Tb(),m.Ub(42,17),m.Ec(43,Ot,3,3,"th",6),m.Ec(44,$t,2,1,"td",7),m.Tb(),m.Ub(45,18),m.Ec(46,Ht,3,3,"th",6),m.Ec(47,Nt,2,1,"td",7),m.Tb(),m.Ec(48,_t,1,0,"tr",19),m.Ec(49,Bt,1,0,"tr",20),m.Vb(),m.Vb(),m.Rb(50,"mat-paginator",21),m.Vb(),m.Rb(51,"mat-divider"),m.Ec(52,re,36,11,"div",22)),2&t&&(m.Eb(2),m.Gc(m.kc(3,9,"Award.DailyTrace")),m.Eb(3),m.pc("matTooltip",m.kc(6,11,"Common.Create")),m.oc("disabled",!e.isExpertMode),m.Eb(6),m.oc("dataSource",e.dataSourceTrace),m.Eb(37),m.oc("matHeaderRowDef",e.displayedColumns),m.Eb(1),m.oc("matRowDefColumns",e.displayedColumns),m.Eb(1),m.oc("length",e.traceLength)("pageSize",20),m.Eb(2),m.oc("ngIf",e.isPointShow))},directives:[p.a,f.b,g.a,E.a,C.j,C.c,C.e,C.b,C.g,C.i,W.a,V.a,c.m,C.d,C.a,Et.a,n.n,n.q,C.f,C.h],pipes:[a.d],styles:["table[_ngcontent-%COMP%]{width:100%}.example-form[_ngcontent-%COMP%]{min-width:250px;max-width:500px;width:100%}.example-margin[_ngcontent-%COMP%]{margin:0 10px}td[_ngcontent-%COMP%]{padding-right:8px}"]}),t})(),be=(()=>{class t{constructor(t,e,o){this.dialogRef=t,this.odataSrv=e,this.data=o}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}onNoClick(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(m.Qb(l.g),m.Qb(h.d),m.Qb(l.a))},t.\u0275cmp=m.Kb({type:t,selectors:[["app-daily-trace-create-dialog"]],decls:63,vars:52,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"example-form"],["appearance","fill",1,"control-full-width"],["required","","name","targetuser",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],["matInput","","name","recorddate",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["matInput","","type","number","name","schoolworktime",3,"ngModel","ngModelChange"],["matInput","","type","number","name","gotobedtime",3,"ngModel","ngModelChange"],["matInput","","type","number","name","homeworkcount",3,"ngModel","ngModelChange"],["matInput","","type","number","name","bodyexercisecount",3,"ngModel","ngModelChange"],["name","errorcollection",1,"example-margin",3,"ngModel","ngModelChange"],["name","handwriting",1,"example-margin",3,"ngModel","ngModelChange"],["name","cleandesk",1,"example-margin",3,"ngModel","ngModelChange"],["matInput","","type","number","name","housekeepingcount",3,"ngModel","ngModelChange"],["matInput","","type","number","name","politebehavior",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"disabled","mat-dialog-close"],[3,"value"]],template:function(t,e){if(1&t&&(m.Wb(0,"h1",0),m.Fc(1,"CREATE DAILY TRACE"),m.Vb(),m.Wb(2,"div",1),m.Wb(3,"form",2),m.Wb(4,"mat-form-field",3),m.Wb(5,"mat-label"),m.Fc(6),m.jc(7,"transloco"),m.Vb(),m.Wb(8,"mat-select",4),m.ec("ngModelChange",function(t){return e.data.targetUser=t}),m.Ec(9,se,2,2,"mat-option",5),m.Vb(),m.Vb(),m.Wb(10,"mat-form-field",6),m.Wb(11,"mat-label"),m.Fc(12),m.jc(13,"transloco"),m.Vb(),m.Wb(14,"input",7),m.ec("ngModelChange",function(t){return e.data.recordDate=t}),m.Vb(),m.Rb(15,"mat-datepicker-toggle",8),m.Rb(16,"mat-datepicker",null,9),m.Vb(),m.Wb(18,"mat-form-field",3),m.Wb(19,"mat-label"),m.Fc(20),m.jc(21,"transloco"),m.Vb(),m.Wb(22,"input",10),m.ec("ngModelChange",function(t){return e.data.schoolWorkTime=t}),m.Vb(),m.Vb(),m.Wb(23,"mat-form-field",3),m.Wb(24,"mat-label"),m.Fc(25),m.jc(26,"transloco"),m.Vb(),m.Wb(27,"input",11),m.ec("ngModelChange",function(t){return e.data.goToBedTime=t}),m.Vb(),m.Vb(),m.Wb(28,"mat-form-field",3),m.Wb(29,"mat-label"),m.Fc(30),m.jc(31,"transloco"),m.Vb(),m.Wb(32,"input",12),m.ec("ngModelChange",function(t){return e.data.homeWorkCount=t}),m.Vb(),m.Vb(),m.Wb(33,"mat-form-field",3),m.Wb(34,"mat-label"),m.Fc(35),m.jc(36,"transloco"),m.Vb(),m.Wb(37,"input",13),m.ec("ngModelChange",function(t){return e.data.bodyExerciseCount=t}),m.Vb(),m.Vb(),m.Wb(38,"mat-checkbox",14),m.ec("ngModelChange",function(t){return e.data.errorsCollection=t}),m.Fc(39),m.jc(40,"transloco"),m.Vb(),m.Wb(41,"mat-checkbox",15),m.ec("ngModelChange",function(t){return e.data.handWriting=t}),m.Fc(42),m.jc(43,"transloco"),m.Vb(),m.Wb(44,"mat-checkbox",16),m.ec("ngModelChange",function(t){return e.data.cleanDesk=t}),m.Fc(45),m.jc(46,"transloco"),m.Vb(),m.Wb(47,"mat-form-field",3),m.Wb(48,"mat-label"),m.Fc(49),m.jc(50,"transloco"),m.Vb(),m.Wb(51,"input",17),m.ec("ngModelChange",function(t){return e.data.houseKeepingCount=t}),m.Vb(),m.Vb(),m.Wb(52,"mat-form-field",3),m.Wb(53,"mat-label"),m.Fc(54),m.jc(55,"transloco"),m.Vb(),m.Wb(56,"input",18),m.ec("ngModelChange",function(t){return e.data.politeBehavior=t}),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(57,"div",19),m.Wb(58,"button",20),m.ec("click",function(){return e.onNoClick()}),m.Fc(59),m.jc(60,"transloco"),m.Vb(),m.Wb(61,"button",21),m.Fc(62,"OK"),m.Vb(),m.Vb()),2&t){const t=m.vc(17);m.Eb(6),m.Gc(m.kc(7,28,"Award.TargetUser")),m.Eb(2),m.oc("ngModel",e.data.targetUser),m.Eb(1),m.oc("ngForOf",e.arTargetUsers),m.Eb(3),m.Gc(m.kc(13,30,"Quiz.Date")),m.Eb(2),m.oc("matDatepicker",t)("ngModel",e.data.recordDate),m.Eb(1),m.oc("for",t),m.Eb(5),m.Gc(m.kc(21,32,"Award.SchoolWorkTime")),m.Eb(2),m.oc("ngModel",e.data.schoolWorkTime),m.Eb(3),m.Gc(m.kc(26,34,"Award.GoToBedTime")),m.Eb(2),m.oc("ngModel",e.data.goToBedTime),m.Eb(3),m.Gc(m.kc(31,36,"Award.HomeworkCount")),m.Eb(2),m.oc("ngModel",e.data.homeWorkCount),m.Eb(3),m.Gc(m.kc(36,38,"Award.BodyExerciseCount")),m.Eb(2),m.oc("ngModel",e.data.bodyExerciseCount),m.Eb(1),m.oc("ngModel",e.data.errorsCollection),m.Eb(1),m.Gc(m.kc(40,40,"Award.ErrorsCollection")),m.Eb(2),m.oc("ngModel",e.data.handWriting),m.Eb(1),m.Gc(m.kc(43,42,"Award.HandWriting")),m.Eb(2),m.oc("ngModel",e.data.cleanDesk),m.Eb(1),m.Gc(m.kc(46,44,"Award.CleanDesk")),m.Eb(4),m.Gc(m.kc(50,46,"Award.HouseKeepingCount")),m.Eb(2),m.oc("ngModel",e.data.houseKeepingCount),m.Eb(3),m.Gc(m.kc(55,48,"Award.PoliteBehavior")),m.Eb(2),m.oc("ngModel",e.data.politeBehavior),m.Eb(3),m.Gc(m.kc(60,50,"Common.NoThanks")),m.Eb(2),m.oc("disabled",!e.data.isValid())("mat-dialog-close",e.data)}},directives:[l.h,l.e,n.v,n.o,n.p,D.c,D.g,v.a,n.t,n.n,n.q,c.l,w.b,k.d,n.c,k.f,D.i,k.c,n.r,Et.a,l.c,f.b,l.d,F.n],pipes:[a.d],encapsulation:2}),t})();var de=o("xHqg"),ue=o("MutI");function me(t,e){1&t&&(m.Fc(0),m.jc(1,"transloco")),2&t&&m.Gc(m.kc(1,1,"Header"))}function he(t,e){if(1&t&&(m.Wb(0,"mat-option",30),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.oc("value",t.targetUser),m.Eb(1),m.Gc(t.displayAs)}}function pe(t,e){if(1&t&&(m.Wb(0,"mat-option",30),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t){const t=e.$implicit;m.oc("value",t.value),m.Eb(1),m.Gc(m.kc(2,2,t.i18nterm))}}function fe(t,e){1&t&&(m.Fc(0),m.jc(1,"transloco")),2&t&&m.Gc(m.kc(1,1,"Dimension"))}function ge(t,e){if(1&t&&(m.Wb(0,"mat-list",31),m.Wb(1,"mat-list-item"),m.Fc(2),m.Vb(),m.Vb()),2&t){const t=e.$implicit;m.Eb(2),m.Gc(t.toString())}}function Ee(t,e){1&t&&(m.Fc(0),m.jc(1,"transloco")),2&t&&m.Gc(m.kc(1,1,"Award.ContinuousDays"))}function Ce(t,e){if(1&t&&(m.Wb(0,"mat-list",31),m.Wb(1,"mat-list-item"),m.Fc(2),m.Vb(),m.Vb()),2&t){const t=e.$implicit;m.Eb(2),m.Gc(t.toString())}}function We(t,e){1&t&&(m.Fc(0),m.jc(1,"transloco")),2&t&&m.Gc(m.kc(1,1,"Award.Point"))}function Ve(t,e){1&t&&(m.Wb(0,"span"),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Hc(" ",m.kc(2,1,"Dimension")," "))}function De(t,e){if(1&t&&(m.Wb(0,"span"),m.Fc(1),m.Vb()),2&t){const t=m.ic(2).$implicit,e=m.ic();m.Eb(1),m.Hc(" ",e.getColumnHeaderForDays(t)," ")}}function ve(t,e){if(1&t&&(m.Wb(0,"th",35),m.Ec(1,Ve,3,3,"span",36),m.Ec(2,De,2,1,"span",36),m.Vb()),2&t){const t=m.ic().$implicit;m.Eb(1),m.oc("ngIf","dimension"===t),m.Eb(1),m.oc("ngIf","dimension"!==t)}}function we(t,e){if(1&t&&(m.Wb(0,"span"),m.Fc(1),m.Vb()),2&t){const t=m.ic().$implicit;m.Eb(1),m.Hc(" ",t.dimInfo.toString()," ")}}function ke(t,e){if(1&t){const t=m.Xb();m.Wb(0,"span"),m.Wb(1,"input",38),m.ec("ngModelChange",function(e){m.xc(t);const o=m.ic().$implicit,c=m.ic().$implicit;return o.points[c]=e})("ngModelChange",function(e){return m.xc(t),m.ic(3).onPointCellChanged(e)}),m.Vb(),m.Vb()}if(2&t){const t=m.ic().$implicit,e=m.ic().$implicit;m.Eb(1),m.oc("ngModel",t.points[e])}}function Fe(t,e){if(1&t&&(m.Wb(0,"td",37),m.Ec(1,we,2,1,"span",36),m.Ec(2,ke,2,1,"span",36),m.Vb()),2&t){const t=m.ic().$implicit;m.Eb(1),m.oc("ngIf","dimension"===t),m.Eb(1),m.oc("ngIf","dimension"!==t)}}function ye(t,e){1&t&&(m.Ub(0,32),m.Ec(1,ve,3,2,"th",33),m.Ec(2,Fe,3,2,"td",34),m.Tb()),2&t&&m.oc("matColumnDef",e.$implicit)}function Ge(t,e){1&t&&m.Rb(0,"tr",39)}function Te(t,e){1&t&&m.Rb(0,"tr",40)}function Se(t,e){1&t&&(m.Fc(0),m.jc(1,"transloco")),2&t&&m.Gc(m.kc(1,1,"Common.Done"))}class Ue{constructor(){this.from=0,this.to=0,this.typeIsNumber=!0,this.cond=!1}toString(){return this.typeIsNumber?`[${this.from} - ${this.to})`:this.cond.toString()}}class Re{constructor(){this.from=0,this.to=0}toString(){return`[${this.from} - ${this.to})`}}class je{constructor(t){this.points={},this.isEdit=!1,this.dimInfo=t}}let xe=(()=>{class t{constructor(t,e,o){this._formBuilder=t,this.uiUtilSrv=e,this.odataSrv=o,this.arRuleTypes=[],this.dimensions=[],this.contDays=[],this.displayedColumns=["dimension"],this.dataSource=[],this.pointCompleted=!1,this.createdGroupID=-1,this.arRuleTypes=Object(u.J)(),this.firstFormGroup=this._formBuilder.group({targetuserCtrl:["",n.u.required],validFromCtrl:[void 0,n.u.required],validToCtrl:[void 0,n.u.required],ruleTypeCtrl:[u.h.GoToBedTime,n.u.required],despCtrl:["",n.u.required]}),this.secondFormGroup=this._formBuilder.group({rawCtrl:["",n.u.required]}),this.thirdFormGroup=this._formBuilder.group({rawCtrl:["",n.u.required]})}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}getUserDisplayAs(t){if(t&&this.odataSrv.currentUserDetail){const e=this.odataSrv.currentUserDetail.awardUsers.findIndex(e=>e.targetUser===t);if(-1!==e)return this.odataSrv.currentUserDetail.awardUsers[e].displayAs}return""}get isExpertMode(){return this.odataSrv.isLoggedin}ngOnInit(){var t,e,o,c;null===(t=this.firstFormGroup.get("validFromCtrl"))||void 0===t||t.setValue(d()()),null===(e=this.firstFormGroup.get("validToCtrl"))||void 0===e||e.setValue(d()().add(1,"month")),null===(o=this.secondFormGroup.get("rawCtrl"))||void 0===o||o.valueChanges.subscribe(t=>{this.onDimensionChange(t)}),null===(c=this.thirdFormGroup.get("rawCtrl"))||void 0===c||c.valueChanges.subscribe(t=>{this.onContDayChange(t)})}get selectedRuleType(){var t;const e=null===(t=this.firstFormGroup.get("ruleTypeCtrl"))||void 0===t?void 0:t.value;return void 0!==e?e:u.h.GoToBedTime}onInitialDimensions(){var t,e;switch(this.selectedRuleType){case u.h.HandWritingHabit:case u.h.CleanDeakHabit:case u.h.ErrorCollectionHabit:null===(t=this.secondFormGroup.get("rawCtrl"))||void 0===t||t.disable();break;default:null===(e=this.secondFormGroup.get("rawCtrl"))||void 0===e||e.enable()}}onDimensionCompleted(){switch(this.selectedRuleType){case u.h.HandWritingHabit:case u.h.CleanDeakHabit:case u.h.ErrorCollectionHabit:{const t=new Ue;t.typeIsNumber=!1,t.cond=!0,this.dimensions.push(t);const e=new Ue;e.typeIsNumber=!1,e.cond=!1,this.dimensions.push(e);break}}}onDimensionChange(t){switch(this.dimensions=[],this.selectedRuleType){case u.h.BodyExerciseCount:case u.h.HomeWorkCount:case u.h.HouseKeepingCount:case u.h.PoliteBehavior:if(t){let e=t.split(";").map(t=>{if(t){const e=+t;if(!isNaN(e)&&e>0)return Math.trunc(e)}return 0});e=e.filter(t=>t>0),e.sort();let o=0;e.forEach(t=>{if(0!==o){const e=new Ue;e.from=o,e.to=t,this.dimensions.push(e)}o=t});const c=new Ue;c.from=o,c.to=9999,this.dimensions.push(c)}break;case u.h.HandWritingHabit:case u.h.CleanDeakHabit:case u.h.ErrorCollectionHabit:break;case u.h.GoToBedTime:case u.h.SchoolWorkTime:default:if(t){let e=t.split(";").map(t=>{if(t){const e=+t;if(!isNaN(e)&&e<=23.99&&e>0)return e}return 0});e=e.filter(t=>t>0),e.sort();let o=0;e.forEach(t=>{const e=new Ue;e.from=o,e.to=t,this.dimensions.push(e),o=t});const c=new Ue;c.from=o,c.to=24,this.dimensions.push(c)}}}onContDayChange(t){if(this.contDays=[],t){let e=t.split(";").map(t=>{if(t){const e=+t;if(!isNaN(e)&&e>0)return Math.trunc(e)}return 0});e=e.filter(t=>t>0),e.sort();let o=0;e.forEach(t=>{if(0!==o){const e=new Re;e.from=o,e.to=t,this.contDays.push(e)}o=t});const c=new Re;c.from=o,c.to=9999,this.contDays.push(c)}}onInitialRules(){this.dataSource=[],this.displayedColumns=["dimension"];const t=[];for(let e=0;e<this.contDays.length;e++)t.push("days"+e);this.displayedColumns.push(...t),this.dimensions.forEach(e=>{const o=new je(e);t.forEach(t=>{o.points[t]=0}),this.dataSource.push(o)})}onPointCellChanged(t){let e=0;this.dataSource.forEach(t=>{Object.keys(t.points).forEach(o=>{(isNaN(t.points[o])||0===t.points[o])&&e++})}),this.pointCompleted=0===e}getColumnHeaderForDays(t){if(t&&t.startsWith("days")){const e=+t.replace("days","");return this.contDays[e].toString()}return""}onSave(){var t,e,o,c;const n=new u.g;switch(n.desp=null===(t=this.firstFormGroup.get("despCtrl"))||void 0===t?void 0:t.value,n.ruleType=this.selectedRuleType,n.targetUser=null===(e=this.firstFormGroup.get("targetuserCtrl"))||void 0===e?void 0:e.value,n.validFrom=null===(o=this.firstFormGroup.get("validFromCtrl"))||void 0===o?void 0:o.value,n.validTo=null===(c=this.firstFormGroup.get("validToCtrl"))||void 0===c?void 0:c.value,n.ruleType){case u.h.BodyExerciseCount:case u.h.HomeWorkCount:case u.h.HouseKeepingCount:case u.h.PoliteBehavior:this.dataSource.forEach(t=>{Object.keys(t.points).forEach(e=>{const o=new u.f;o.countOfFactLow=t.dimInfo.from,o.countOfFactHigh=t.dimInfo.to;const c=+e.replace("days","");o.daysFrom=this.contDays[c].from,this.contDays[c].to!==Number.POSITIVE_INFINITY&&(o.daysTo=this.contDays[c].to),o.point=t.points[e],n.rules.push(o)})});break;case u.h.HandWritingHabit:case u.h.CleanDeakHabit:case u.h.ErrorCollectionHabit:this.dataSource.forEach(t=>{Object.keys(t.points).forEach(e=>{const o=new u.f;o.doneOfFact=t.dimInfo.cond;const c=+e.replace("days","");o.daysFrom=this.contDays[c].from,o.daysTo=this.contDays[c].to,o.point=t.points[e],n.rules.push(o)})});break;case u.h.GoToBedTime:case u.h.SchoolWorkTime:default:this.dataSource.forEach(t=>{Object.keys(t.points).forEach(e=>{const o=new u.f;o.timeStart=t.dimInfo.from,o.timeEnd=t.dimInfo.to;const c=+e.replace("days","");o.daysFrom=this.contDays[c].from,o.daysTo=this.contDays[c].to,o.point=t.points[e],n.rules.push(o)})})}n.isValid()&&this.odataSrv.createAwardRuleGroup(n).subscribe({next:t=>{this.createdGroupID=t.id},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}openGroup(){this.uiUtilSrv.navigateAwardRuleGroupDisplayPage(this.createdGroupID)}}return t.\u0275fac=function(e){return new(e||t)(m.Qb(n.d),m.Qb(h.f),m.Qb(h.d))},t.\u0275cmp=m.Kb({type:t,selectors:[["app-award-rule-generation"]],decls:103,vars:73,consts:[[1,"toolbar-spacer"],["linear",""],["stepper",""],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],["appearance","fill",1,"control-full-width"],["required","","formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],[3,"rangePicker"],["matStartDate","","formControlName","validFromCtrl","placeholder","Start date"],["matEndDate","","formControlName","validToCtrl","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],["required","","formControlName","ruleTypeCtrl"],["matInput","","required","","formControlName","despCtrl"],["mat-button","","color","primary","matStepperNext","",3,"click"],["matInput","","formControlName","rawCtrl"],["dense","",4,"ngFor","ngForOf"],["mat-button","","matStepperPrevious",""],[3,"completed"],["mat-raised-button","","disabled",""],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","","color","primary","matStepperNext","",3,"disabled","click"],["mat-button","",3,"click"],["mat-button","","color","warn",3,"click"],[3,"value"],["dense",""],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],[4,"ngIf"],["mat-cell",""],["matInput","","type","number",3,"ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""]],template:function(t,e){if(1&t){const t=m.Xb();m.Wb(0,"mat-toolbar"),m.Wb(1,"h1"),m.Fc(2),m.jc(3,"transloco"),m.Vb(),m.Rb(4,"div",0),m.Vb(),m.Wb(5,"mat-vertical-stepper",1,2),m.Wb(7,"mat-step",3),m.Wb(8,"form",4),m.Ec(9,me,2,3,"ng-template",5),m.Wb(10,"mat-form-field",6),m.Wb(11,"mat-label"),m.Fc(12),m.jc(13,"transloco"),m.Vb(),m.Wb(14,"mat-select",7),m.Ec(15,he,2,2,"mat-option",8),m.Vb(),m.Vb(),m.Wb(16,"mat-form-field",9),m.Wb(17,"mat-label"),m.Fc(18),m.jc(19,"transloco"),m.Vb(),m.Wb(20,"mat-date-range-input",10),m.Rb(21,"input",11),m.Rb(22,"input",12),m.Vb(),m.Rb(23,"mat-datepicker-toggle",13),m.Rb(24,"mat-date-range-picker",null,14),m.Vb(),m.Wb(26,"mat-form-field",6),m.Wb(27,"mat-label"),m.Fc(28),m.jc(29,"transloco"),m.Vb(),m.Wb(30,"mat-select",15),m.Ec(31,pe,3,4,"mat-option",8),m.Vb(),m.Vb(),m.Wb(32,"mat-form-field",6),m.Wb(33,"mat-label"),m.Fc(34),m.jc(35,"transloco"),m.Vb(),m.Rb(36,"input",16),m.Vb(),m.Wb(37,"div"),m.Wb(38,"button",17),m.ec("click",function(){return e.onInitialDimensions()}),m.Fc(39),m.jc(40,"transloco"),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(41,"mat-step",3),m.Wb(42,"form",4),m.Ec(43,fe,2,3,"ng-template",5),m.Wb(44,"mat-form-field"),m.Wb(45,"mat-label"),m.Fc(46),m.jc(47,"transloco"),m.Vb(),m.Rb(48,"input",18),m.Vb(),m.Ec(49,ge,3,1,"mat-list",19),m.Wb(50,"div"),m.Wb(51,"button",20),m.Fc(52),m.jc(53,"transloco"),m.Vb(),m.Wb(54,"button",17),m.ec("click",function(){return e.onDimensionCompleted()}),m.Fc(55),m.jc(56,"transloco"),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(57,"mat-step",3),m.Wb(58,"form",4),m.Ec(59,Ee,2,3,"ng-template",5),m.Wb(60,"mat-form-field"),m.Wb(61,"mat-label"),m.Fc(62),m.jc(63,"transloco"),m.Vb(),m.Rb(64,"input",18),m.Vb(),m.Ec(65,Ce,3,1,"mat-list",19),m.Wb(66,"div"),m.Wb(67,"button",20),m.Fc(68),m.jc(69,"transloco"),m.Vb(),m.Wb(70,"button",17),m.ec("click",function(){return e.onInitialRules()}),m.Fc(71),m.jc(72,"transloco"),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(73,"mat-step",21),m.Ec(74,We,2,3,"ng-template",5),m.Wb(75,"mat-toolbar"),m.Wb(76,"button",22),m.Fc(77,"RESET RULES"),m.Vb(),m.Vb(),m.Wb(78,"table",23),m.Ec(79,ye,3,1,"ng-container",24),m.Ec(80,Ge,1,0,"tr",25),m.Ec(81,Te,1,0,"tr",26),m.Vb(),m.Wb(82,"button",20),m.Fc(83),m.jc(84,"transloco"),m.Vb(),m.Wb(85,"button",27),m.ec("click",function(){return e.onSave()}),m.Fc(86),m.jc(87,"transloco"),m.Vb(),m.Vb(),m.Wb(88,"mat-step"),m.Ec(89,Se,2,3,"ng-template",5),m.Wb(90,"p"),m.Fc(91),m.jc(92,"transloco"),m.Vb(),m.Wb(93,"p"),m.Fc(94),m.jc(95,"transloco"),m.Vb(),m.Wb(96,"div"),m.Wb(97,"button",28),m.ec("click",function(){return e.openGroup()}),m.Fc(98),m.jc(99,"transloco"),m.Vb(),m.Wb(100,"button",29),m.ec("click",function(){return m.xc(t),m.vc(6).reset()}),m.Fc(101),m.jc(102,"transloco"),m.Vb(),m.Vb(),m.Vb(),m.Vb()}if(2&t){const t=m.vc(25);m.Eb(2),m.Gc(m.kc(3,37,"Award.RuleGeneration")),m.Eb(5),m.oc("stepControl",e.firstFormGroup),m.Eb(1),m.oc("formGroup",e.firstFormGroup),m.Eb(4),m.Gc(m.kc(13,39,"Award.TargetUser")),m.Eb(3),m.oc("ngForOf",e.arTargetUsers),m.Eb(3),m.Gc(m.kc(19,41,"Award.Validity")),m.Eb(2),m.oc("rangePicker",t),m.Eb(3),m.oc("for",t),m.Eb(5),m.Gc(m.kc(29,43,"Type")),m.Eb(3),m.oc("ngForOf",e.arRuleTypes),m.Eb(3),m.Gc(m.kc(35,45,"Common.Description")),m.Eb(5),m.Gc(m.kc(40,47,"Common.Next")),m.Eb(2),m.oc("stepControl",e.secondFormGroup),m.Eb(1),m.oc("formGroup",e.secondFormGroup),m.Eb(4),m.Gc(m.kc(47,49,"Dimension")),m.Eb(3),m.oc("ngForOf",e.dimensions),m.Eb(3),m.Gc(m.kc(53,51,"Common.Previous")),m.Eb(3),m.Gc(m.kc(56,53,"Common.Next")),m.Eb(2),m.oc("stepControl",e.thirdFormGroup),m.Eb(1),m.oc("formGroup",e.thirdFormGroup),m.Eb(4),m.Gc(m.kc(63,55,"Award.ContinuousDays")),m.Eb(3),m.oc("ngForOf",e.contDays),m.Eb(3),m.Gc(m.kc(69,57,"Common.Previous")),m.Eb(3),m.Gc(m.kc(72,59,"Common.Next")),m.Eb(2),m.oc("completed",e.pointCompleted),m.Eb(5),m.oc("dataSource",e.dataSource),m.Eb(1),m.oc("ngForOf",e.displayedColumns),m.Eb(1),m.oc("matHeaderRowDef",e.displayedColumns),m.Eb(1),m.oc("matRowDefColumns",e.displayedColumns),m.Eb(2),m.Gc(m.kc(84,61,"Common.Previous")),m.Eb(2),m.oc("disabled",!e.pointCompleted),m.Eb(1),m.Gc(m.kc(87,63,"Common.Next")),m.Eb(5),m.Ic("",m.kc(92,65,"AwardRuleGroupCreatedInfo1"),", ID: ",e.createdGroupID," "),m.Eb(3),m.Gc(m.kc(95,67,"AwardRuleGroupCreatedInfo2")),m.Eb(4),m.Gc(m.kc(99,69,"Common.Display")),m.Eb(3),m.Gc(m.kc(102,71,"Common.CreateAnotherOne"))}},directives:[p.a,de.g,de.b,n.v,n.o,n.h,de.c,D.c,D.g,v.a,n.t,n.n,n.f,c.l,k.a,k.h,n.c,k.g,k.f,D.i,k.b,w.b,f.b,de.e,de.f,C.j,C.g,C.i,F.n,ue.a,ue.b,C.c,C.e,C.b,C.d,c.m,C.a,n.r,n.q,C.f,C.h],pipes:[a.d],styles:[".mat-form-field[_ngcontent-%COMP%], .mat-table[_ngcontent-%COMP%]{margin-left:8px}.mat-table[_ngcontent-%COMP%]{width:90%;min-height:500px}"]}),t})();var Me=o("jtHE"),Ae=o("Wp6s"),Pe=o("7EHt");function Ie(t,e){if(1&t&&(m.Wb(0,"mat-option",28),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.oc("value",t.targetUser),m.Eb(1),m.Gc(t.displayAs)}}function Oe(t,e){if(1&t&&(m.Wb(0,"mat-option",28),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t){const t=e.$implicit;m.oc("value",t.value),m.Eb(1),m.Gc(m.kc(2,2,t.i18nterm))}}function $e(t,e){1&t&&(m.Wb(0,"th",29),m.Fc(1,"#"),m.Vb())}function He(t,e){if(1&t&&(m.Wb(0,"td",30),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.id)}}function Ne(t,e){1&t&&(m.Wb(0,"th",29),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.CountRange")))}function _e(t,e){if(1&t&&(m.Wb(0,"td",30),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.countString)}}function Be(t,e){1&t&&(m.Wb(0,"th",29),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Common.Done")))}function qe(t,e){if(1&t&&(m.Wb(0,"td",30),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.doneString)}}function Qe(t,e){1&t&&(m.Wb(0,"th",29),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.TimeRange")))}function Le(t,e){if(1&t&&(m.Wb(0,"td",30),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.timeString)}}function ze(t,e){1&t&&(m.Wb(0,"th",29),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.ContinuousDays")))}function Ke(t,e){if(1&t&&(m.Wb(0,"td",30),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.dayString)}}function Xe(t,e){1&t&&(m.Wb(0,"th",29),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Award.Point")))}function Je(t,e){if(1&t&&(m.Wb(0,"td",30),m.Fc(1),m.Vb()),2&t){const t=e.$implicit;m.Eb(1),m.Gc(t.point)}}function Ye(t,e){1&t&&m.Rb(0,"tr",31)}function Ze(t,e){1&t&&m.Rb(0,"tr",32)}const to=[{path:"",component:ot},{path:"rules",component:gt},{path:"rule-group-display/:id",component:(()=>{class t{constructor(t,e,o,c){this.activateRoute=t,this.uiUtilSrv=e,this.odataSrv=o,this.formBuilder=c,this.routerID=-1,this.arRuleTypes=[],this.dataSource=[],this.displayedColumns=[],this.arRuleTypes=Object(u.J)(),this.headerFormGroup=this.formBuilder.group({targetuserCtrl:["",n.u.required],validFromCtrl:[void 0,n.u.required],validToCtrl:[void 0,n.u.required],ruleTypeCtrl:[u.h.GoToBedTime,n.u.required],despCtrl:["",n.u.required]})}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}getUserDisplayAs(t){if(t&&this.odataSrv.currentUserDetail){const e=this.odataSrv.currentUserDetail.awardUsers.findIndex(e=>e.targetUser===t);if(-1!==e)return this.odataSrv.currentUserDetail.awardUsers[e].displayAs}return""}get isExpertMode(){return this.odataSrv.isLoggedin}ngOnInit(){this.destroyed$=new Me.a(1),this.activateRoute.url.subscribe({next:t=>{t instanceof Array&&t.length>0&&"rule-group-display"===t[0].path&&(this.routerID=+t[1].path),-1!==this.routerID&&this.odataSrv.readAwardRuleGroup(this.routerID).subscribe({next:t=>{var e,o,c,n,a;switch(null===(e=this.headerFormGroup.get("targetuserCtrl"))||void 0===e||e.setValue(t.targetUser),null===(o=this.headerFormGroup.get("despCtrl"))||void 0===o||o.setValue(t.desp),null===(c=this.headerFormGroup.get("validFromCtrl"))||void 0===c||c.setValue(t.validFrom),null===(n=this.headerFormGroup.get("validToCtrl"))||void 0===n||n.setValue(t.validTo),null===(a=this.headerFormGroup.get("ruleTypeCtrl"))||void 0===a||a.setValue(t.ruleType),this.headerFormGroup.disable(),t.ruleType){case u.h.BodyExerciseCount:case u.h.HomeWorkCount:case u.h.HouseKeepingCount:case u.h.PoliteBehavior:this.displayedColumns=["id","count","days","point"];break;case u.h.HandWritingHabit:case u.h.CleanDeakHabit:case u.h.ErrorCollectionHabit:this.displayedColumns=["id","done","days","point"];break;case u.h.GoToBedTime:case u.h.SchoolWorkTime:default:this.displayedColumns=["id","time","days","point"]}this.dataSource=t.rules.slice()},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}ngOnDestroy(){this.destroyed$&&(this.destroyed$.complete(),this.destroyed$=void 0)}onReturnToList(){this.uiUtilSrv.navigateAwardRuleGroupListPage()}onCreateNewOne(){this.uiUtilSrv.navigateAwardRuleGenerationPage()}}return t.\u0275fac=function(e){return new(e||t)(m.Qb(s.a),m.Qb(h.f),m.Qb(h.d),m.Qb(n.d))},t.\u0275cmp=m.Kb({type:t,selectors:[["app-award-rule-display"]],decls:80,vars:38,consts:[["multi","",1,"example-headers-align"],["expanded",""],[3,"formGroup"],["appearance","fill",1,"control-full-width"],["required","","formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],[3,"rangePicker"],["matStartDate","","formControlName","validFromCtrl","placeholder","Start date"],["matEndDate","","formControlName","validToCtrl","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],["required","","formControlName","ruleTypeCtrl"],["matInput","","required","","formControlName","despCtrl"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","count"],["matColumnDef","done"],["matColumnDef","time"],["matColumnDef","days"],["matColumnDef","point"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","",3,"click"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){if(1&t&&(m.Wb(0,"mat-card"),m.Wb(1,"mat-card-header"),m.Wb(2,"mat-card-title"),m.Fc(3),m.jc(4,"transloco"),m.Vb(),m.Vb(),m.Wb(5,"mat-card-content"),m.Wb(6,"mat-accordion",0),m.Wb(7,"mat-expansion-panel",1),m.Wb(8,"mat-expansion-panel-header"),m.Wb(9,"mat-panel-title"),m.Fc(10),m.jc(11,"transloco"),m.Vb(),m.Wb(12,"mat-panel-description"),m.Fc(13),m.jc(14,"transloco"),m.Wb(15,"mat-icon"),m.Fc(16,"public"),m.Vb(),m.Vb(),m.Vb(),m.Wb(17,"form",2),m.Wb(18,"mat-form-field",3),m.Wb(19,"mat-label"),m.Fc(20),m.jc(21,"transloco"),m.Vb(),m.Wb(22,"mat-select",4),m.Ec(23,Ie,2,2,"mat-option",5),m.Vb(),m.Vb(),m.Wb(24,"mat-form-field",6),m.Wb(25,"mat-label"),m.Fc(26),m.jc(27,"transloco"),m.Vb(),m.Wb(28,"mat-date-range-input",7),m.Rb(29,"input",8),m.Rb(30,"input",9),m.Vb(),m.Rb(31,"mat-datepicker-toggle",10),m.Rb(32,"mat-date-range-picker",null,11),m.Vb(),m.Wb(34,"mat-form-field",3),m.Wb(35,"mat-label"),m.Fc(36),m.jc(37,"transloco"),m.Vb(),m.Wb(38,"mat-select",12),m.Ec(39,Oe,3,4,"mat-option",5),m.Vb(),m.Vb(),m.Wb(40,"mat-form-field",3),m.Wb(41,"mat-label"),m.Fc(42),m.jc(43,"transloco"),m.Vb(),m.Rb(44,"input",13),m.Vb(),m.Vb(),m.Vb(),m.Wb(45,"mat-expansion-panel"),m.Wb(46,"mat-expansion-panel-header"),m.Wb(47,"mat-panel-title"),m.Fc(48),m.jc(49,"transloco"),m.Vb(),m.Vb(),m.Wb(50,"div",14),m.Wb(51,"div",15),m.Wb(52,"table",16),m.Ub(53,17),m.Ec(54,$e,2,0,"th",18),m.Ec(55,He,2,1,"td",19),m.Tb(),m.Ub(56,20),m.Ec(57,Ne,3,3,"th",18),m.Ec(58,_e,2,1,"td",19),m.Tb(),m.Ub(59,21),m.Ec(60,Be,3,3,"th",18),m.Ec(61,qe,2,1,"td",19),m.Tb(),m.Ub(62,22),m.Ec(63,Qe,3,3,"th",18),m.Ec(64,Le,2,1,"td",19),m.Tb(),m.Ub(65,23),m.Ec(66,ze,3,3,"th",18),m.Ec(67,Ke,2,1,"td",19),m.Tb(),m.Ub(68,24),m.Ec(69,Xe,3,3,"th",18),m.Ec(70,Je,2,1,"td",19),m.Tb(),m.Ec(71,Ye,1,0,"tr",25),m.Ec(72,Ze,1,0,"tr",26),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(73,"mat-card-actions"),m.Wb(74,"button",27),m.ec("click",function(){return e.onReturnToList()}),m.Fc(75),m.jc(76,"transloco"),m.Vb(),m.Wb(77,"button",27),m.ec("click",function(){return e.onCreateNewOne()}),m.Fc(78),m.jc(79,"transloco"),m.Vb(),m.Vb(),m.Vb()),2&t){const t=m.vc(33);m.Eb(3),m.Gc(m.kc(4,18,"Award.Rules")),m.Eb(7),m.Gc(m.kc(11,20,"Header")),m.Eb(3),m.Gc(m.kc(14,22,"HeaderInfo")),m.Eb(4),m.oc("formGroup",e.headerFormGroup),m.Eb(3),m.Gc(m.kc(21,24,"Award.TargetUser")),m.Eb(3),m.oc("ngForOf",e.arTargetUsers),m.Eb(3),m.Gc(m.kc(27,26,"Award.Validity")),m.Eb(2),m.oc("rangePicker",t),m.Eb(3),m.oc("for",t),m.Eb(5),m.Gc(m.kc(37,28,"Type")),m.Eb(3),m.oc("ngForOf",e.arRuleTypes),m.Eb(3),m.Gc(m.kc(43,30,"Common.Description")),m.Eb(6),m.Gc(m.kc(49,32,"Award.Rules")),m.Eb(4),m.oc("dataSource",e.dataSource),m.Eb(19),m.oc("matHeaderRowDef",e.displayedColumns),m.Eb(1),m.oc("matRowDefColumns",e.displayedColumns),m.Eb(3),m.Gc(m.kc(76,34,"Common.ReturnToList")),m.Eb(3),m.Gc(m.kc(79,36,"Common.CreateAnotherOne"))}},directives:[Ae.a,Ae.d,Ae.g,Ae.c,Pe.a,Pe.c,Pe.e,Pe.f,Pe.d,E.a,n.v,n.o,n.h,D.c,D.g,v.a,n.t,n.n,n.f,c.l,k.a,k.h,n.c,k.g,k.f,D.i,k.b,w.b,C.j,C.c,C.e,C.b,C.g,C.i,Ae.b,f.b,F.n,C.d,C.a,C.f,C.h],pipes:[a.d],styles:[".example-headers-align[_ngcontent-%COMP%]{margin:8px}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%], .example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%]{flex-basis:0}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{justify-content:space-between;align-items:center}.example-headers-align[_ngcontent-%COMP%]   .mat-select[_ngcontent-%COMP%]{margin-left:8px}.example-headers-align[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%] + .mat-form-field[_ngcontent-%COMP%]{margin-left:8px}table[_ngcontent-%COMP%]{width:100%}"]}),t})()},{path:"rule-generation",component:xe},{path:"dailytrace",component:le}];let eo=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.Ob({type:t}),t.\u0275inj=m.Nb({imports:[[s.e.forChild(to)],s.e]}),t})(),oo=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.Ob({type:t}),t.\u0275inj=m.Nb({imports:[[c.c,n.i,n.s,i.a,a.c,r.a,eo]]}),t})()}}]);