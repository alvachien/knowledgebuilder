"use strict";(self.webpackChunkknowledgebuilder=self.webpackChunkknowledgebuilder||[]).push([[82],{4082:(Y,g,n)=>{n.r(g),n.d(g,{PreviewModule:()=>a});var h=n(6895),p=n(4006),v=n(1525),b=n(6127),w=n(9132),u=n(2701),x=n(8242),e=n(4650),f=n(410),T=n(4217),S=n(3238),Z=n(6338);class d{constructor(i,t,s,r){this._bottomSheetRef=i,this.odataSrv=t,this.authService=s,this.data=r}createNewScore(i,t){t.preventDefault();const s=new u.oh;s.RefID=this.data.excitemid,s.Score=i,this.authService.getUserData().subscribe(r=>{s.User=r.sub,this.odataSrv.createExerciseItemUserScore(s).subscribe({next:c=>{this.data.resultFlag=!0,this.data.newScore=c,this._bottomSheetRef.dismiss(this.data)},error:c=>{this.data.resultFlag=!1,this.data.newScore=null,this.data.errorInfo=c,this._bottomSheetRef.dismiss(this.data)}})})}}d.\u0275fac=function(i){return new(i||d)(e.Y36(x.oL),e.Y36(f.CB),e.Y36(T.J_),e.Y36(x.OG))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-preview-newscore-sheet"]],decls:19,vars:9,consts:[["mat-list-item","",3,"click"],["mat-line",""]],template:function(i,t){1&i&&(e.TgZ(0,"mat-nav-list")(1,"a",0),e.NdJ("click",function(r){return t.createNewScore(0,r)}),e.TgZ(2,"span",1),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"span",1),e._uU(6,"Add a new score of 0"),e.qZA()(),e.TgZ(7,"a",0),e.NdJ("click",function(r){return t.createNewScore(60,r)}),e.TgZ(8,"span",1),e._uU(9),e.ALo(10,"transloco"),e.qZA(),e.TgZ(11,"span",1),e._uU(12,"Add a new score of 60"),e.qZA()(),e.TgZ(13,"a",0),e.NdJ("click",function(r){return t.createNewScore(100,r)}),e.TgZ(14,"span",1),e._uU(15),e.ALo(16,"transloco"),e.qZA(),e.TgZ(17,"span",1),e._uU(18,"Add a new score of 100"),e.qZA()()()),2&i&&(e.xp6(3),e.hij("",e.lcZ(4,3,"NewPractice"),": 0"),e.xp6(6),e.hij("",e.lcZ(10,5,"NewPractice"),": 60"),e.xp6(6),e.hij("",e.lcZ(16,7,"NewPractice"),": 100"))},dependencies:[S.X2,Z.Hk,Z.Tg,v.Ot],encapsulation:2});var A=n(2289),I=n(4859),U=n(6709),O=n(4850),C=n(9549),_=n(7314),M=n(266),P=n(5471);function N(o,i){if(1&o&&(e.TgZ(0,"div",3)(1,"h3"),e._uU(2),e.qZA(),e._UZ(3,"mat-divider"),e.TgZ(4,"h3"),e._uU(5),e.ALo(6,"transloco"),e.qZA(),e._UZ(7,"mat-divider"),e.TgZ(8,"div",4),e._UZ(9,"markdown",5),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.hij("ID: ",t.selectedKnowledge.ID,""),e.xp6(3),e.AsE("",e.lcZ(6,5,"Title"),": ",t.selectedKnowledge.Title,""),e.xp6(4),e.Q6J("data",t.selectedKnowledge.Content)("katexOptions",t.mathOptions)}}function y(o,i){1&o&&(e.TgZ(0,"mat-label",16),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"FontSize")))}function E(o,i){if(1&o&&(e.TgZ(0,"mat-label")(1,"span"),e._uU(2),e.qZA(),e._uU(3),e.ALo(4,"date"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Tol(t.isSuccessScore?"success-score":"fail-score"),e.xp6(1),e.Oqu(t.selectedExerciseUserScore.Score),e.xp6(1),e.hij(" (",e.xi3(4,4,t.selectedExerciseUserScore.TakenDate,"yyyy-M-d"),")")}}function J(o,i){if(1&o&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij("ID: ",t.selectedExercise.ID,"")}}function j(o,i){if(1&o&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"transloco"),e.ALo(3,"transloco"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.AsE("",e.lcZ(2,2,"Type"),": ",e.lcZ(3,4,t.getExerciseItemTypeName(t.selectedExercise.ItemType)),"")}}function L(o,i){if(1&o&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.AsE("",e.lcZ(2,2,"Tags"),": ",t.selectedExercise.Tags.toString(),"")}}function Q(o,i){1&o&&e._UZ(0,"mat-divider")}function k(o,i){if(1&o&&(e.TgZ(0,"div",14),e._UZ(1,"mat-divider"),e.TgZ(2,"h3"),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e._UZ(5,"markdown",5),e.qZA()),2&o){const t=e.oxw(2);e.Udp("font-size",t.fontSize,"px"),e.xp6(3),e.Oqu(e.lcZ(4,5,"Answer")),e.xp6(2),e.Q6J("data",t.selectedExercise.Answer)("katexOptions",t.mathOptions)}}function q(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",6)(2,"mat-checkbox",7),e.NdJ("ngModelChange",function(r){e.CHM(t);const c=e.oxw();return e.KtG(c.focusMode=r)}),e.ALo(3,"transloco"),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.TgZ(6,"mat-checkbox",8),e.NdJ("ngModelChange",function(r){e.CHM(t);const c=e.oxw();return e.KtG(c.hideAnswer=r)}),e.ALo(7,"transloco"),e._uU(8),e.ALo(9,"transloco"),e.qZA(),e.YNc(10,y,3,3,"mat-label",9),e.TgZ(11,"mat-slider",10),e.NdJ("ngModelChange",function(r){e.CHM(t);const c=e.oxw();return e.KtG(c.fontSize=r)}),e.ALo(12,"transloco"),e._UZ(13,"input",11),e.qZA()(),e.TgZ(14,"div",6),e.YNc(15,E,5,7,"mat-label",12),e.TgZ(16,"button",13),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onNewScore())}),e._uU(17),e.ALo(18,"transloco"),e.qZA()(),e._UZ(19,"mat-divider"),e.YNc(20,J,2,1,"h3",12),e.YNc(21,j,4,6,"h3",12),e.YNc(22,L,3,4,"h3",12),e.YNc(23,Q,1,0,"mat-divider",12),e.TgZ(24,"div",14)(25,"h3"),e._uU(26),e.ALo(27,"transloco"),e.qZA(),e._UZ(28,"markdown",5),e.qZA(),e.YNc(29,k,6,7,"div",15),e.qZA()}if(2&o){const t=e.oxw();e.xp6(2),e.s9C("matTooltip",e.lcZ(3,21,"FocusMode")),e.Q6J("ngModel",t.focusMode),e.xp6(2),e.Oqu(e.lcZ(5,23,"FocusMode")),e.xp6(2),e.s9C("matTooltip",e.lcZ(7,25,"QuizMode")),e.Q6J("ngModel",t.hideAnswer),e.xp6(2),e.Oqu(e.lcZ(9,27,"QuizMode")),e.xp6(2),e.Q6J("ngIf",!t.mobileQuery.matches),e.xp6(1),e.s9C("matTooltip",e.lcZ(12,29,"FontSize")),e.Q6J("ngModel",t.fontSize),e.xp6(4),e.Q6J("ngIf",t.selectedExerciseUserScore),e.xp6(2),e.Oqu(e.lcZ(18,31,"NewPractice")),e.xp6(3),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Udp("font-size",t.fontSize,"px"),e.xp6(2),e.Oqu(e.lcZ(27,33,"Content")),e.xp6(2),e.Q6J("data",t.selectedExercise.Content)("katexOptions",t.mathOptions),e.xp6(1),e.Q6J("ngIf",!t.hideAnswer)}}class m{constructor(i,t,s,r,c){this.odataSvc=i,this._bottomSheet=r,this.uiUtilSrv=c,this.selectedExerciseUserScore=null,this.listPreviewObjects=[],this.mathOptions={displayMode:!0,throwOnError:!1,errorColor:"#cc0000"},this.focusMode=!1,this.hideAnswer=!1,this.fontSize=20,this.mobileQuery=s.matchMedia("(max-width: 600px)"),this._mobileQueryListener=()=>t.detectChanges(),this.previewIdx=-1}getExerciseItemTypeName(i){return(0,u.of)(i)}get isSuccessScore(){return null!==this.selectedExerciseUserScore&&this.selectedExerciseUserScore.Score>=60}ngOnInit(){this.mobileQuery.addEventListener("change",this._mobileQueryListener),this.listPreviewObjects=this.uiUtilSrv.previewObjList.slice(),this.uiUtilSrv.previewObjList=[],this.listPreviewObjects.length>0&&(this.previewIdx=-1,this.onNextPreviewItem())}ngOnDestroy(){this.mobileQuery.removeEventListener("change",this._mobileQueryListener)}onPreviousPreviewItem(){this.previewIdx>0&&(this.previewIdx--,this.selectedObj=this.listPreviewObjects[this.previewIdx],this.fetchPreviewItem())}onNextPreviewItem(){this.previewIdx<this.listPreviewObjects.length&&(this.previewIdx++,this.selectedObj=this.listPreviewObjects[this.previewIdx],this.fetchPreviewItem())}get isNextPreviewButtonEnabled(){return this.previewIdx<this.listPreviewObjects.length-1}get isPreviousButtonEnabled(){return this.previewIdx>0}fetchPreviewItem(){this.previewIdx>-1&&this.previewIdx<this.listPreviewObjects.length&&(this.selectedObj?.refType===u.ik.KnowledgeItem?this.odataSvc.readKnowledgeItem(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:i=>{this.selectedKnowledge=i},error:i=>{this.uiUtilSrv.showSnackInfo(i)}}):this.selectedObj?.refType===u.ik.ExerciseItem&&(this.odataSvc.readExerciseItem(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:i=>{this.selectedExercise=i},error:i=>{this.uiUtilSrv.showSnackInfo(i)}}),this.odataSvc.getLastestExerciseItemUserScore(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:i=>{this.selectedExerciseUserScore=i},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})))}onNewScore(){this._bottomSheet.open(d,{data:{excitemid:this.selectedExercise?.ID}}).afterDismissed().subscribe(t=>{t.resultFlag?t.newScore&&(this.selectedExerciseUserScore=t.newScore):this.uiUtilSrv.showSnackInfo(t.errorInfo)})}}m.\u0275fac=function(i){return new(i||m)(e.Y36(f.CB),e.Y36(e.sBO),e.Y36(A.vx),e.Y36(x.ch),e.Y36(f.dM))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-preview"]],decls:22,vars:22,consts:[[1,"button-row"],["mat-raised-button","",3,"disabled","click"],["class","mat-typography","style","margin: 8px;",4,"ngIf"],[1,"mat-typography",2,"margin","8px"],[1,"control-full-width",2,"margin-top","16px","font-size","large"],["katex","",3,"data","katexOptions"],[1,"button-row",2,"margin","8px"],["color","primary","name","focusmode",2,"margin-left","4px",3,"ngModel","matTooltip","ngModelChange"],["color","primary","name","quizmode",2,"margin-left","4px",3,"ngModel","matTooltip","ngModelChange"],["style","margin-left: 4px;",4,"ngIf"],["thumbLabel","","step","2","min","10","max","40",3,"ngModel","matTooltip","ngModelChange"],["matSliderThumb",""],[4,"ngIf"],["mat-raised-button","",3,"click"],[1,"control-full-width",2,"margin-top","16px"],["class","control-full-width","style","margin-top: 16px;",3,"font-size",4,"ngIf"],[2,"margin-left","4px"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return t.onPreviousPreviewItem()}),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.TgZ(6,"button",1),e.NdJ("click",function(){return t.onNextPreviewItem()}),e._uU(7),e.ALo(8,"transloco"),e.qZA()(),e._UZ(9,"mat-divider"),e.YNc(10,N,10,7,"div",2),e.YNc(11,q,30,35,"div",2),e._UZ(12,"mat-divider"),e.TgZ(13,"div",0)(14,"div"),e._uU(15),e.qZA(),e.TgZ(16,"button",1),e.NdJ("click",function(){return t.onPreviousPreviewItem()}),e._uU(17),e.ALo(18,"transloco"),e.qZA(),e.TgZ(19,"button",1),e.NdJ("click",function(){return t.onNextPreviewItem()}),e._uU(20),e.ALo(21,"transloco"),e.qZA()()),2&i&&(e.xp6(2),e.AsE(" ",t.previewIdx+1," / ",t.listPreviewObjects.length,""),e.xp6(1),e.Q6J("disabled",!t.isPreviousButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(5,14,"Common.Previous")),e.xp6(2),e.Q6J("disabled",!t.isNextPreviewButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(8,16,"Common.Next")),e.xp6(3),e.Q6J("ngIf",t.selectedObj&&1===t.selectedObj.refType&&t.selectedKnowledge),e.xp6(1),e.Q6J("ngIf",t.selectedObj&&2===t.selectedObj.refType&&t.selectedExercise),e.xp6(4),e.AsE(" ",t.previewIdx+1," / ",t.listPreviewObjects.length,""),e.xp6(1),e.Q6J("disabled",!t.isPreviousButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(18,18,"Common.Previous")),e.xp6(2),e.Q6J("disabled",!t.isNextPreviewButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(21,20,"Common.Next")))},dependencies:[h.O5,p.JJ,p.On,I.lW,U.oG,O.d,C.hX,_.pH,_.$5,M.gM,P.lF,h.uU,v.Ot],styles:[".button-row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.button-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:16px}.input-fontsize[_ngcontent-%COMP%]{margin-left:24px;width:100px}mat-slide-toggle[_ngcontent-%COMP%]{width:80px}mat-slider[_ngcontent-%COMP%]{margin-left:8px;width:80px}.success-score[_ngcontent-%COMP%]{color:green;font-size:16px}.fail-score[_ngcontent-%COMP%]{color:red;font-size:16px}"]});const z=[{path:"",component:m}];class l{}l.\u0275fac=function(i){return new(i||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[w.Bz.forChild(z),w.Bz]});class a{}a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[h.ez,p.u5,p.UX,v.y4,b.U,P.JP,l]})}}]);