"use strict";(self.webpackChunkknowledgebuilder=self.webpackChunkknowledgebuilder||[]).push([[907],{3907:($e,K,l)=>{l.r(K),l.d(K,{KnowledgeItemsModule:()=>Qe});var h=l(9808),m=l(3075),U=l(107),O=l(9354),Z=l(7455),E=l(7607),H=l(5146),x=l(4521),e=l(5e3),T=l(6087),I=l(4847),N=l(6451),M=l(9646),D=l(8675),J=l(3900),F=l(4004),L=l(262),d=l(9144),f=l(3984),v=l(4594),w=l(7423),G=l(7238),y=l(5245),c=l(8279);function R(n,a){1&n&&(e.TgZ(0,"th",17),e._uU(1,"#"),e.qZA())}function j(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"td",18),e.TgZ(1,"div"),e._uU(2),e.TgZ(3,"button",19),e.ALo(4,"transloco"),e.TgZ(5,"mat-icon"),e._uU(6,"launch"),e.qZA(),e.qZA(),e.TgZ(7,"button",20),e.ALo(8,"transloco"),e.TgZ(9,"mat-icon"),e._uU(10,"edit"),e.qZA(),e.qZA(),e.TgZ(11,"button",21),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().onDeleteItem(r.ID)}),e.ALo(12,"transloco"),e.TgZ(13,"mat-icon"),e._uU(14,"remove_circle"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=a.$implicit,o=e.oxw();e.xp6(2),e.hij(" ",t.ID," "),e.xp6(1),e.MGl("routerLink","display/",t.ID,""),e.s9C("matTooltip",e.lcZ(4,9,"Common.Display")),e.Q6J("disabled",!o.isExpertMode),e.xp6(4),e.MGl("routerLink","edit/",t.ID,""),e.s9C("matTooltip",e.lcZ(8,11,"Common.Change")),e.Q6J("disabled",!o.isExpertMode),e.xp6(4),e.s9C("matTooltip",e.lcZ(12,13,"Common.Delete")),e.Q6J("disabled",!o.isExpertMode)}}function B(n,a){1&n&&(e.TgZ(0,"th",17),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Category")))}function z(n,a){if(1&n&&(e.TgZ(0,"td",18),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n){const t=a.$implicit,o=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,o.getKnowledgeItemCategoryName(t.ItemCategory)))}}function V(n,a){1&n&&(e.TgZ(0,"th",17),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Title")))}function W(n,a){if(1&n&&(e.TgZ(0,"td",18),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu(t.Title)}}function X(n,a){1&n&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"CreatedAt")))}function ee(n,a){if(1&n&&(e.TgZ(0,"td",18),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,t.CreatedAt,"yyyy-M-d HH:mm:ss"))}}function te(n,a){1&n&&e._UZ(0,"tr",23)}function oe(n,a){1&n&&e._UZ(0,"tr",24)}let ne=(()=>{class n{constructor(t,o){this.odataService=t,this.uiUtilSrv=o,this.displayedColumns=["id","category","title","createdat"],this.dataSource=[],this.resultsLength=0,this.isLoadingResults=!0,this.refreshEvent=new e.vpe}getKnowledgeItemCategoryName(t){return(0,d._h)(t)}get isExpertMode(){return this.odataService.isLoggedin}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,N.T)(this.sort.sortChange,this.paginator.page,this.refreshEvent).pipe((0,D.O)({}),(0,J.w)(()=>{this.isLoadingResults=!0;const t=this.paginator.pageSize;return this.odataService.getKnowledgeItems(t,t*this.paginator.pageIndex,this.sort.active,this.sort.direction)}),(0,F.U)(t=>(this.isLoadingResults=!1,this.resultsLength=t.totalCount,t.items)),(0,L.K)(()=>(this.isLoadingResults=!1,(0,M.of)([])))).subscribe(t=>this.dataSource=t)}onGoToPreview(){const t=[];this.dataSource.forEach(o=>{t.push({refType:d.ik.KnowledgeItem,refId:o.ID})}),this.uiUtilSrv.navigatePreviewPage(t)}onGoToSearch(){this.uiUtilSrv.navigateKnowledgeItemSearchPage()}onDeleteItem(t){this.odataService.deleteExerciseItem(t).subscribe({next:o=>{this.onRefreshList()},error:o=>{this.uiUtilSrv.showSnackInfo(o)}})}onRefreshList(){this.refreshEvent.emit()}resetPaging(){this.paginator.pageIndex=0}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.CB),e.Y36(f.dM))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-knowledge-items"]],viewQuery:function(t,o){if(1&t&&(e.Gf(T.NW,5),e.Gf(I.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(o.paginator=i.first),e.iGM(i=e.CRH())&&(o.sort=i.first)}},decls:40,vars:21,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary","routerLink","create",3,"disabled","matTooltip"],["mat-icon-button","","color","accent","matTooltip","'Common.Search' | transloco}}",3,"disabled","click"],["mat-icon-button","","color","accent",3,"disabled","matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"example-table-container"],["mat-table","","matSort","",1,"example-table",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","category"],["matColumnDef","title"],["matColumnDef","createdat"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"disabled","routerLink","matTooltip"],["mat-icon-button","","color","accent",3,"disabled","routerLink","matTooltip"],["mat-icon-button","","color","warn",3,"disabled","matTooltip","click"],["mat-header-cell","","mat-sort-header",""],["mat-header-row",""],["mat-row",""]],template:function(t,o){1&t&&(e.TgZ(0,"mat-toolbar-row"),e.TgZ(1,"span"),e.TgZ(2,"h1"),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.qZA(),e._UZ(5,"span",0),e.TgZ(6,"section"),e.TgZ(7,"button",1),e.ALo(8,"transloco"),e.TgZ(9,"mat-icon"),e._uU(10,"add_circle"),e.qZA(),e.qZA(),e.TgZ(11,"button",2),e.NdJ("click",function(){return o.onGoToSearch()}),e.TgZ(12,"mat-icon"),e._uU(13,"search"),e.qZA(),e.qZA(),e.TgZ(14,"button",3),e.NdJ("click",function(){return o.onGoToPreview()}),e.ALo(15,"transloco"),e.TgZ(16,"mat-icon"),e._uU(17,"slideshow"),e.qZA(),e.qZA(),e.TgZ(18,"button",3),e.NdJ("click",function(){return o.onRefreshList()}),e.ALo(19,"transloco"),e.TgZ(20,"mat-icon"),e._uU(21,"refresh"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(22,"div",4),e.TgZ(23,"div",5),e.TgZ(24,"table",6),e.NdJ("matSortChange",function(){return o.resetPaging()}),e.ynx(25,7),e.YNc(26,R,2,0,"th",8),e.YNc(27,j,15,15,"td",9),e.BQk(),e.ynx(28,10),e.YNc(29,B,3,3,"th",8),e.YNc(30,z,3,3,"td",9),e.BQk(),e.ynx(31,11),e.YNc(32,V,3,3,"th",8),e.YNc(33,W,2,1,"td",9),e.BQk(),e.ynx(34,12),e.YNc(35,X,3,3,"th",13),e.YNc(36,ee,3,4,"td",9),e.BQk(),e.YNc(37,te,1,0,"tr",14),e.YNc(38,oe,1,0,"tr",15),e.qZA(),e.qZA(),e._UZ(39,"mat-paginator",16),e.qZA()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,13,"KnowledgeItem")),e.xp6(4),e.s9C("matTooltip",e.lcZ(8,15,"Common.Create")),e.Q6J("disabled",!o.isExpertMode),e.xp6(4),e.Q6J("disabled",!o.isExpertMode||o.dataSource.length<=0),e.xp6(3),e.s9C("matTooltip",e.lcZ(15,17,"Common.Preview")),e.Q6J("disabled",!o.isExpertMode||o.dataSource.length<=0),e.xp6(4),e.s9C("matTooltip",e.lcZ(19,19,"Common.Refresh")),e.Q6J("disabled",!o.isExpertMode),e.xp6(6),e.Q6J("dataSource",o.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(1),e.Q6J("length",o.resultsLength)("pageSize",20))},directives:[v.rD,w.lW,x.rH,G.gM,y.Hw,c.BZ,I.YE,c.w1,c.fO,c.ge,c.Dz,c.ev,I.nU,c.as,c.XQ,c.nj,c.Gk,T.NW],pipes:[Z.Ot,h.uU],styles:[".example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.example-container[_ngcontent-%COMP%]{position:relative;min-height:500px}.example-table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.example-loading-shade[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.mat-column-id[_ngcontent-%COMP%]{max-width:100px}.mat-column-createdat[_ngcontent-%COMP%]{max-width:124px}"]}),n})();var ie=l(4707),k=l(1159),g=l(3778),ae=l(9909),le=l(8966),p=l(9224),_=l(1125),C=l(3489),Q=l(7531),$=l(4107),P=l(508),A=l(6688),Y=l(7093);function re(n,a){if(1&n&&(e.TgZ(0,"mat-option",22),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(e.lcZ(2,2,t.i18nterm))}}function se(n,a){1&n&&(e.TgZ(0,"mat-icon",25),e._uU(1,"cancel"),e.qZA())}function me(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip",23),e.NdJ("removed",function(){const r=e.CHM(t).$implicit;return e.oxw().removeTag(r)}),e._uU(1),e.YNc(2,se,2,0,"mat-icon",24),e.qZA()}if(2&n){const t=a.$implicit,o=e.oxw();e.Q6J("selectable",o.selectable)("removable",o.isEditable),e.xp6(1),e.hij(" ",t," "),e.xp6(1),e.Q6J("ngIf",o.isEditable)}}function ce(n,a){if(1&n&&(e.TgZ(0,"mat-expansion-panel"),e.TgZ(1,"mat-expansion-panel-header"),e.TgZ(2,"mat-panel-title"),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"mat-panel-description"),e._uU(6),e.ALo(7,"transloco"),e.TgZ(8,"mat-icon"),e._uU(9,"info"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"div",26),e.TgZ(11,"div",27),e.TgZ(12,"mat-form-field",8),e.TgZ(13,"mat-label"),e._uU(14),e.ALo(15,"transloco"),e.qZA(),e._UZ(16,"input",28),e.ALo(17,"transloco"),e.ALo(18,"date"),e.qZA(),e.qZA(),e.TgZ(19,"div",27),e.TgZ(20,"mat-form-field",8),e.TgZ(21,"mat-label"),e._uU(22),e.ALo(23,"transloco"),e.qZA(),e._UZ(24,"input",28),e.ALo(25,"transloco"),e.ALo(26,"date"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,8,"Administrative")),e.xp6(3),e.Oqu(e.lcZ(7,10,"AdministrativeInfo")),e.xp6(8),e.Oqu(e.lcZ(15,12,"CreatedAt")),e.xp6(2),e.s9C("placeholder",e.lcZ(17,14,"CreatedAt")),e.Q6J("ngModel",e.xi3(18,16,t.currentItem.CreatedAt,"yyyy-M-d HH:mm:ss")),e.xp6(6),e.Oqu(e.lcZ(23,19,"ModifiedAt")),e.xp6(2),e.s9C("placeholder",e.lcZ(25,21,"ModifiedAt")),e.Q6J("ngModel",e.xi3(26,23,t.currentItem.ModifiedAt,"yyyy-M-d HH:mm:ss"))}}function de(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-toolbar"),e.TgZ(1,"h3"),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e._UZ(4,"div",29),e.TgZ(5,"button",30),e.NdJ("click",function(){return e.CHM(t),e.oxw().openUploadDialog()}),e.TgZ(6,"mat-icon"),e._uU(7,"file_upload"),e.qZA(),e.qZA(),e.qZA()}2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"Content")))}function pe(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",27),e.TgZ(1,"ngx-monaco-editor",31),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().content=i}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("options",t.editorOptions)("ngModel",t.content)}}let b=(()=>{class n{constructor(t,o,i,r){this.dialog=t,this.activateRoute=o,this.uiUtilSrv=i,this.odataService=r,this.routerID=-1,this.uiMode=g.sk.Create,this.currentMode="",this.editorOptions={theme:"vs-dark",wordWrap:"on"},this.content="New Knowledge Item",this.mathOptions={displayMode:!0,throwOnError:!1,errorColor:"#cc0000"},this.selectable=!0,this.addOnBlur=!0,this.separatorKeysCodes=[k.K5,k.OC],this.tags=[],this.arKnowledgeCtgies=[],this.arKnowledgeCtgies=(0,d.dJ)(),this.itemFormGroup=new m.cw({idControl:new m.NI({value:null,disabled:!0}),titleControl:new m.NI("",m.kI.required),ctgyControl:new m.NI({value:d.Nn.Concept}),tagControl:new m.NI})}get isDisplayMode(){return this.uiMode===g.sk.Display}get isCreateMode(){return this.uiMode===g.sk.Create}get isUpdateMode(){return this.uiMode===g.sk.Update}get isEditable(){return this.uiMode===g.sk.Create||this.uiMode===g.sk.Update}ngOnInit(){this.destroyed$=new ie.t(1),this.activateRoute.url.subscribe({next:t=>{var o,i;t instanceof Array&&t.length>0&&("create"===t[0].path?(this.routerID=-1,this.uiMode=g.sk.Create,this.currentMode="Common.Create"):"edit"===t[0].path?(this.routerID=+t[1].path,this.uiMode=g.sk.Update,this.currentMode="Common.Change"):"display"===t[0].path&&(this.routerID=+t[1].path,this.uiMode=g.sk.Display,this.currentMode="Common.Display")),-1!==this.routerID?this.odataService.readKnowledgeItem(this.routerID,this.uiMode===g.sk.Update).subscribe({next:r=>{var s,u,S;null===(s=this.itemFormGroup.get("idControl"))||void 0===s||s.setValue(r.ID),null===(u=this.itemFormGroup.get("titleControl"))||void 0===u||u.setValue(r.Title),null===(S=this.itemFormGroup.get("ctgyControl"))||void 0===S||S.setValue(+r.ItemCategory),this.content=r.Content,this.tags=r.Tags,this.currentItem=r,this.isDisplayMode?this.itemFormGroup.disable():this.itemFormGroup.markAsPristine()},error:r=>{console.error(r)}}):(null===(o=this.itemFormGroup.get("idControl"))||void 0===o||o.setValue("NEW"),null===(i=this.itemFormGroup.get("idControl"))||void 0===i||i.disable(),this.itemFormGroup.markAsPristine(),this.itemFormGroup.markAsUntouched())},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})}ngOnDestroy(){this.destroyed$&&(this.destroyed$.complete(),this.destroyed$=void 0)}onOK(){var t,o,i,r;if(this.isCreateMode){if(!this.itemFormGroup.valid)return void(this.itemFormGroup.errors&&this.uiUtilSrv.showSnackInfo(this.itemFormGroup.errors.toString()));const s=new d.xX;s.ItemCategory=null===(t=this.itemFormGroup.get("ctgyControl"))||void 0===t?void 0:t.value,s.Content=this.content,s.Title=null===(o=this.itemFormGroup.get("titleControl"))||void 0===o?void 0:o.value,s.Tags=this.tags,this.odataService.createKnowledgeItem(s).subscribe({next:u=>{this.uiUtilSrv.navigateKnowledgeItemDisplayPage(u.ID)},error:u=>{this.uiUtilSrv.showSnackInfo(u)}})}else if(this.isUpdateMode){if(!this.itemFormGroup.valid)return void(this.itemFormGroup.errors&&this.uiUtilSrv.showSnackInfo(this.itemFormGroup.errors.toString()));this.currentItem&&(this.currentItem.ItemCategory=null===(i=this.itemFormGroup.get("ctgyControl"))||void 0===i?void 0:i.value,this.currentItem.Content=this.content,this.currentItem.Title=null===(r=this.itemFormGroup.get("titleControl"))||void 0===r?void 0:r.value,this.currentItem.Tags=this.tags,this.odataService.changeKnowledgeItem(this.currentItem).subscribe({next:s=>{this.uiUtilSrv.navigateKnowledgeItemDisplayPage(s.ID)},error:s=>{this.uiUtilSrv.showSnackInfo(s)}}))}}openUploadDialog(){this.dialog.open(ae.J,{width:"50%",height:"50%"}).afterClosed().subscribe({next:o=>{console.log(o),o.forEach(i=>{this.content+=`\n![Img](${i.url})\n          `})}})}addTag(t){const o=t.input,i=t.value;(i||"").trim()&&this.tags.push(i.trim()),o&&(o.value="")}removeTag(t){const o=this.tags.indexOf(t);o>=0&&this.tags.splice(o,1)}onReturnToList(){this.uiUtilSrv.navigateKnowledgeItemListPage()}onCreateNewOne(){this.uiUtilSrv.navigateKnowledgeItemCreatePage()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(le.uw),e.Y36(x.gz),e.Y36(f.dM),e.Y36(f.CB))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-knowledge-item-detail"]],decls:61,vars:44,consts:[["multi","",1,"example-headers-align"],["expanded",""],[3,"formGroup"],[1,"control-full-width"],["matInput","","type","text","placeholder","#","formControlName","idControl"],["matInput","","type","text","formControlName","titleControl","required","","name","title","maxlength","30",3,"placeholder"],["title",""],["align","end"],["appearance","fill",1,"control-full-width"],["required","","formControlName","ctgyControl"],[3,"value",4,"ngFor","ngForOf"],["formControlName","tagControl"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","New tag...",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[4,"ngIf"],["fxLayout","row",1,"control-full-width",2,"height","500px"],["fxFlex","50",4,"ngIf"],["fxFlex","",2,"height","100%","overflow-y","scroll"],["katex","",3,"data","katexOptions"],["mat-button","",3,"disabled","click"],["mat-button","",3,"click"],[3,"value"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],["fxLayout","row",1,"control-full-width"],["fxFlex","50"],["matInput","","type","text","disabled","",3,"placeholder","ngModel"],[1,"toolbar-spacer"],["mat-raised-button","",3,"click"],[2,"height","100%",3,"options","ngModel","ngModelChange"]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-card"),e.TgZ(1,"mat-card-header"),e.TgZ(2,"mat-card-title"),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"mat-card-subtitle"),e._uU(6),e.ALo(7,"transloco"),e.qZA(),e.qZA(),e.TgZ(8,"mat-card-content"),e.TgZ(9,"mat-accordion",0),e.TgZ(10,"mat-expansion-panel",1),e.TgZ(11,"mat-expansion-panel-header"),e.TgZ(12,"mat-panel-title"),e._uU(13),e.ALo(14,"transloco"),e.qZA(),e.TgZ(15,"mat-panel-description"),e._uU(16),e.ALo(17,"transloco"),e.TgZ(18,"mat-icon"),e._uU(19,"public"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"form",2),e.TgZ(21,"mat-form-field",3),e.TgZ(22,"mat-label"),e._uU(23,"#"),e.qZA(),e._UZ(24,"input",4),e.qZA(),e.TgZ(25,"mat-form-field",3),e._UZ(26,"input",5,6),e.ALo(28,"transloco"),e.TgZ(29,"mat-hint",7),e._uU(30),e.qZA(),e.qZA(),e.TgZ(31,"mat-form-field",8),e.TgZ(32,"mat-label"),e._uU(33),e.ALo(34,"transloco"),e.qZA(),e.TgZ(35,"mat-select",9),e.YNc(36,re,3,4,"mat-option",10),e.qZA(),e.qZA(),e.TgZ(37,"mat-form-field",8),e.TgZ(38,"mat-label"),e._uU(39),e.ALo(40,"transloco"),e.qZA(),e.TgZ(41,"mat-chip-list",11,12),e.YNc(43,me,3,4,"mat-chip",13),e.TgZ(44,"input",14),e.NdJ("matChipInputTokenEnd",function(r){return o.addTag(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(45,ce,27,26,"mat-expansion-panel",15),e.qZA(),e.YNc(46,de,8,3,"mat-toolbar",15),e.TgZ(47,"div",16),e.YNc(48,pe,2,2,"div",17),e.TgZ(49,"div",18),e._UZ(50,"markdown",19),e.qZA(),e.qZA(),e.qZA(),e.TgZ(51,"mat-card-actions"),e.TgZ(52,"button",20),e.NdJ("click",function(){return o.onOK()}),e._uU(53),e.ALo(54,"transloco"),e.qZA(),e.TgZ(55,"button",21),e.NdJ("click",function(){return o.onReturnToList()}),e._uU(56),e.ALo(57,"transloco"),e.qZA(),e.TgZ(58,"button",20),e.NdJ("click",function(){return o.onCreateNewOne()}),e._uU(59),e.ALo(60,"transloco"),e.qZA(),e.qZA(),e.qZA()),2&t){const i=e.MAs(27),r=e.MAs(42);e.xp6(3),e.Oqu(e.lcZ(4,24,"KnowledgeItem")),e.xp6(3),e.Oqu(e.lcZ(7,26,o.currentMode)),e.xp6(7),e.Oqu(e.lcZ(14,28,"Header")),e.xp6(3),e.Oqu(e.lcZ(17,30,"HeaderInfo")),e.xp6(4),e.Q6J("formGroup",o.itemFormGroup),e.xp6(6),e.s9C("placeholder",e.lcZ(28,32,"Title")),e.xp6(4),e.hij("",i.value.length," / 30"),e.xp6(3),e.Oqu(e.lcZ(34,34,"Category")),e.xp6(3),e.Q6J("ngForOf",o.arKnowledgeCtgies),e.xp6(3),e.Oqu(e.lcZ(40,36,"Tags")),e.xp6(4),e.Q6J("ngForOf",o.tags),e.xp6(1),e.Q6J("matChipInputFor",r)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes)("matChipInputAddOnBlur",o.addOnBlur),e.xp6(1),e.Q6J("ngIf",!o.isCreateMode&&o.currentItem),e.xp6(1),e.Q6J("ngIf",o.isCreateMode),e.xp6(2),e.Q6J("ngIf",!o.isDisplayMode),e.xp6(2),e.Q6J("data",o.content)("katexOptions",o.mathOptions),e.xp6(2),e.Q6J("disabled",!(o.isEditable&&o.itemFormGroup.valid)),e.xp6(1),e.Oqu(e.lcZ(54,38,"Save")),e.xp6(3),e.Oqu(e.lcZ(57,40,"Common.ReturnToList")),e.xp6(2),e.Q6J("disabled",!o.isDisplayMode),e.xp6(1),e.Oqu(e.lcZ(60,42,"Common.CreateAnotherOne"))}},directives:[p.a8,p.dk,p.n5,p.$j,p.dn,_.pp,_.ib,_.yz,_.yK,_.u4,y.Hw,m._Y,m.JL,m.sg,C.KE,C.hX,Q.Nt,m.Fj,m.JJ,m.u,m.Q7,m.nD,C.bx,$.gD,h.sg,P.ey,A.qn,A.HS,h.O5,A.qH,A.oH,Y.xw,Y.yH,m.On,v.Ye,w.lW,U.T2,O.lF,p.hq],pipes:[Z.Ot,h.uU],styles:[".example-form[_ngcontent-%COMP%]{margin:8px;min-width:150px;max-width:500px;width:100%}.mat-card-actions[_ngcontent-%COMP%]{margin-top:50px}.example-action-buttons[_ngcontent-%COMP%]{padding-bottom:20px}.example-headers-align[_ngcontent-%COMP%]{margin:8px}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%], .example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{flex-basis:0}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{justify-content:space-between;align-items:center}.example-headers-align[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%] + .mat-form-field[_ngcontent-%COMP%]{margin-left:8px}"]}),n})();var ge=l(1135),ue=l(8746),q=l(6856),he=l(7446),fe=l(4834),_e=l(7467);function Ce(n,a){if(1&n&&(e.TgZ(0,"mat-option",25),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.displayas)," ")}}function Ze(n,a){if(1&n&&(e.TgZ(0,"mat-option",25),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.i18nterm)," ")}}function xe(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field"),e.TgZ(1,"input",26),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.value[0]=i}),e.ALo(2,"transloco"),e.qZA(),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.s9C("placeholder",e.lcZ(2,2,"Value")),e.Q6J("ngModel",t.value[0])}}function Te(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field"),e.TgZ(1,"input",27),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.value[1]=i}),e.ALo(2,"transloco"),e.qZA(),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.s9C("placeholder",e.lcZ(2,2,"Value")),e.Q6J("ngModel",t.value[1])}}function ve(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field"),e.TgZ(1,"input",28),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.value[0]=i}),e.ALo(2,"transloco"),e.qZA(),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.s9C("placeholder",e.lcZ(2,2,"Value")),e.Q6J("ngModel",t.value[0])}}function we(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field"),e.TgZ(1,"input",29),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.value[0]=i}),e.ALo(2,"transloco"),e.qZA(),e._UZ(3,"mat-datepicker-toggle",30),e._UZ(4,"mat-datepicker",null,31),e.qZA()}if(2&n){const t=e.MAs(5),o=e.oxw().$implicit;e.xp6(1),e.s9C("placeholder",e.lcZ(2,4,"Value")),e.Q6J("ngModel",o.value[0])("matDatepicker",t),e.xp6(2),e.Q6J("for",t)}}function Ae(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field"),e.TgZ(1,"input",29),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.value[1]=i}),e.ALo(2,"transloco"),e.qZA(),e._UZ(3,"mat-datepicker-toggle",30),e._UZ(4,"mat-datepicker",null,32),e.qZA()}if(2&n){const t=e.MAs(5),o=e.oxw().$implicit;e.xp6(1),e.s9C("placeholder",e.lcZ(2,4,"Value")),e.Q6J("ngModel",o.value[1])("matDatepicker",t),e.xp6(2),e.Q6J("for",t)}}function Ie(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",33),e.TgZ(1,"mat-checkbox",34),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.value[0]=i}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngModel",t.value[0])}}function Me(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",17),e.TgZ(1,"mat-form-field"),e.TgZ(2,"mat-select",18),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.fieldName=i})("selectionChange",function(){const r=e.CHM(t).$implicit;return e.oxw().onFieldSelectionChanged(r)}),e.ALo(3,"transloco"),e.YNc(4,Ce,3,4,"mat-option",19),e.qZA(),e.qZA(),e.TgZ(5,"mat-form-field"),e.TgZ(6,"mat-select",20),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.operator=i}),e.ALo(7,"transloco"),e.YNc(8,Ze,3,4,"mat-option",19),e.ALo(9,"operatorFilter"),e.qZA(),e.qZA(),e.YNc(10,xe,3,4,"mat-form-field",21),e.YNc(11,Te,3,4,"mat-form-field",21),e.YNc(12,ve,3,4,"mat-form-field",21),e.YNc(13,we,6,6,"mat-form-field",21),e.YNc(14,Ae,6,6,"mat-form-field",21),e.YNc(15,Ie,2,1,"div",22),e.TgZ(16,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().onAddFilter()}),e.TgZ(17,"mat-icon"),e._uU(18,"add"),e.qZA(),e.qZA(),e.TgZ(19,"button",24),e.NdJ("click",function(){const r=e.CHM(t).index;return e.oxw().onRemoveFilter(r)}),e.TgZ(20,"mat-icon"),e._uU(21,"close"),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=a.$implicit,o=e.oxw();e.xp6(2),e.s9C("placeholder",e.lcZ(3,12,"Field")),e.Q6J("ngModel",t.fieldName),e.xp6(2),e.Q6J("ngForOf",o.allFields),e.xp6(2),e.s9C("placeholder",e.lcZ(7,14,"Operator")),e.Q6J("ngModel",t.operator),e.xp6(2),e.Q6J("ngForOf",e.xi3(9,16,o.allOperators,t.valueType)),e.xp6(2),e.Q6J("ngIf",1===t.valueType),e.xp6(1),e.Q6J("ngIf",1===t.valueType),e.xp6(1),e.Q6J("ngIf",2===t.valueType),e.xp6(1),e.Q6J("ngIf",3===t.valueType),e.xp6(1),e.Q6J("ngIf",3===t.valueType),e.xp6(1),e.Q6J("ngIf",4===t.valueType)}}function ye(n,a){1&n&&(e.TgZ(0,"th",35),e._uU(1,"#"),e.qZA())}function be(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"td",36),e.TgZ(1,"div"),e._uU(2),e.TgZ(3,"a",37),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().onDisplayItem(r.ID)}),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",t.ID," "),e.xp6(2),e.Oqu(e.lcZ(5,2,"Common.Display"))}}function qe(n,a){1&n&&(e.TgZ(0,"th",35),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Category")))}function Se(n,a){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n){const t=a.$implicit,o=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,o.getKnowledgeItemCategoryName(t.ItemCategory)))}}function Ke(n,a){1&n&&(e.TgZ(0,"th",35),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Title")))}function Ue(n,a){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu(t.Title)}}function Oe(n,a){1&n&&(e.TgZ(0,"th",35),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"CreatedAt")))}function Ne(n,a){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,t.CreatedAt,"yyyy-M-d HH:mm:ss"))}}function De(n,a){1&n&&e._UZ(0,"tr",38)}function Je(n,a){1&n&&e._UZ(0,"tr",39)}const Fe=[{path:"",component:ne},{path:"create",component:b},{path:"display/:id",component:b},{path:"edit/:id",component:b},{path:"search",component:(()=>{class n{constructor(t,o){this.odataService=t,this.uiUtilSrv=o,this.filters=[],this.allOperators=[],this.allFields=[],this.filterEditable=!0,this.pageSize=20,this.pageSizeOptions=[20,40,60,100],this.isLoadingResults=!1,this.subjFilters=new ge.X([]),this.displayedColumns=["id","category","title","createdat"],this.dataSource=[],this.resultsLength=0,this.allOperators=d.c.getGeneralFilterOperatorDisplayStrings(),this.allFields=[{displayas:"Content",value:"Content",valueType:2}]}ngOnInit(){this.onAddFilter()}ngAfterViewInit(){this.subjFilters.subscribe(()=>this.paginator.pageIndex=0),(0,N.T)(this.subjFilters,this.paginator.page).pipe((0,D.O)({}),(0,J.w)(()=>{if(this.subjFilters.value.length<=0)return(0,M.of)([]);this.isLoadingResults=!0;const t=this.prepareFilters(this.subjFilters.value),o=this.paginator.pageSize;return this.odataService.getKnowledgeItems(o,o*this.paginator.pageIndex,void 0,void 0,t)}),(0,ue.x)(()=>this.isLoadingResults=!1),(0,F.U)(t=>(this.resultsLength=t.totalCount,t.items)),(0,L.K)(()=>(0,M.of)(void 0))).subscribe({next:t=>this.dataSource=t,error:t=>this.uiUtilSrv.showSnackInfo(t)})}getKnowledgeItemCategoryName(t){return(0,d._h)(t)}onAddFilter(){this.filters.push(new d.T$)}onRemoveFilter(t){this.filters.splice(t,1),0===this.filters.length&&this.onAddFilter()}onFieldSelectionChanged(t){this.allFields.forEach(o=>{o.value===t.fieldName&&(t.valueType=o.valueType)})}prepareFilters(t){let o="";return t.sort((i,r)=>i.fieldName.localeCompare(r.fieldName)),t.forEach(i=>{"Content"===i.fieldName&&(i.operator===d.Nu.Equal?o=o?`${o} and ${i.fieldName} eq '${i.lowValue}'`:`${i.fieldName} eq '${i.lowValue}'`:i.operator===d.Nu.Like&&(o=o?`${o} and contains(${i.fieldName},'${i.lowValue}')`:`contains(${i.fieldName},'${i.lowValue}')`))}),o}onSearch(){const t=[];this.filters.forEach(o=>{const i={};switch(i.valueType=+o.valueType,o.valueType){case d._g.boolean:case d._g.date:case d._g.number:break;case d._g.string:i.fieldName=o.fieldName,i.operator=+o.operator,i.lowValue=o.value[0],i.highValue=o.operator===d.Nu.Between?o.value[1]:""}t.push(i)}),this.subjFilters.next(t)}onDisplayItem(t){this.uiUtilSrv.navigateKnowledgeItemDisplayPage(t)}onGoToPreview(){const t=[];this.dataSource.forEach(o=>{t.push({refType:d.ik.KnowledgeItem,refId:o.ID})}),this.uiUtilSrv.navigatePreviewPage(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.CB),e.Y36(f.dM))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-knowledge-item-search"]],viewQuery:function(t,o){if(1&t&&e.Gf(T.NW,7),2&t){let i;e.iGM(i=e.CRH())&&(o.paginator=i.first)}},decls:41,vars:18,consts:[["class","demo-full-width",4,"ngFor","ngForOf"],[1,"control-full-width"],["mat-button","","aria-label","Search",3,"click"],[1,"table-container","mat-elevation-z8"],["color","primary"],["mat-flat-button","","color","primary",3,"click"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","category"],["matColumnDef","title"],["matColumnDef","createdat"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],[1,"demo-full-width"],[3,"placeholder","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","ngModelChange"],[4,"ngIf"],["class","typechkbox",4,"ngIf"],["mat-button","","mat-icon-button","","aria-label","Add",3,"click"],["mat-button","","mat-icon-button","","aria-label","Clear",3,"click"],[3,"value"],["matInput","","type","number","name","lvalue_1",3,"placeholder","ngModel","ngModelChange"],["matInput","","type","number","name","hvalue_1",3,"placeholder","ngModel","ngModelChange"],["matInput","","type","text","name","lvalue_2",3,"placeholder","ngModel","ngModelChange"],["matInput","",3,"ngModel","matDatepicker","placeholder","ngModelChange"],["matSuffix","",3,"for"],["lvpicker",""],["hvpicker",""],[1,"typechkbox"],[3,"ngModel","ngModelChange"],["mat-header-cell",""],["mat-cell",""],["mat-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,o){1&t&&(e.TgZ(0,"mat-card"),e.TgZ(1,"mat-card-header"),e.TgZ(2,"mat-card-title"),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"mat-card-subtitle"),e._uU(6),e.ALo(7,"transloco"),e.qZA(),e.qZA(),e.TgZ(8,"mat-card-content"),e.TgZ(9,"div"),e.YNc(10,Me,22,19,"div",0),e.TgZ(11,"div",1),e.TgZ(12,"button",2),e.NdJ("click",function(){return o.onSearch()}),e.TgZ(13,"mat-icon"),e._uU(14,"search"),e.qZA(),e._uU(15),e.ALo(16,"transloco"),e.qZA(),e.qZA(),e.qZA(),e._UZ(17,"mat-divider"),e.TgZ(18,"div",3),e.TgZ(19,"mat-toolbar",4),e.TgZ(20,"mat-toolbar-row"),e.TgZ(21,"button",5),e.NdJ("click",function(){return o.onGoToPreview()}),e._uU(22),e.ALo(23,"transloco"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"div",6),e.TgZ(25,"table",7),e.ynx(26,8),e.YNc(27,ye,2,0,"th",9),e.YNc(28,be,6,4,"td",10),e.BQk(),e.ynx(29,11),e.YNc(30,qe,3,3,"th",9),e.YNc(31,Se,3,3,"td",10),e.BQk(),e.ynx(32,12),e.YNc(33,Ke,3,3,"th",9),e.YNc(34,Ue,2,1,"td",10),e.BQk(),e.ynx(35,13),e.YNc(36,Oe,3,3,"th",9),e.YNc(37,Ne,3,4,"td",10),e.BQk(),e.YNc(38,De,1,0,"tr",14),e.YNc(39,Je,1,0,"tr",15),e.qZA(),e.qZA(),e._UZ(40,"mat-paginator",16),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,10,"KnowledgeItem")),e.xp6(3),e.Oqu(e.lcZ(7,12,"Common.Search")),e.xp6(4),e.Q6J("ngForOf",o.filters),e.xp6(5),e.hij(" ",e.lcZ(16,14,"Common.Search")," "),e.xp6(7),e.Oqu(e.lcZ(23,16,"Common.Preview")),e.xp6(3),e.Q6J("dataSource",o.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(1),e.Q6J("length",o.resultsLength)("pageSize",20))},directives:[p.a8,p.dk,p.n5,p.$j,p.dn,h.sg,C.KE,$.gD,m.JJ,m.On,P.ey,h.O5,Q.Nt,m.wV,m.Fj,q.hl,q.nW,C.R9,q.Mq,he.oG,w.lW,y.Hw,fe.d,v.Ye,v.rD,c.BZ,c.w1,c.fO,c.ge,c.Dz,c.ev,w.zs,c.as,c.XQ,c.nj,c.Gk,T.NW],pipes:[Z.Ot,_e.M,h.uU],styles:[".table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;margin-top:16px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.data-loading-shade[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.mat-column-id[_ngcontent-%COMP%]{max-width:300px;width:250px}.mat-column-itemtype[_ngcontent-%COMP%]{max-width:120px;width:120px}.mat-column-tags[_ngcontent-%COMP%]{max-width:250px;width:150px}.mat-column-created[_ngcontent-%COMP%]{max-width:120px;width:120px}"]}),n})()}];let Le=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[x.Bz.forChild(Fe)],x.Bz]}),n})();var ke=l(558);let Qe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[],imports:[[h.ez,m.u5,m.UX,E.U,H.l,U.nm,O.JP.forChild(),Le,Z.y4,ke.D]]}),n})()}}]);