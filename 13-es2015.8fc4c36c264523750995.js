(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"U+IK":function(t,e,o){"use strict";o.r(e),o.d(e,"KnowledgeItemsModule",function(){return jt});var i=o("ofXK"),n=o("3Pt+"),a=o("0LvA"),c=o("lR5k"),r=o("QPBi"),l=o("jIBr"),s=o("dcRk"),d=o("tyNb"),b=o("fXoL"),m=o("M9IT"),u=o("Dh3D"),h=o("VRyK"),p=o("LRne"),g=o("JX91"),f=o("eIep"),v=o("lJxs"),C=o("JIr8"),E=o("VHTt"),w=o("o0su"),V=o("/t3+"),y=o("bTqV"),U=o("+0xr");function F(t,e){1&t&&(b.Vb(0,"th",16),b.Ec(1,"#"),b.Ub())}function I(t,e){if(1&t){const t=b.Wb();b.Vb(0,"td",17),b.Vb(1,"div"),b.Ec(2),b.Vb(3,"a",18),b.Ec(4),b.ic(5,"transloco"),b.Ub(),b.Vb(6,"a",18),b.Ec(7),b.ic(8,"transloco"),b.Ub(),b.Vb(9,"a",19),b.dc("click",function(){b.wc(t);const o=e.$implicit;return b.hc().onDeleteItem(o.ID)}),b.Ec(10),b.ic(11,"transloco"),b.Ub(),b.Ub(),b.Ub()}if(2&t){const t=e.$implicit,o=b.hc();b.Eb(2),b.Gc(" ",t.ID," "),b.Eb(1),b.pc("routerLink","display/",t.ID,""),b.nc("disabled",!o.isExpertMode),b.Eb(1),b.Fc(b.jc(5,9,"Common.Display")),b.Eb(2),b.pc("routerLink","edit/",t.ID,""),b.nc("disabled",!o.isExpertMode),b.Eb(1),b.Fc(b.jc(8,11,"Common.Change")),b.Eb(2),b.nc("disabled",!o.isExpertMode),b.Eb(1),b.Fc(b.jc(11,13,"Common.Delete"))}}function M(t,e){1&t&&(b.Vb(0,"th",16),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t&&(b.Eb(1),b.Fc(b.jc(2,1,"Category")))}function D(t,e){if(1&t&&(b.Vb(0,"td",17),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t){const t=e.$implicit,o=b.hc();b.Eb(1),b.Fc(b.jc(2,1,o.getKnowledgeItemCategoryName(t.ItemCategory)))}}function x(t,e){1&t&&(b.Vb(0,"th",16),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t&&(b.Eb(1),b.Fc(b.jc(2,1,"Title")))}function j(t,e){if(1&t&&(b.Vb(0,"td",17),b.Ec(1),b.Ub()),2&t){const t=e.$implicit;b.Eb(1),b.Fc(t.Title)}}function k(t,e){1&t&&(b.Vb(0,"th",20),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t&&(b.Eb(1),b.Fc(b.jc(2,1,"CreatedAt")))}function O(t,e){if(1&t&&(b.Vb(0,"td",17),b.Ec(1),b.ic(2,"date"),b.Ub()),2&t){const t=e.$implicit;b.Eb(1),b.Fc(b.kc(2,1,t.CreatedAt,"yyyy-M-d HH:mm:ss"))}}function S(t,e){1&t&&b.Qb(0,"tr",21)}function T(t,e){1&t&&b.Qb(0,"tr",22)}let $=(()=>{class t{constructor(t,e){this.odataService=t,this.router=e,this.displayedColumns=["id","category","title","createdat"],this.dataSource=[],this.resultsLength=0,this.isLoadingResults=!0,this.refreshEvent=new b.o}getKnowledgeItemCategoryName(t){return Object(E.C)(t)}get isExpertMode(){return this.odataService.expertMode}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),Object(h.a)(this.sort.sortChange,this.paginator.page,this.refreshEvent).pipe(Object(g.a)({}),Object(f.a)(()=>{this.isLoadingResults=!0;const t=this.paginator.pageSize;return this.odataService.getKnowledgeItems(t,t*this.paginator.pageIndex,this.sort.active,this.sort.direction)}),Object(v.a)(t=>(this.isLoadingResults=!1,this.resultsLength=t.totalCount,t.items)),Object(C.a)(()=>(this.isLoadingResults=!1,Object(p.a)([])))).subscribe(t=>this.dataSource=t)}onGoToPreview(){const t=[];this.dataSource.forEach(e=>{t.push({refType:E.y.KnowledgeItem,refId:e.ID})}),this.odataService.previewObjList=t,this.router.navigate(["preview"])}onGoToSearch(){this.router.navigate(["knowledge-item","search"])}onDeleteItem(t){this.odataService.deleteExerciseItem(t).subscribe({next:t=>{this.onRefreshList()},error:t=>{console.error(t)}})}onRefreshList(){this.refreshEvent.emit()}resetPaging(){this.paginator.pageIndex=0}}return t.\u0275fac=function(e){return new(e||t)(b.Pb(w.b),b.Pb(d.b))},t.\u0275cmp=b.Jb({type:t,selectors:[["app-knowledge-items"]],viewQuery:function(t,e){if(1&t&&(b.Jc(m.a,1),b.Jc(u.a,1)),2&t){let t;b.tc(t=b.ec())&&(e.paginator=t.first),b.tc(t=b.ec())&&(e.sort=t.first)}},decls:36,vars:24,consts:[[1,"toolbar-spacer"],["mat-stroked-button","","routerLink","create",3,"disabled"],["mat-stroked-button","",3,"disabled","click"],[1,"example-container","mat-elevation-z8"],[1,"example-table-container"],["mat-table","","matSort","",1,"example-table",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","category"],["matColumnDef","title"],["matColumnDef","createdat"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-button","",3,"disabled","routerLink"],["mat-button","",3,"disabled","click"],["mat-header-cell","","mat-sort-header",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(b.Vb(0,"mat-toolbar-row"),b.Vb(1,"span"),b.Ec(2),b.ic(3,"transloco"),b.Ub(),b.Qb(4,"span",0),b.Vb(5,"section"),b.Vb(6,"a",1),b.Ec(7),b.ic(8,"transloco"),b.Ub(),b.Vb(9,"a",2),b.dc("click",function(){return e.onGoToSearch()}),b.Ec(10),b.ic(11,"transloco"),b.Ub(),b.Vb(12,"a",2),b.dc("click",function(){return e.onGoToPreview()}),b.Ec(13),b.ic(14,"transloco"),b.Ub(),b.Vb(15,"a",2),b.dc("click",function(){return e.onRefreshList()}),b.Ec(16),b.ic(17,"transloco"),b.Ub(),b.Ub(),b.Ub(),b.Vb(18,"div",3),b.Vb(19,"div",4),b.Vb(20,"table",5),b.dc("matSortChange",function(){return e.resetPaging()}),b.Tb(21,6),b.Dc(22,F,2,0,"th",7),b.Dc(23,I,12,15,"td",8),b.Sb(),b.Tb(24,9),b.Dc(25,M,3,3,"th",7),b.Dc(26,D,3,3,"td",8),b.Sb(),b.Tb(27,10),b.Dc(28,x,3,3,"th",7),b.Dc(29,j,2,1,"td",8),b.Sb(),b.Tb(30,11),b.Dc(31,k,3,3,"th",12),b.Dc(32,O,3,4,"td",8),b.Sb(),b.Dc(33,S,1,0,"tr",13),b.Dc(34,T,1,0,"tr",14),b.Ub(),b.Ub(),b.Qb(35,"mat-paginator",15),b.Ub()),2&t&&(b.Eb(2),b.Fc(b.jc(3,14,"KnowledgeItem")),b.Eb(4),b.nc("disabled",!e.isExpertMode),b.Eb(1),b.Fc(b.jc(8,16,"Common.Create")),b.Eb(2),b.nc("disabled",!e.isExpertMode||e.dataSource.length<=0),b.Eb(1),b.Fc(b.jc(11,18,"Common.Search")),b.Eb(2),b.nc("disabled",!e.isExpertMode||e.dataSource.length<=0),b.Eb(1),b.Fc(b.jc(14,20,"Common.Preview")),b.Eb(2),b.nc("disabled",!e.isExpertMode),b.Eb(1),b.Fc(b.jc(17,22,"Common.Refresh")),b.Eb(4),b.nc("dataSource",e.dataSource),b.Eb(13),b.nc("matHeaderRowDef",e.displayedColumns),b.Eb(1),b.nc("matRowDefColumns",e.displayedColumns),b.Eb(1),b.nc("length",e.resultsLength)("pageSize",20))},directives:[V.c,y.a,d.c,U.j,u.a,U.c,U.e,U.b,U.g,U.i,m.a,U.d,U.a,u.b,U.f,U.h],pipes:[r.d,i.e],styles:[".example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.example-container[_ngcontent-%COMP%]{position:relative;min-height:500px}.example-table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.example-loading-shade[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.mat-column-id[_ngcontent-%COMP%]{max-width:100px}.mat-column-createdat[_ngcontent-%COMP%]{max-width:124px}"]}),t})();var G=o("jtHE"),P=o("FtGj"),R=o("rCpU"),L=o("HKRH"),K=o("0IaG"),N=o("Wp6s"),A=o("kmnG"),Q=o("qFsG"),_=o("d3UM"),H=o("A5z7"),z=o("XiUz"),W=o("FKr1"),J=o("NFeN");function q(t,e){if(1&t&&(b.Vb(0,"mat-option",21),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t){const t=e.$implicit;b.nc("value",t.value),b.Eb(1),b.Fc(b.jc(2,2,t.i18nterm))}}function B(t,e){1&t&&(b.Vb(0,"mat-icon",24),b.Ec(1,"cancel"),b.Ub())}function X(t,e){if(1&t){const t=b.Wb();b.Vb(0,"mat-chip",22),b.dc("removed",function(){b.wc(t);const o=e.$implicit;return b.hc().removeTag(o)}),b.Ec(1),b.Dc(2,B,2,0,"mat-icon",23),b.Ub()}if(2&t){const t=e.$implicit,o=b.hc();b.nc("selectable",o.selectable)("removable",o.isEditable),b.Eb(1),b.Gc(" ",t," "),b.Eb(1),b.nc("ngIf",o.isEditable)}}function Y(t,e){if(1&t&&(b.Vb(0,"div",25),b.Vb(1,"div",26),b.Vb(2,"mat-form-field",6),b.Vb(3,"mat-label"),b.Ec(4),b.ic(5,"transloco"),b.Ub(),b.Qb(6,"input",27),b.ic(7,"transloco"),b.ic(8,"date"),b.Ub(),b.Ub(),b.Vb(9,"div",26),b.Vb(10,"mat-form-field",6),b.Vb(11,"mat-label"),b.Ec(12),b.ic(13,"transloco"),b.Ub(),b.Qb(14,"input",27),b.ic(15,"transloco"),b.ic(16,"date"),b.Ub(),b.Ub(),b.Ub()),2&t){const t=b.hc();b.Eb(4),b.Fc(b.jc(5,6,"CreatedAt")),b.Eb(2),b.oc("placeholder",b.jc(7,8,"CreatedAt")),b.nc("ngModel",b.kc(8,10,t.currentItem.CreatedAt,"yyyy-M-d HH:mm:ss")),b.Eb(6),b.Fc(b.jc(13,13,"ModifiedAt")),b.Eb(2),b.oc("placeholder",b.jc(15,15,"ModifiedAt")),b.nc("ngModel",b.kc(16,17,t.currentItem.ModifiedAt,"yyyy-M-d HH:mm:ss"))}}function Z(t,e){if(1&t){const t=b.Wb();b.Vb(0,"mat-toolbar"),b.Vb(1,"h3"),b.Ec(2),b.ic(3,"transloco"),b.Ub(),b.Qb(4,"div",28),b.Vb(5,"button",29),b.dc("click",function(){return b.wc(t),b.hc().openUploadDialog()}),b.Vb(6,"mat-icon"),b.Ec(7,"file_upload"),b.Ub(),b.Ub(),b.Ub()}2&t&&(b.Eb(2),b.Fc(b.jc(3,1,"Content")))}function tt(t,e){if(1&t){const t=b.Wb();b.Vb(0,"div",26),b.Vb(1,"ngx-monaco-editor",30),b.dc("ngModelChange",function(e){return b.wc(t),b.hc().content=e}),b.Ub(),b.Ub()}if(2&t){const t=b.hc();b.Eb(1),b.nc("options",t.editorOptions)("ngModel",t.content)}}let et=(()=>{class t{constructor(t,e,o,i){this.dialog=t,this.activateRoute=e,this.router=o,this.odataService=i,this.routerID=-1,this.uiMode=R.b.Create,this.currentMode="",this.editorOptions={theme:"vs-dark",wordWrap:"on"},this.content="New Knowledge Item",this.mathOptions={displayMode:!0,throwOnError:!1,errorColor:"#cc0000"},this.selectable=!0,this.addOnBlur=!0,this.separatorKeysCodes=[P.g,P.c],this.tags=[],this.arKnowledgeCtgies=[],this.arKnowledgeCtgies=Object(E.D)(),this.itemFormGroup=new n.f({idControl:new n.d({value:null,disabled:!0}),titleControl:new n.d("",n.t.required),ctgyControl:new n.d({value:E.o.Concept}),tagControl:new n.d})}get isDisplayMode(){return this.uiMode===R.b.Display}get isCreateMode(){return this.uiMode===R.b.Create}get isUpdateMode(){return this.uiMode===R.b.Update}get isEditable(){return this.uiMode===R.b.Create||this.uiMode===R.b.Update}ngOnInit(){this.destroyed$=new G.a(1),this.activateRoute.url.subscribe({next:t=>{var e,o;t instanceof Array&&t.length>0&&("create"===t[0].path?(this.routerID=-1,this.uiMode=R.b.Create,this.currentMode="Common.Create"):"edit"===t[0].path?(this.routerID=+t[1].path,this.uiMode=R.b.Update,this.currentMode="Common.Change"):"display"===t[0].path&&(this.routerID=+t[1].path,this.uiMode=R.b.Display,this.currentMode="Common.Display")),-1!==this.routerID?this.odataService.readKnowledgeItem(this.routerID,this.uiMode===R.b.Update).subscribe({next:t=>{var e,o,i;null===(e=this.itemFormGroup.get("idControl"))||void 0===e||e.setValue(t.ID),null===(o=this.itemFormGroup.get("titleControl"))||void 0===o||o.setValue(t.Title),null===(i=this.itemFormGroup.get("ctgyControl"))||void 0===i||i.setValue(+t.ItemCategory),this.content=t.Content,this.tags=t.Tags,this.currentItem=t,this.isDisplayMode?this.itemFormGroup.disable():this.itemFormGroup.markAsPristine()},error:t=>{console.error(t)}}):(null===(e=this.itemFormGroup.get("idControl"))||void 0===e||e.setValue("NEW"),null===(o=this.itemFormGroup.get("idControl"))||void 0===o||o.disable(),this.itemFormGroup.markAsPristine(),this.itemFormGroup.markAsUntouched())},error:t=>{console.error(t)}})}ngOnDestroy(){this.destroyed$&&(this.destroyed$.complete(),this.destroyed$=void 0)}onOK(){var t,e,o,i;if(this.isCreateMode){if(!this.itemFormGroup.valid)return void(this.itemFormGroup.errors&&console.log(this.itemFormGroup.errors));const o=new E.n;o.ItemCategory=null===(t=this.itemFormGroup.get("ctgyControl"))||void 0===t?void 0:t.value,o.Content=this.content,o.Title=null===(e=this.itemFormGroup.get("titleControl"))||void 0===e?void 0:e.value,o.Tags=this.tags,this.odataService.createKnowledgeItem(o).subscribe({next:t=>{this.router.navigate(["knowledge-item/display",t.ID])},error:t=>{console.error(t)}})}else if(this.isUpdateMode){if(!this.itemFormGroup.valid)return void(this.itemFormGroup.errors&&console.log(this.itemFormGroup.errors));this.currentItem&&(this.currentItem.ItemCategory=null===(o=this.itemFormGroup.get("ctgyControl"))||void 0===o?void 0:o.value,this.currentItem.Content=this.content,this.currentItem.Title=null===(i=this.itemFormGroup.get("titleControl"))||void 0===i?void 0:i.value,this.currentItem.Tags=this.tags,this.odataService.changeKnowledgeItem(this.currentItem).subscribe({next:t=>{this.router.navigate(["knowledge-item/display",t.ID])},error:t=>{console.error(t)}}))}}openUploadDialog(){this.dialog.open(L.a,{width:"50%",height:"50%"}).afterClosed().subscribe({next:t=>{console.log(t),t.forEach(t=>{this.content+=`\n![Img](${t.url})\n          `})}})}addTag(t){const e=t.input,o=t.value;(o||"").trim()&&this.tags.push(o.trim()),e&&(e.value="")}removeTag(t){const e=this.tags.indexOf(t);e>=0&&this.tags.splice(e,1)}onReturnToList(){this.router.navigate(["knowledge-item"])}onCreateNewOne(){this.router.navigate(["knowledge-item","create"])}}return t.\u0275fac=function(e){return new(e||t)(b.Pb(K.b),b.Pb(d.a),b.Pb(d.b),b.Pb(w.b))},t.\u0275cmp=b.Jb({type:t,selectors:[["app-knowledge-item-detail"]],decls:50,vars:38,consts:[[3,"formGroup"],[1,"control-full-width"],["matInput","","type","text","placeholder","#","formControlName","idControl"],["matInput","","type","text","formControlName","titleControl","required","","name","title","maxlength","30",3,"placeholder"],["title",""],["align","end"],["appearance","fill",1,"control-full-width"],["required","","formControlName","ctgyControl"],[3,"value",4,"ngFor","ngForOf"],["formControlName","tagControl"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","New tag...",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["fxLayout","row","class","control-full-width",4,"ngIf"],[4,"ngIf"],["fxLayout","row",1,"control-full-width",2,"height","500px"],["fxFlex","50",4,"ngIf"],["fxFlex","",2,"height","100%","overflow-y","scroll"],["katex","",3,"data","katexOptions"],["mat-button","",3,"disabled","click"],["mat-button","",3,"click"],[3,"value"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],["fxLayout","row",1,"control-full-width"],["fxFlex","50"],["matInput","","type","text","disabled","",3,"placeholder","ngModel"],[1,"toolbar-spacer"],["mat-raised-button","",3,"click"],[2,"height","100%",3,"options","ngModel","ngModelChange"]],template:function(t,e){if(1&t&&(b.Vb(0,"mat-card"),b.Vb(1,"mat-card-header"),b.Vb(2,"mat-card-title"),b.Ec(3),b.ic(4,"transloco"),b.Ub(),b.Vb(5,"mat-card-subtitle"),b.Ec(6),b.ic(7,"transloco"),b.Ub(),b.Ub(),b.Vb(8,"mat-card-content"),b.Vb(9,"form",0),b.Vb(10,"mat-form-field",1),b.Vb(11,"mat-label"),b.Ec(12,"#"),b.Ub(),b.Qb(13,"input",2),b.Ub(),b.Vb(14,"mat-form-field",1),b.Qb(15,"input",3,4),b.ic(17,"transloco"),b.Vb(18,"mat-hint",5),b.Ec(19),b.Ub(),b.Ub(),b.Vb(20,"mat-form-field",6),b.Vb(21,"mat-label"),b.Ec(22),b.ic(23,"transloco"),b.Ub(),b.Vb(24,"mat-select",7),b.Dc(25,q,3,4,"mat-option",8),b.Ub(),b.Ub(),b.Vb(26,"mat-form-field",6),b.Vb(27,"mat-label"),b.Ec(28),b.ic(29,"transloco"),b.Ub(),b.Vb(30,"mat-chip-list",9,10),b.Dc(32,X,3,4,"mat-chip",11),b.Vb(33,"input",12),b.dc("matChipInputTokenEnd",function(t){return e.addTag(t)}),b.Ub(),b.Ub(),b.Ub(),b.Ub(),b.Dc(34,Y,17,20,"div",13),b.Dc(35,Z,8,3,"mat-toolbar",14),b.Vb(36,"div",15),b.Dc(37,tt,2,2,"div",16),b.Vb(38,"div",17),b.Qb(39,"markdown",18),b.Ub(),b.Ub(),b.Ub(),b.Vb(40,"mat-card-actions"),b.Vb(41,"button",19),b.dc("click",function(){return e.onOK()}),b.Ec(42),b.ic(43,"transloco"),b.Ub(),b.Vb(44,"button",20),b.dc("click",function(){return e.onReturnToList()}),b.Ec(45),b.ic(46,"transloco"),b.Ub(),b.Vb(47,"button",19),b.dc("click",function(){return e.onCreateNewOne()}),b.Ec(48),b.ic(49,"transloco"),b.Ub(),b.Ub(),b.Ub()),2&t){const t=b.uc(16),o=b.uc(31);b.Eb(3),b.Fc(b.jc(4,22,"KnowledgeItem")),b.Eb(3),b.Fc(b.jc(7,24,e.currentMode)),b.Eb(3),b.nc("formGroup",e.itemFormGroup),b.Eb(6),b.oc("placeholder",b.jc(17,26,"Title")),b.Eb(4),b.Gc("",t.value.length," / 30"),b.Eb(3),b.Fc(b.jc(23,28,"Category")),b.Eb(3),b.nc("ngForOf",e.arKnowledgeCtgies),b.Eb(3),b.Fc(b.jc(29,30,"Tags")),b.Eb(4),b.nc("ngForOf",e.tags),b.Eb(1),b.nc("matChipInputFor",o)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes)("matChipInputAddOnBlur",e.addOnBlur),b.Eb(1),b.nc("ngIf",!e.isCreateMode&&e.currentItem),b.Eb(1),b.nc("ngIf",e.isCreateMode),b.Eb(2),b.nc("ngIf",!e.isDisplayMode),b.Eb(2),b.nc("data",e.content)("katexOptions",e.mathOptions),b.Eb(2),b.nc("disabled",!(e.isEditable&&e.itemFormGroup.valid)),b.Eb(1),b.Fc(b.jc(43,32,"Save")),b.Eb(3),b.Fc(b.jc(46,34,"Common.ReturnToList")),b.Eb(2),b.nc("disabled",!e.isDisplayMode),b.Eb(1),b.Fc(b.jc(49,36,"Common.CreateAnotherOne"))}},directives:[N.a,N.d,N.g,N.f,N.c,n.u,n.n,n.g,A.c,A.g,Q.b,n.c,n.m,n.e,n.s,n.i,A.f,_.a,i.l,H.c,H.b,i.m,z.c,z.a,c.a,N.b,y.b,W.n,H.a,J.a,H.d,n.p,V.a,a.a],pipes:[r.d,i.e],styles:[".example-form[_ngcontent-%COMP%]{margin:8px;min-width:150px;max-width:500px;width:100%}.mat-card-actions[_ngcontent-%COMP%]{margin-top:50px}"]}),t})();var ot=o("2Vo4"),it=o("nYR2"),nt=o("f0Cb"),at=o("iadO"),ct=o("bSwM"),rt=o("pFkP");function lt(t,e){if(1&t&&(b.Vb(0,"mat-option",25),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t){const t=e.$implicit;b.nc("value",t.value),b.Eb(1),b.Gc(" ",b.jc(2,2,t.displayas)," ")}}function st(t,e){if(1&t&&(b.Vb(0,"mat-option",25),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t){const t=e.$implicit;b.nc("value",t.value),b.Eb(1),b.Gc(" ",b.jc(2,2,t.i18nterm)," ")}}function dt(t,e){if(1&t){const t=b.Wb();b.Vb(0,"mat-form-field"),b.Vb(1,"input",26),b.dc("ngModelChange",function(e){return b.wc(t),b.hc().$implicit.value[0]=e}),b.ic(2,"transloco"),b.Ub(),b.Ub()}if(2&t){const t=b.hc().$implicit;b.Eb(1),b.oc("placeholder",b.jc(2,2,"Value")),b.nc("ngModel",t.value[0])}}function bt(t,e){if(1&t){const t=b.Wb();b.Vb(0,"mat-form-field"),b.Vb(1,"input",27),b.dc("ngModelChange",function(e){return b.wc(t),b.hc().$implicit.value[1]=e}),b.ic(2,"transloco"),b.Ub(),b.Ub()}if(2&t){const t=b.hc().$implicit;b.Eb(1),b.oc("placeholder",b.jc(2,2,"Value")),b.nc("ngModel",t.value[1])}}function mt(t,e){if(1&t){const t=b.Wb();b.Vb(0,"mat-form-field"),b.Vb(1,"input",28),b.dc("ngModelChange",function(e){return b.wc(t),b.hc().$implicit.value[0]=e}),b.ic(2,"transloco"),b.Ub(),b.Ub()}if(2&t){const t=b.hc().$implicit;b.Eb(1),b.oc("placeholder",b.jc(2,2,"Value")),b.nc("ngModel",t.value[0])}}function ut(t,e){if(1&t){const t=b.Wb();b.Vb(0,"mat-form-field"),b.Vb(1,"input",29),b.dc("ngModelChange",function(e){return b.wc(t),b.hc().$implicit.value[0]=e}),b.ic(2,"transloco"),b.Ub(),b.Qb(3,"mat-datepicker-toggle",30),b.Qb(4,"mat-datepicker",null,31),b.Ub()}if(2&t){const t=b.uc(5),e=b.hc().$implicit;b.Eb(1),b.oc("placeholder",b.jc(2,4,"Value")),b.nc("ngModel",e.value[0])("matDatepicker",t),b.Eb(2),b.nc("for",t)}}function ht(t,e){if(1&t){const t=b.Wb();b.Vb(0,"mat-form-field"),b.Vb(1,"input",29),b.dc("ngModelChange",function(e){return b.wc(t),b.hc().$implicit.value[1]=e}),b.ic(2,"transloco"),b.Ub(),b.Qb(3,"mat-datepicker-toggle",30),b.Qb(4,"mat-datepicker",null,32),b.Ub()}if(2&t){const t=b.uc(5),e=b.hc().$implicit;b.Eb(1),b.oc("placeholder",b.jc(2,4,"Value")),b.nc("ngModel",e.value[1])("matDatepicker",t),b.Eb(2),b.nc("for",t)}}function pt(t,e){if(1&t){const t=b.Wb();b.Vb(0,"div",33),b.Vb(1,"mat-checkbox",34),b.dc("ngModelChange",function(e){return b.wc(t),b.hc().$implicit.value[0]=e}),b.Ub(),b.Ub()}if(2&t){const t=b.hc().$implicit;b.Eb(1),b.nc("ngModel",t.value[0])}}function gt(t,e){if(1&t){const t=b.Wb();b.Vb(0,"div",17),b.Vb(1,"mat-form-field"),b.Vb(2,"mat-select",18),b.dc("ngModelChange",function(t){return e.$implicit.fieldName=t})("selectionChange",function(){b.wc(t);const o=e.$implicit;return b.hc().onFieldSelectionChanged(o)}),b.ic(3,"transloco"),b.Dc(4,lt,3,4,"mat-option",19),b.Ub(),b.Ub(),b.Vb(5,"mat-form-field"),b.Vb(6,"mat-select",20),b.dc("ngModelChange",function(t){return e.$implicit.operator=t}),b.ic(7,"transloco"),b.Dc(8,st,3,4,"mat-option",19),b.ic(9,"operatorFilter"),b.Ub(),b.Ub(),b.Dc(10,dt,3,4,"mat-form-field",21),b.Dc(11,bt,3,4,"mat-form-field",21),b.Dc(12,mt,3,4,"mat-form-field",21),b.Dc(13,ut,6,6,"mat-form-field",21),b.Dc(14,ht,6,6,"mat-form-field",21),b.Dc(15,pt,2,1,"div",22),b.Vb(16,"button",23),b.dc("click",function(){return b.wc(t),b.hc().onAddFilter()}),b.Vb(17,"mat-icon"),b.Ec(18,"add"),b.Ub(),b.Ub(),b.Vb(19,"button",24),b.dc("click",function(){b.wc(t);const o=e.index;return b.hc().onRemoveFilter(o)}),b.Vb(20,"mat-icon"),b.Ec(21,"close"),b.Ub(),b.Ub(),b.Ub()}if(2&t){const t=e.$implicit,o=b.hc();b.Eb(2),b.oc("placeholder",b.jc(3,12,"Field")),b.nc("ngModel",t.fieldName),b.Eb(2),b.nc("ngForOf",o.allFields),b.Eb(2),b.oc("placeholder",b.jc(7,14,"Operator")),b.nc("ngModel",t.operator),b.Eb(2),b.nc("ngForOf",b.kc(9,16,o.allOperators,t.valueType)),b.Eb(2),b.nc("ngIf",1===t.valueType),b.Eb(1),b.nc("ngIf",1===t.valueType),b.Eb(1),b.nc("ngIf",2===t.valueType),b.Eb(1),b.nc("ngIf",3===t.valueType),b.Eb(1),b.nc("ngIf",3===t.valueType),b.Eb(1),b.nc("ngIf",4===t.valueType)}}function ft(t,e){1&t&&(b.Vb(0,"th",35),b.Ec(1,"#"),b.Ub())}function vt(t,e){if(1&t){const t=b.Wb();b.Vb(0,"td",36),b.Vb(1,"div"),b.Ec(2),b.Vb(3,"a",37),b.dc("click",function(){b.wc(t);const o=e.$implicit;return b.hc().onDisplayItem(o.ID)}),b.Ec(4),b.ic(5,"transloco"),b.Ub(),b.Ub(),b.Ub()}if(2&t){const t=e.$implicit;b.Eb(2),b.Gc(" ",t.ID," "),b.Eb(2),b.Fc(b.jc(5,2,"Common.Display"))}}function Ct(t,e){1&t&&(b.Vb(0,"th",35),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t&&(b.Eb(1),b.Fc(b.jc(2,1,"Category")))}function Et(t,e){if(1&t&&(b.Vb(0,"td",36),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t){const t=e.$implicit,o=b.hc();b.Eb(1),b.Fc(b.jc(2,1,o.getKnowledgeItemCategoryName(t.ItemCategory)))}}function wt(t,e){1&t&&(b.Vb(0,"th",35),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t&&(b.Eb(1),b.Fc(b.jc(2,1,"Title")))}function Vt(t,e){if(1&t&&(b.Vb(0,"td",36),b.Ec(1),b.Ub()),2&t){const t=e.$implicit;b.Eb(1),b.Fc(t.Title)}}function yt(t,e){1&t&&(b.Vb(0,"th",35),b.Ec(1),b.ic(2,"transloco"),b.Ub()),2&t&&(b.Eb(1),b.Fc(b.jc(2,1,"CreatedAt")))}function Ut(t,e){if(1&t&&(b.Vb(0,"td",36),b.Ec(1),b.ic(2,"date"),b.Ub()),2&t){const t=e.$implicit;b.Eb(1),b.Fc(b.kc(2,1,t.CreatedAt,"yyyy-M-d HH:mm:ss"))}}function Ft(t,e){1&t&&b.Qb(0,"tr",38)}function It(t,e){1&t&&b.Qb(0,"tr",39)}const Mt=[{path:"",component:$},{path:"create",component:et},{path:"display/:id",component:et},{path:"edit/:id",component:et},{path:"search",component:(()=>{class t{constructor(t,e){this.odataService=t,this.router=e,this.filters=[],this.allOperators=[],this.allFields=[],this.filterEditable=!0,this.pageSize=20,this.pageSizeOptions=[20,40,60,100],this.isLoadingResults=!1,this.subjFilters=new ot.a([]),this.displayedColumns=["id","category","title","createdat"],this.dataSource=[],this.resultsLength=0,this.allOperators=E.z.getGeneralFilterOperatorDisplayStrings(),this.allFields=[{displayas:"Content",value:"Content",valueType:2}]}ngOnInit(){this.onAddFilter()}ngAfterViewInit(){this.subjFilters.subscribe(()=>this.paginator.pageIndex=0),Object(h.a)(this.subjFilters,this.paginator.page).pipe(Object(g.a)({}),Object(f.a)(()=>{if(this.subjFilters.value.length<=0)return Object(p.a)([]);this.isLoadingResults=!0;const t=this.prepareFilters(this.subjFilters.value),e=this.paginator.pageSize;return this.odataService.getKnowledgeItems(e,e*this.paginator.pageIndex,void 0,void 0,t)}),Object(it.a)(()=>this.isLoadingResults=!1),Object(v.a)(t=>(this.resultsLength=t.totalCount,t.items)),Object(C.a)(()=>Object(p.a)(void 0))).subscribe({next:t=>this.dataSource=t,error:t=>console.log(t)})}getKnowledgeItemCategoryName(t){return Object(E.C)(t)}onAddFilter(){this.filters.push(new E.j)}onRemoveFilter(t){this.filters.splice(t,1),0===this.filters.length&&this.onAddFilter()}onFieldSelectionChanged(t){this.allFields.forEach(e=>{e.value===t.fieldName&&(t.valueType=e.valueType)})}prepareFilters(t){let e="";return t.sort((t,e)=>t.fieldName.localeCompare(e.fieldName)),t.forEach(t=>{"Content"===t.fieldName&&(t.operator===E.k.Equal?e=e?`${e} and ${t.fieldName} eq '${t.lowValue}'`:`${t.fieldName} eq '${t.lowValue}'`:t.operator===E.k.Like&&(e=e?`${e} and contains(${t.fieldName},'${t.lowValue}')`:`contains(${t.fieldName},'${t.lowValue}')`))}),e}onSearch(){const t=[];this.filters.forEach(e=>{const o={};switch(o.valueType=+e.valueType,e.valueType){case E.l.boolean:case E.l.date:case E.l.number:break;case E.l.string:o.fieldName=e.fieldName,o.operator=+e.operator,o.lowValue=e.value[0],o.highValue=e.operator===E.k.Between?e.value[1]:""}t.push(o)}),this.subjFilters.next(t)}onDisplayItem(t){this.router.navigate(["knowledge-item","display",t.toString()])}onGoToPreview(){const t=[];this.dataSource.forEach(e=>{t.push({refType:E.y.KnowledgeItem,refId:e.ID})}),this.odataService.previewObjList=t,this.router.navigate(["preview"])}}return t.\u0275fac=function(e){return new(e||t)(b.Pb(w.b),b.Pb(d.b))},t.\u0275cmp=b.Jb({type:t,selectors:[["app-knowledge-item-search"]],viewQuery:function(t,e){if(1&t&&b.Jc(m.a,3),2&t){let t;b.tc(t=b.ec())&&(e.paginator=t.first)}},decls:41,vars:18,consts:[["class","demo-full-width",4,"ngFor","ngForOf"],[1,"control-full-width"],["mat-button","","aria-label","Search",3,"click"],[1,"table-container","mat-elevation-z8"],["color","primary"],["mat-flat-button","","color","primary",3,"click"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","category"],["matColumnDef","title"],["matColumnDef","createdat"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],[1,"demo-full-width"],[3,"placeholder","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","ngModelChange"],[4,"ngIf"],["class","typechkbox",4,"ngIf"],["mat-button","","mat-icon-button","","aria-label","Add",3,"click"],["mat-button","","mat-icon-button","","aria-label","Clear",3,"click"],[3,"value"],["matInput","","type","number","name","lvalue_1",3,"placeholder","ngModel","ngModelChange"],["matInput","","type","number","name","hvalue_1",3,"placeholder","ngModel","ngModelChange"],["matInput","","type","text","name","lvalue_2",3,"placeholder","ngModel","ngModelChange"],["matInput","",3,"ngModel","matDatepicker","placeholder","ngModelChange"],["matSuffix","",3,"for"],["lvpicker",""],["hvpicker",""],[1,"typechkbox"],[3,"ngModel","ngModelChange"],["mat-header-cell",""],["mat-cell",""],["mat-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(b.Vb(0,"mat-card"),b.Vb(1,"mat-card-header"),b.Vb(2,"mat-card-title"),b.Ec(3),b.ic(4,"transloco"),b.Ub(),b.Vb(5,"mat-card-subtitle"),b.Ec(6),b.ic(7,"transloco"),b.Ub(),b.Ub(),b.Vb(8,"mat-card-content"),b.Vb(9,"div"),b.Dc(10,gt,22,19,"div",0),b.Vb(11,"div",1),b.Vb(12,"button",2),b.dc("click",function(){return e.onSearch()}),b.Vb(13,"mat-icon"),b.Ec(14,"search"),b.Ub(),b.Ec(15),b.ic(16,"transloco"),b.Ub(),b.Ub(),b.Ub(),b.Qb(17,"mat-divider"),b.Vb(18,"div",3),b.Vb(19,"mat-toolbar",4),b.Vb(20,"mat-toolbar-row"),b.Vb(21,"button",5),b.dc("click",function(){return e.onGoToPreview()}),b.Ec(22),b.ic(23,"transloco"),b.Ub(),b.Ub(),b.Ub(),b.Vb(24,"div",6),b.Vb(25,"table",7),b.Tb(26,8),b.Dc(27,ft,2,0,"th",9),b.Dc(28,vt,6,4,"td",10),b.Sb(),b.Tb(29,11),b.Dc(30,Ct,3,3,"th",9),b.Dc(31,Et,3,3,"td",10),b.Sb(),b.Tb(32,12),b.Dc(33,wt,3,3,"th",9),b.Dc(34,Vt,2,1,"td",10),b.Sb(),b.Tb(35,13),b.Dc(36,yt,3,3,"th",9),b.Dc(37,Ut,3,4,"td",10),b.Sb(),b.Dc(38,Ft,1,0,"tr",14),b.Dc(39,It,1,0,"tr",15),b.Ub(),b.Ub(),b.Qb(40,"mat-paginator",16),b.Ub(),b.Ub(),b.Ub()),2&t&&(b.Eb(3),b.Fc(b.jc(4,10,"KnowledgeItem")),b.Eb(3),b.Fc(b.jc(7,12,"Common.Search")),b.Eb(4),b.nc("ngForOf",e.filters),b.Eb(5),b.Gc(" ",b.jc(16,14,"Common.Search")," "),b.Eb(7),b.Fc(b.jc(23,16,"Common.Preview")),b.Eb(3),b.nc("dataSource",e.dataSource),b.Eb(13),b.nc("matHeaderRowDef",e.displayedColumns),b.Eb(1),b.nc("matRowDefColumns",e.displayedColumns),b.Eb(1),b.nc("length",e.resultsLength)("pageSize",20))},directives:[N.a,N.d,N.g,N.f,N.c,i.l,y.b,J.a,nt.a,V.a,V.c,U.j,U.c,U.e,U.b,U.g,U.i,m.a,A.c,_.a,n.m,n.p,i.m,W.n,Q.b,n.q,n.c,at.d,at.f,A.i,at.c,ct.a,U.d,U.a,y.a,U.f,U.h],pipes:[r.d,rt.a,i.e],styles:[".table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;margin-top:16px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.data-loading-shade[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.mat-column-id[_ngcontent-%COMP%]{max-width:300px;width:250px}.mat-column-itemtype[_ngcontent-%COMP%]{max-width:120px;width:120px}.mat-column-tags[_ngcontent-%COMP%]{max-width:250px;width:150px}.mat-column-created[_ngcontent-%COMP%]{max-width:120px;width:120px}"]}),t})()}];let Dt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.Nb({type:t}),t.\u0275inj=b.Mb({imports:[[d.d.forChild(Mt)],d.d]}),t})();var xt=o("iasb");let jt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.Nb({type:t}),t.\u0275inj=b.Mb({providers:[],imports:[[i.c,n.h,n.r,l.a,s.a,a.b,c.b.forChild(),Dt,r.c,xt.a]]}),t})()}}]);