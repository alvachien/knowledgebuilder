"use strict";(self.webpackChunkknowledgebuilder=self.webpackChunkknowledgebuilder||[]).push([[90],{90:(Ro,E,s)=>{s.r(E),s.d(E,{HabitBuilderModule:()=>L});var g=s(6895),n=s(4006),T=s(1525),ht=s(6127),Ct=s(558),j=s(2054),M=s(9132),t=s(4650),Q=s(8739),U=s(6308),ft=s(5439),b=s.n(ft),V=s(6451),K=s(9646),z=s(8675),X=s(3900),W=s(8746),tt=s(4004),et=s(262),c=s(2701),u=s(410),A=s(5938),x=s(4859),G=s(7392),l=s(3626),S=s(3683),B=s(266);function gt(o,e){1&o&&(t.TgZ(0,"th",18),t._uU(1,"#"),t.qZA())}function bt(o,e){if(1&o){const i=t.EpF();t.TgZ(0,"td",19),t._uU(1),t.TgZ(2,"button",1),t.NdJ("click",function(){const m=t.CHM(i).$implicit,p=t.oxw();return t.KtG(p.onDisplayHabit(m.ID))}),t.ALo(3,"transloco"),t.TgZ(4,"mat-icon"),t._uU(5,"launch"),t.qZA()(),t.TgZ(6,"button",20),t.NdJ("click",function(){const m=t.CHM(i).$implicit,p=t.oxw();return t.KtG(p.onDeleteHabit(m.ID))}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"remove_circle"),t.qZA()()()}if(2&o){const i=e.$implicit;t.xp6(1),t.hij("",i.ID," | "),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,3,"Common.Display")),t.xp6(4),t.s9C("matTooltip",t.lcZ(7,5,"Common.Delete"))}}function Zt(o,e){1&o&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function Tt(o,e){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&o){const i=e.$implicit,a=t.oxw();t.xp6(1),t.AsE("",a.getUserDisplayAs(i.targetUser)," (",i.targetUser,")")}}function At(o,e){1&o&&(t.TgZ(0,"th",21),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Name")))}function xt(o,e){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.name)}}function Ut(o,e){1&o&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Type")))}function qt(o,e){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o){const i=e.$implicit,a=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,a.getHabitCategoryName(i.category)))}}function Ht(o,e){1&o&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.Frequency")))}function vt(o,e){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o){const i=e.$implicit,a=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,a.getHabitFrequencyName(i.frequency)))}}function Dt(o,e){1&o&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.CompleteCategory")))}function yt(o,e){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o){const i=e.$implicit,a=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,a.getHabitCompleteCategoryName(i.completeCategory)))}}function wt(o,e){1&o&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Validity")))}function Ot(o,e){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.validity)}}function Lt(o,e){1&o&&t._UZ(0,"tr",22)}function Nt(o,e){1&o&&t._UZ(0,"tr",23)}class q{constructor(e,i,a,r){this.odataSrv=e,this.dialog=i,this.authService=a,this.uiUtilSrv=r,this.dataSource=[],this.displayedColumns=["id","targetUser","name","category","frequency","compCategory","validity"],this.recordCount=0,this.isLoadingResults=!1,this.refreshEvent=new t.vpe}ngOnInit(){this.refreshList()}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,V.T)(this.sort.sortChange,this.paginator.page,this.refreshEvent).pipe((0,z.O)({}),(0,X.w)(()=>{const e=this.paginator.pageSize,i=e*this.paginator.pageIndex,a=b()().format(c.Jt);return this.odataSrv.getUserHabits(e,i,this.sort.active,this.sort.direction,`ValidFrom le ${a} and ValidTo ge ${a}`)}),(0,W.x)(()=>this.isLoadingResults=!1),(0,tt.U)(e=>(this.recordCount=e.totalCount,e.items)),(0,et.K)(()=>(0,K.of)([]))).subscribe({next:e=>this.dataSource=e,error:e=>this.uiUtilSrv.showSnackInfo(e)})}getHabitCategoryName(e){return(0,c.xk)(e)}getHabitCompleteCategoryName(e){return(0,c.E0)(e)}getHabitFrequencyName(e){return(0,c.lC)(e)}getUserDisplayAs(e){if(e&&this.authService.userDetail){const i=this.authService.userDetail.awardUsers.findIndex(a=>a.targetUser===e);if(-1!==i)return this.authService.userDetail.awardUsers[i].displayAs}return""}onCreateHabit(){this.uiUtilSrv.navigateHabitCreatePage()}resetPaging(){this.paginator.pageIndex=0}refreshList(){this.refreshEvent.emit()}onDeleteHabit(e){this.odataSrv.deleteUserHabit(e).subscribe({next:()=>{this.refreshList()},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})}onDisplayHabit(e){this.uiUtilSrv.navigateHabitDisplayPage(e)}}q.\u0275fac=function(e){return new(e||q)(t.Y36(u.CB),t.Y36(A.uw),t.Y36(u.e8),t.Y36(u.dM))},q.\u0275cmp=t.Xpm({type:q,selectors:[["app-habit-list"]],viewQuery:function(e,i){if(1&e&&(t.Gf(Q.NW,5),t.Gf(U.YE,5)),2&e){let a;t.iGM(a=t.CRH())&&(i.paginator=a.first),t.iGM(a=t.CRH())&&(i.sort=a.first)}},decls:36,vars:11,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary",3,"matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","targetUser"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","category"],["matColumnDef","frequency"],["matColumnDef","compCategory"],["matColumnDef","validity"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","warn",3,"matTooltip","click"],["mat-header-cell","","mat-sort-header",""],["mat-header-row",""],["mat-row",""]],template:function(e,i){1&e&&(t.TgZ(0,"mat-toolbar")(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.TgZ(5,"button",1),t.NdJ("click",function(){return i.onCreateHabit()}),t.ALo(6,"transloco"),t.TgZ(7,"mat-icon"),t._uU(8,"add_circle"),t.qZA()()(),t.TgZ(9,"div",2)(10,"div",3)(11,"table",4),t.NdJ("matSortChange",function(){return i.resetPaging()}),t.ynx(12,5),t.YNc(13,gt,2,0,"th",6),t.YNc(14,bt,10,7,"td",7),t.BQk(),t.ynx(15,8),t.YNc(16,Zt,3,3,"th",6),t.YNc(17,Tt,2,2,"td",7),t.BQk(),t.ynx(18,9),t.YNc(19,At,3,3,"th",10),t.YNc(20,xt,2,1,"td",7),t.BQk(),t.ynx(21,11),t.YNc(22,Ut,3,3,"th",6),t.YNc(23,qt,3,3,"td",7),t.BQk(),t.ynx(24,12),t.YNc(25,Ht,3,3,"th",6),t.YNc(26,vt,3,3,"td",7),t.BQk(),t.ynx(27,13),t.YNc(28,Dt,3,3,"th",6),t.YNc(29,yt,3,3,"td",7),t.BQk(),t.ynx(30,14),t.YNc(31,wt,3,3,"th",6),t.YNc(32,Ot,2,1,"td",7),t.BQk(),t.YNc(33,Lt,1,0,"tr",15),t.YNc(34,Nt,1,0,"tr",16),t.qZA()(),t._UZ(35,"mat-paginator",17),t.qZA()),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,7,"Habit.Habits")),t.xp6(3),t.s9C("matTooltip",t.lcZ(6,9,"Common.Create")),t.xp6(6),t.Q6J("dataSource",i.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.recordCount)("pageSize",20))},dependencies:[x.RK,G.Hw,Q.NW,U.YE,U.nU,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,S.Ye,B.gM,T.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}"]});var h=s(3778),H=s(3238),C=s(3546),d=s(9602),R=s(4144),_=s(9549),v=s(4385);function St(o,e){if(1&o&&(t.TgZ(0,"mat-option",28),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.Q6J("value",i.targetUser),t.xp6(1),t.Oqu(i.displayAs)}}function Rt(o,e){if(1&o&&(t.TgZ(0,"mat-option",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o){const i=e.$implicit;t.Q6J("value",i.value),t.xp6(1),t.Oqu(t.lcZ(2,2,i.i18nterm))}}function kt(o,e){if(1&o&&(t.TgZ(0,"mat-option",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o){const i=e.$implicit;t.Q6J("value",i.value),t.xp6(1),t.hij("",t.lcZ(2,2,i.i18nterm)," ")}}function Pt(o,e){1&o&&(t.TgZ(0,"th",29),t._uU(1,"#"),t.qZA())}function Ft(o,e){if(1&o&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.ruleID)}}function Yt(o,e){1&o&&(t.TgZ(0,"th",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.ContinuousCompletedCounts")))}function Mt(o,e){if(1&o&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.continuousCompletedCounts)}}function Qt(o,e){1&o&&(t.TgZ(0,"th",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function Jt(o,e){if(1&o&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.point)}}function It(o,e){1&o&&t._UZ(0,"tr",31)}function Gt(o,e){1&o&&t._UZ(0,"tr",32)}class D{constructor(e,i,a,r,m){this.activateRoute=e,this._formBuilder=i,this.uiUtilSrv=a,this.authService=r,this.odataSrv=m,this.routerID=-1,this.uiMode=h.sk.Display,this.currentMode="Common.Display",this.arCategories=[],this.arFrequencies=[],this.arCompleteCategories=[],this.currentObject=new c.ke,this.displayedColumns=["ruleID","completedCountRange","point"],this.arCategories=(0,c.ZP)(),this.arFrequencies=(0,c.AX)(),this.arCompleteCategories=(0,c.nX)(),this.detailFormGroup=this._formBuilder.group({targetuserCtrl:["",n.kI.required],nameCtrl:["",n.kI.required],ctgyCtrl:[c.cb.Positive,n.kI.required],validFromCtrl:[void 0,n.kI.required],validToCtrl:[void 0,n.kI.required],freqCtrl:[c.Hs.Daily,n.kI.required],compCtgyCtrl:[c.Kd.NumberOfTimes,n.kI.required],compCondCtrl:[0],startDateCtrl:[void 0]})}get arTargetUsers(){return this.authService.userDetail?this.authService.userDetail.awardUsers:[]}getUserDisplayAs(e){if(e&&this.authService.userDetail){const i=this.authService.userDetail.awardUsers.findIndex(a=>a.targetUser===e);if(-1!==i)return this.authService.userDetail.awardUsers[i].displayAs}return""}get isDisplayMode(){return this.uiMode===h.sk.Display}get isUpdateMode(){return this.uiMode===h.sk.Update}get isEditable(){return this.uiMode===h.sk.Update}ngOnInit(){this.activateRoute.url.subscribe({next:e=>{e instanceof Array&&e.length>0&&("display"===e[0].path?(this.uiMode=h.sk.Display,this.currentMode="Common.Display",this.routerID=+e[1].path):"edit"===e[0].path&&(this.uiMode=h.sk.Update,this.currentMode="Common.Change",this.routerID=+e[1].path)),-1!==this.routerID&&this.odataSrv.readUserHabit(this.routerID).subscribe({next:i=>{this.currentObject=i,this.detailFormGroup.get("targetuserCtrl")?.setValue(this.currentObject.targetUser),this.detailFormGroup.get("nameCtrl")?.setValue(this.currentObject.name),this.detailFormGroup.get("validFromCtrl")?.setValue(this.currentObject.validFrom),this.detailFormGroup.get("validToCtrl")?.setValue(this.currentObject.validTo),this.detailFormGroup.get("freqCtrl")?.setValue(this.currentObject.frequency),this.detailFormGroup.get("compCtgyCtrl")?.setValue(this.currentObject.completeCategory),this.detailFormGroup.get("compCondCtrl")?.setValue(this.currentObject.completeCondition),this.detailFormGroup.get("startDateCtrl")?.setValue(this.currentObject.startDate),this.uiMode===h.sk.Display?this.detailFormGroup.disable():(this.detailFormGroup.enable(),this.detailFormGroup.markAsPristine())},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})},error:e=>{this.uiUtilSrv.showSnackInfo(e)}})}onSave(){}onBackToList(){this.uiUtilSrv.navigateHabitListPage()}}D.\u0275fac=function(e){return new(e||D)(t.Y36(M.gz),t.Y36(n.QS),t.Y36(u.dM),t.Y36(u.e8),t.Y36(u.CB))},D.\u0275cmp=t.Xpm({type:D,selectors:[["app-habit-detail"]],decls:74,vars:43,consts:[["appearance","outlined"],[3,"formGroup"],["appearance","fill",1,"control-full-width"],["required","","formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["matInput","","required","","formControlName","nameCtrl"],["appearance","fill"],[3,"rangePicker"],["matStartDate","","formControlName","validFromCtrl","placeholder","Start date"],["matEndDate","","formControlName","validToCtrl","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],["required","","formControlName","freqCtrl"],["required","","formControlName","compCtgyCtrl"],["matInput","","required","","type","number","formControlName","compCondCtrl"],["matInput","","required","","type","number","formControlName","startDateCtrl"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","ruleID"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","completedCountRange"],["matColumnDef","point"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","","color","primary",3,"disabled","click"],["mat-button","",3,"click"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,i){if(1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.ALo(7,"transloco"),t.qZA()(),t.TgZ(8,"mat-card-content")(9,"form",1)(10,"mat-form-field",2)(11,"mat-label"),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"mat-select",3),t.YNc(15,St,2,2,"mat-option",4),t.qZA()(),t.TgZ(16,"mat-form-field",2)(17,"mat-label"),t._uU(18),t.ALo(19,"transloco"),t.qZA(),t._UZ(20,"input",5),t.qZA(),t.TgZ(21,"mat-form-field",6)(22,"mat-label"),t._uU(23),t.ALo(24,"transloco"),t.qZA(),t.TgZ(25,"mat-date-range-input",7),t._UZ(26,"input",8)(27,"input",9),t.qZA(),t._UZ(28,"mat-datepicker-toggle",10)(29,"mat-date-range-picker",null,11),t.qZA(),t.TgZ(31,"mat-form-field",2)(32,"mat-label"),t._uU(33),t.ALo(34,"transloco"),t.qZA(),t.TgZ(35,"mat-select",12),t.YNc(36,Rt,3,4,"mat-option",4),t.qZA()(),t.TgZ(37,"mat-form-field",2)(38,"mat-label"),t._uU(39),t.ALo(40,"transloco"),t.qZA(),t.TgZ(41,"mat-select",13),t.YNc(42,kt,3,4,"mat-option",4),t.qZA()(),t.TgZ(43,"mat-form-field",2)(44,"mat-label"),t._uU(45),t.ALo(46,"transloco"),t.qZA(),t._UZ(47,"input",14),t.qZA(),t.TgZ(48,"mat-form-field",2)(49,"mat-label"),t._uU(50),t.ALo(51,"transloco"),t.qZA(),t._UZ(52,"input",15),t.qZA()(),t.TgZ(53,"div",16)(54,"div",17)(55,"table",18),t.ynx(56,19),t.YNc(57,Pt,2,0,"th",20),t.YNc(58,Ft,2,1,"td",21),t.BQk(),t.ynx(59,22),t.YNc(60,Yt,3,3,"th",20),t.YNc(61,Mt,2,1,"td",21),t.BQk(),t.ynx(62,23),t.YNc(63,Qt,3,3,"th",20),t.YNc(64,Jt,2,1,"td",21),t.BQk(),t.YNc(65,It,1,0,"tr",24),t.YNc(66,Gt,1,0,"tr",25),t.qZA()()()(),t.TgZ(67,"mat-card-actions")(68,"button",26),t.NdJ("click",function(){return i.onSave()}),t._uU(69),t.ALo(70,"transloco"),t.qZA(),t.TgZ(71,"button",27),t.NdJ("click",function(){return i.onBackToList()}),t._uU(72),t.ALo(73,"transloco"),t.qZA()()()),2&e){const a=t.MAs(30);t.xp6(3),t.Oqu(t.lcZ(4,21,"Habit.Habit")),t.xp6(3),t.Oqu(t.lcZ(7,23,i.currentMode)),t.xp6(3),t.Q6J("formGroup",i.detailFormGroup),t.xp6(3),t.Oqu(t.lcZ(13,25,"Award.TargetUser")),t.xp6(3),t.Q6J("ngForOf",i.arTargetUsers),t.xp6(3),t.Oqu(t.lcZ(19,27,"Common.Name")),t.xp6(5),t.Oqu(t.lcZ(24,29,"Award.Validity")),t.xp6(2),t.Q6J("rangePicker",a),t.xp6(3),t.Q6J("for",a),t.xp6(5),t.Oqu(t.lcZ(34,31,"Habit.Frequency")),t.xp6(3),t.Q6J("ngForOf",i.arFrequencies),t.xp6(3),t.Oqu(t.lcZ(40,33,"Habit.CompleteCategory")),t.xp6(3),t.Q6J("ngForOf",i.arCompleteCategories),t.xp6(3),t.Oqu(t.lcZ(46,35,"Habit.CompleteCondition")),t.xp6(5),t.Oqu(t.lcZ(51,37,"Habit.StartDate")),t.xp6(5),t.Q6J("dataSource",i.currentObject.arRules),t.xp6(10),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(2),t.Q6J("disabled",i.isDisplayMode),t.xp6(1),t.Oqu(t.lcZ(70,39,"Common.Save")),t.xp6(3),t.Oqu(t.lcZ(73,41,"Common.ReturnToList"))}},dependencies:[g.sg,n._Y,n.Fj,n.wV,n.JJ,n.JL,n.Q7,n.sg,n.u,H.ey,x.lW,C.a8,C.hq,C.dn,C.dk,C.$j,C.n5,d.nW,d.wx,d.zY,d.By,d._g,R.Nt,_.KE,_.hX,_.R9,v.gD,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,T.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:200px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}"]});var Z=s(8425),ot=s(6338);function Bt(o,e){1&o&&(t._uU(0),t.ALo(1,"transloco")),2&o&&t.Oqu(t.lcZ(1,1,"Habit.Habit"))}function $t(o,e){if(1&o&&(t.TgZ(0,"mat-option",38),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.Q6J("value",i.targetUser),t.xp6(1),t.Oqu(i.displayAs)}}function Et(o,e){if(1&o&&(t.TgZ(0,"mat-option",38),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o){const i=e.$implicit;t.Q6J("value",i.value),t.xp6(1),t.Oqu(t.lcZ(2,2,i.i18nterm))}}function jt(o,e){if(1&o&&(t.TgZ(0,"mat-option",38),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o){const i=e.$implicit;t.Q6J("value",i.value),t.xp6(1),t.hij("",t.lcZ(2,2,i.i18nterm)," ")}}function Vt(o,e){1&o&&(t._uU(0),t.ALo(1,"transloco")),2&o&&t.Oqu(t.lcZ(1,1,"Habit.ContinuousCompletedCounts"))}function Kt(o,e){if(1&o&&(t.TgZ(0,"mat-list",39)(1,"mat-list-item"),t._uU(2),t.qZA()()),2&o){const i=e.$implicit;t.xp6(2),t.Oqu(i.toString())}}function zt(o,e){1&o&&(t._uU(0),t.ALo(1,"transloco")),2&o&&t.Oqu(t.lcZ(1,1,"Award.Point"))}function Xt(o,e){1&o&&(t.TgZ(0,"th",40),t._uU(1,"ID"),t.qZA())}function Wt(o,e){if(1&o&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.ruleID)}}function te(o,e){1&o&&(t.TgZ(0,"th",40),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.ContinuousDays")))}function ee(o,e){if(1&o&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.continuousDays)}}function oe(o,e){1&o&&(t.TgZ(0,"th",40),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function ie(o,e){if(1&o){const i=t.EpF();t.TgZ(0,"td",41)(1,"mat-form-field",42)(2,"input",43),t.NdJ("ngModelChange",function(r){const p=t.CHM(i).$implicit;return t.KtG(p.point=r)})("ngModelChange",function(r){t.CHM(i);const m=t.oxw();return t.KtG(m.onPointCellChanged(r))}),t.qZA()()()}if(2&o){const i=e.$implicit;t.xp6(2),t.Q6J("ngModel",i.point)}}function ae(o,e){1&o&&t._UZ(0,"tr",44)}function ne(o,e){1&o&&t._UZ(0,"tr",45)}function re(o,e){1&o&&(t._uU(0),t.ALo(1,"transloco")),2&o&&t.Oqu(t.lcZ(1,1,"Common.Done"))}class it{constructor(){this.from=0,this.to=0}toString(){return`[${this.from} - ${this.to})`}}const at=o=>{const e=new c.ke;switch(e.category=c.cb.Positive,e.targetUser=o.get("targetuserCtrl")?.value,e.validFrom=b()(o.get("validFromCtrl")?.value),e.validTo=b()(o.get("validToCtrl")?.value),e.name=o.get("nameCtrl")?.value,e.frequency=o.get("freqCtrl")?.value,e.completeCategory=o.get("compCtgyCtrl")?.value,e.frequency){case c.Hs.Weekly:case c.Hs.Monthly:e.startDate=o.get("startDateCtrl")?.value,e.completeCondition=o.get("compCondCtrl")?.value;break;default:e.completeCategory===c.Kd.NumberOfCount?(e.startDate=void 0,e.completeCondition=o.get("compCondCtrl")?.value):(e.startDate=void 0,e.completeCondition=1)}return e},le=o=>at(o).isValid?null:{invalidInputs:!0};class k{constructor(e,i,a,r){this._formBuilder=e,this.uiUtilSrv=i,this.authService=a,this.odataSrv=r,this.arRuleTypes=[],this.contDays=[],this.arRules=[],this.displayedColumns=["ruleID","continuousDays","point"],this.pointCompleted=!1,this.createdHabitID=-1,this.arCategories=[],this.arFrequencies=[],this.arCompleteCategories=[],this.arCategories=(0,c.ZP)(),this.arFrequencies=(0,c.AX)(),this.arCompleteCategories=(0,c.nX)(),this.currentObject=new c.ke,this.firstFormGroup=this._formBuilder.group({targetuserCtrl:new n.p4(""),nameCtrl:new n.p4("",n.kI.required),validFromCtrl:new n.p4(b()(),n.kI.required),validToCtrl:new n.p4(b()(),n.kI.required),freqCtrl:new n.p4(c.Hs.Weekly,n.kI.required),compCtgyCtrl:new n.p4(c.Kd.NumberOfTimes,n.kI.required),compCondCtrl:new n.p4,startDateCtrl:new n.p4},{validators:le}),this.secondFormGroup=this._formBuilder.group({rawCtrl:new n.p4("",n.kI.required)})}get arTargetUsers(){return this.authService.userDetail?this.authService.userDetail.awardUsers:[]}getUserDisplayAs(e){if(e&&this.authService.userDetail){const i=this.authService.userDetail.awardUsers.findIndex(a=>a.targetUser===e);if(-1!==i)return this.authService.userDetail.awardUsers[i].displayAs}return""}ngOnInit(){this.firstFormGroup.get("freqCtrl")?.valueChanges.subscribe(e=>{this.onFreqencyAndCompleteCategoryChange(e)}),this.firstFormGroup.get("compCtgyCtrl")?.valueChanges.subscribe(e=>{this.onFreqencyAndCompleteCategoryChange(e)}),this.secondFormGroup.get("rawCtrl")?.valueChanges.subscribe(e=>{this.onContDayChange(e)})}onFreqencyAndCompleteCategoryChange(e){const i=this.firstFormGroup.get("compCtgyCtrl")?.value;this.firstFormGroup.get("freqCtrl")?.value===c.Hs.Daily?(i===c.Kd.NumberOfTimes?this.firstFormGroup.get("compCondCtrl")?.disable():this.firstFormGroup.get("compCondCtrl")?.enable(),this.firstFormGroup.get("startDateCtrl")?.disable()):(this.firstFormGroup.get("compCondCtrl")?.enable(),this.firstFormGroup.get("startDateCtrl")?.enable())}onContDayChange(e){if(this.contDays=[],e){let a=e.split(";").map(p=>{if(p){const f=+p;if(!isNaN(f)&&f>0)return Math.trunc(f)}return 0});a=a.filter(p=>p>0),a.sort();let r=0;a.forEach(p=>{if(0!==r){const f=new it;f.from=r,f.to=p,this.contDays.push(f)}r=p});const m=new it;m.from=r,m.to=9999,this.contDays.push(m)}}onPointCellChanged(e){let i=0;this.arRules.forEach(a=>{(isNaN(a.point)||0===a.point)&&i++}),this.pointCompleted=0===i}onInitialRules(){this.arRules=[],this.contDays.forEach((e,i)=>{const a=new c.hp;a.ruleID=i+1,a.continuousRecordFrom=e.from,a.continuousRecordTo=e.to,this.arRules.push(a)})}onSave(){const e=at(this.firstFormGroup);e.isValid&&(this.arRules.forEach(i=>{e.arRules.push(i)}),this.odataSrv.createUserHabit(e).subscribe({next:i=>{i&&i.ID&&(this.createdHabitID=i.ID)},error:i=>{this.uiUtilSrv.showSnackInfo(i,1e3)}}))}onGoToList(){this.uiUtilSrv.navigateHabitListPage()}onDisplayHabit(){this.createdHabitID&&this.uiUtilSrv.navigateHabitDisplayPage(this.createdHabitID)}}k.\u0275fac=function(e){return new(e||k)(t.Y36(n.QS),t.Y36(u.dM),t.Y36(u.e8),t.Y36(u.CB))},k.\u0275cmp=t.Xpm({type:k,selectors:[["app-habit-create"]],decls:126,vars:86,consts:[[1,"toolbar-spacer"],["linear",""],["stepper",""],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],["appearance","fill",1,"control-full-width"],["formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["matInput","","required","","formControlName","nameCtrl"],["appearance","fill"],[3,"rangePicker"],["matStartDate","","formControlName","validFromCtrl","placeholder","Start date"],["matEndDate","","formControlName","validToCtrl","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],["required","","formControlName","freqCtrl"],["required","","formControlName","compCtgyCtrl"],["matInput","","type","number","formControlName","compCondCtrl"],["matInput","","type","number","formControlName","startDateCtrl"],["mat-button","","color","primary","matStepperNext","",3,"disabled"],["matInput","","formControlName","rawCtrl"],["dense","",4,"ngFor","ngForOf"],["mat-button","","matStepperPrevious",""],["mat-button","","color","primary","matStepperNext","",3,"click"],[3,"completed"],["mat-raised-button","","disabled",""],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","ruleID"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","continuousDays"],["matColumnDef","point"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","","color","primary","matStepperNext","",3,"disabled","click"],["mat-button","",3,"click"],["mat-button","","color","warn",3,"click"],[3,"value"],["dense",""],["mat-header-cell",""],["mat-cell",""],[1,"control-full-width"],["matInput","","type","number",1,"input-point",3,"ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""]],template:function(e,i){if(1&e){const a=t.EpF();t.TgZ(0,"mat-toolbar")(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.TgZ(5,"h3"),t._uU(6),t.ALo(7,"transloco"),t.qZA()(),t.TgZ(8,"mat-vertical-stepper",1,2)(10,"mat-step",3)(11,"form",4),t.YNc(12,Bt,2,3,"ng-template",5),t.TgZ(13,"mat-form-field",6)(14,"mat-label"),t._uU(15),t.ALo(16,"transloco"),t.qZA(),t.TgZ(17,"mat-select",7),t.YNc(18,$t,2,2,"mat-option",8),t.qZA()(),t.TgZ(19,"mat-form-field",6)(20,"mat-label"),t._uU(21),t.ALo(22,"transloco"),t.qZA(),t._UZ(23,"input",9),t.qZA(),t.TgZ(24,"mat-form-field",10)(25,"mat-label"),t._uU(26),t.ALo(27,"transloco"),t.qZA(),t.TgZ(28,"mat-date-range-input",11),t._UZ(29,"input",12)(30,"input",13),t.qZA(),t._UZ(31,"mat-datepicker-toggle",14)(32,"mat-date-range-picker",null,15),t.qZA(),t.TgZ(34,"mat-form-field",6)(35,"mat-label"),t._uU(36),t.ALo(37,"transloco"),t.qZA(),t.TgZ(38,"mat-select",16),t.YNc(39,Et,3,4,"mat-option",8),t.qZA(),t.TgZ(40,"mat-hint"),t._uU(41),t.ALo(42,"transloco"),t.qZA()(),t.TgZ(43,"mat-form-field",6)(44,"mat-label"),t._uU(45),t.ALo(46,"transloco"),t.qZA(),t.TgZ(47,"mat-select",17),t.YNc(48,jt,3,4,"mat-option",8),t.qZA(),t.TgZ(49,"mat-hint"),t._uU(50),t.ALo(51,"transloco"),t.qZA()(),t.TgZ(52,"mat-form-field",6)(53,"mat-label"),t._uU(54),t.ALo(55,"transloco"),t.qZA(),t._UZ(56,"input",18),t.TgZ(57,"mat-hint"),t._uU(58),t.ALo(59,"transloco"),t.qZA()(),t.TgZ(60,"mat-form-field",6)(61,"mat-label"),t._uU(62),t.ALo(63,"transloco"),t.qZA(),t._UZ(64,"input",19),t.TgZ(65,"mat-hint"),t._uU(66),t.ALo(67,"transloco"),t.qZA()()(),t.TgZ(68,"div")(69,"button",20),t._uU(70),t.ALo(71,"transloco"),t.qZA()()(),t.TgZ(72,"mat-step",3)(73,"form",4),t.YNc(74,Vt,2,3,"ng-template",5),t.TgZ(75,"mat-form-field",6)(76,"mat-label"),t._uU(77),t.ALo(78,"transloco"),t.qZA(),t._UZ(79,"input",21),t.qZA()(),t.YNc(80,Kt,3,1,"mat-list",22),t.TgZ(81,"div")(82,"button",23),t._uU(83),t.ALo(84,"transloco"),t.qZA(),t.TgZ(85,"button",24),t.NdJ("click",function(){return i.onInitialRules()}),t._uU(86),t.ALo(87,"transloco"),t.qZA()()(),t.TgZ(88,"mat-step",25),t.YNc(89,zt,2,3,"ng-template",5),t.TgZ(90,"mat-toolbar")(91,"button",26),t._uU(92,"RESET RULES"),t.qZA()(),t.TgZ(93,"table",27),t.ynx(94,28),t.YNc(95,Xt,2,0,"th",29),t.YNc(96,Wt,2,1,"td",30),t.BQk(),t.ynx(97,31),t.YNc(98,te,3,3,"th",29),t.YNc(99,ee,2,1,"td",30),t.BQk(),t.ynx(100,32),t.YNc(101,oe,3,3,"th",29),t.YNc(102,ie,3,1,"td",30),t.BQk(),t.YNc(103,ae,1,0,"tr",33),t.YNc(104,ne,1,0,"tr",34),t.qZA(),t.TgZ(105,"button",23),t._uU(106),t.ALo(107,"transloco"),t.qZA(),t.TgZ(108,"button",35),t.NdJ("click",function(){return i.onSave()}),t._uU(109),t.ALo(110,"transloco"),t.qZA()(),t.TgZ(111,"mat-step"),t.YNc(112,re,2,3,"ng-template",5),t.TgZ(113,"p"),t._uU(114),t.ALo(115,"transloco"),t.qZA(),t.TgZ(116,"p"),t._uU(117),t.ALo(118,"transloco"),t.qZA(),t.TgZ(119,"div")(120,"button",36),t.NdJ("click",function(){return i.onDisplayHabit()}),t._uU(121),t.ALo(122,"transloco"),t.qZA(),t.TgZ(123,"button",37),t.NdJ("click",function(){t.CHM(a);const m=t.MAs(9);return t.KtG(m.reset())}),t._uU(124),t.ALo(125,"transloco"),t.qZA()()()()}if(2&e){const a=t.MAs(33);t.xp6(2),t.Oqu(t.lcZ(3,40,"Habit.Habit")),t.xp6(4),t.Oqu(t.lcZ(7,42,"Common.Create")),t.xp6(4),t.Q6J("stepControl",i.firstFormGroup),t.xp6(1),t.Q6J("formGroup",i.firstFormGroup),t.xp6(4),t.Oqu(t.lcZ(16,44,"Award.TargetUser")),t.xp6(3),t.Q6J("ngForOf",i.arTargetUsers),t.xp6(3),t.Oqu(t.lcZ(22,46,"Common.Name")),t.xp6(5),t.Oqu(t.lcZ(27,48,"Award.Validity")),t.xp6(2),t.Q6J("rangePicker",a),t.xp6(3),t.Q6J("for",a),t.xp6(5),t.Oqu(t.lcZ(37,50,"Habit.Frequency")),t.xp6(3),t.Q6J("ngForOf",i.arFrequencies),t.xp6(2),t.Oqu(t.lcZ(42,52,"Habit.FrequencyHint")),t.xp6(4),t.Oqu(t.lcZ(46,54,"Habit.CompleteCategory")),t.xp6(3),t.Q6J("ngForOf",i.arCompleteCategories),t.xp6(2),t.Oqu(t.lcZ(51,56,"Habit.CompleteCategoryHint")),t.xp6(4),t.Oqu(t.lcZ(55,58,"Habit.CompleteCondition")),t.xp6(4),t.Oqu(t.lcZ(59,60,"Habit.CompleteConditionHint")),t.xp6(4),t.Oqu(t.lcZ(63,62,"Habit.StartDate")),t.xp6(4),t.Oqu(t.lcZ(67,64,"Habit.StartDateHint")),t.xp6(3),t.Q6J("disabled",!i.firstFormGroup.valid),t.xp6(1),t.Oqu(t.lcZ(71,66,"Common.Next")),t.xp6(2),t.Q6J("stepControl",i.secondFormGroup),t.xp6(1),t.Q6J("formGroup",i.secondFormGroup),t.xp6(4),t.Oqu(t.lcZ(78,68,"Habit.ContinuousCompletedCounts")),t.xp6(3),t.Q6J("ngForOf",i.contDays),t.xp6(3),t.Oqu(t.lcZ(84,70,"Common.Previous")),t.xp6(3),t.Oqu(t.lcZ(87,72,"Common.Next")),t.xp6(2),t.Q6J("completed",i.pointCompleted),t.xp6(5),t.Q6J("dataSource",i.arRules),t.xp6(10),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(2),t.Oqu(t.lcZ(107,74,"Common.Previous")),t.xp6(2),t.Q6J("disabled",!i.pointCompleted),t.xp6(1),t.Oqu(t.lcZ(110,76,"Common.Next")),t.xp6(5),t.AsE("",t.lcZ(115,78,"AwardRuleGroupCreatedInfo1"),", ID: ",i.createdHabitID," "),t.xp6(3),t.Oqu(t.lcZ(118,80,"AwardRuleGroupCreatedInfo2")),t.xp6(4),t.Oqu(t.lcZ(122,82,"Common.Display")),t.xp6(3),t.Oqu(t.lcZ(125,84,"Common.CreateAnotherOne"))}},dependencies:[g.sg,n._Y,n.Fj,n.wV,n.JJ,n.JL,n.Q7,n.On,n.sg,n.u,H.ey,x.lW,Z.C0,Z.VY,Z.Vq,Z.Ic,Z.fd,d.nW,d.wx,d.zY,d.By,d._g,R.Nt,_.KE,_.hX,_.bx,_.R9,ot.i$,ot.Tg,v.gD,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,S.Ye,T.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.input-point[_ngcontent-%COMP%]{text-align:center}"]});var se=s(7556);function ce(o,e){1&o&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function me(o,e){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const i=e.$implicit,a=t.oxw();t.xp6(1),t.AsE("",a.getUserDisplayAs(i.targetUser)," (",i.targetUser,")")}}function ue(o,e){1&o&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Name")))}function pe(o,e){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.hij(" ",i.habitName," ")}}function de(o,e){1&o&&(t.TgZ(0,"th",21),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Quiz.Date")))}function _e(o,e){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.recordDateString)}}function he(o,e){1&o&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.SubID")))}function Ce(o,e){if(1&o){const i=t.EpF();t.TgZ(0,"td",20),t._uU(1),t.TgZ(2,"button",1),t.NdJ("click",function(){const m=t.CHM(i).$implicit,p=t.oxw();return t.KtG(p.onDisplayRecord(m))}),t.ALo(3,"transloco"),t.TgZ(4,"mat-icon"),t._uU(5,"launch"),t.qZA()(),t.TgZ(6,"button",22),t.NdJ("click",function(){const m=t.CHM(i).$implicit,p=t.oxw();return t.KtG(p.onDeleteRecord(m))}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"remove_circle"),t.qZA()()()}if(2&o){const i=e.$implicit;t.xp6(1),t.hij(" ",i.subID," "),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,3,"Common.Display")),t.xp6(4),t.s9C("matTooltip",t.lcZ(7,5,"Common.Delete"))}}function fe(o,e){1&o&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.CompleteFact")))}function ge(o,e){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.completeFact)}}function be(o,e){1&o&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.Rule")))}function Ze(o,e){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.ruleID)}}function Te(o,e){1&o&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.ContinuousDays")))}function Ae(o,e){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.continuousCount)}}function xe(o,e){1&o&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Comment")))}function Ue(o,e){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.comment)}}function qe(o,e){1&o&&t._UZ(0,"tr",23)}function He(o,e){1&o&&t._UZ(0,"tr",24)}class y{constructor(e,i,a,r){this.odataSrv=e,this.dialog=i,this.authService=a,this.uiUtilSrv=r,this.arRecords=[],this.displayedColumns=["targetUser","habitname","recordDate","subID","completeFact","ruleID","contDays","comment"],this.recordCount=0,this.isLoadingResults=!1,this.refreshEvent=new t.vpe}getUserDisplayAs(e){if(e&&this.authService.userDetail){const i=this.authService.userDetail.awardUsers.findIndex(a=>a.targetUser===e);if(-1!==i)return this.authService.userDetail.awardUsers[i].displayAs}return""}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,V.T)(this.sort.sortChange,this.paginator.page,this.refreshEvent).pipe((0,z.O)({}),(0,X.w)(()=>{const e=this.paginator.pageSize;return this.odataSrv.getUserHabitRecordViews(e,e*this.paginator.pageIndex,this.sort.active,this.sort.direction)}),(0,W.x)(()=>this.isLoadingResults=!1),(0,tt.U)(e=>(this.recordCount=e.totalCount,e.items)),(0,et.K)(()=>(0,K.of)([]))).subscribe({next:e=>this.arRecords=e,error:e=>this.uiUtilSrv.showSnackInfo(e)})}onCreateRecord(){this.uiUtilSrv.navigateHabitRecordCreatePage()}onRefreshList(){this.refreshEvent.emit()}resetPaging(){this.paginator.pageIndex=0}onDisplayRecord(e){this.uiUtilSrv.currentUserHabitRecord=e,this.uiUtilSrv.navigateHabitRecordDisplayPage()}onDeleteRecord(e){this.odataSrv.deleteUserHabitRecord(e.habitID??0,e.recordDateString,e.subID).subscribe({next:()=>{this.uiUtilSrv.showSnackInfo("Delete successfully")},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})}}function ve(o,e){if(1&o&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.Q6J("value",i.targetUser),t.xp6(1),t.Oqu(i.displayAs)}}y.\u0275fac=function(e){return new(e||y)(t.Y36(u.CB),t.Y36(A.uw),t.Y36(se.e),t.Y36(u.dM))},y.\u0275cmp=t.Xpm({type:y,selectors:[["app-habit-record-list"]],viewQuery:function(e,i){if(1&e&&(t.Gf(Q.NW,5),t.Gf(U.YE,5)),2&e){let a;t.iGM(a=t.CRH())&&(i.paginator=a.first),t.iGM(a=t.CRH())&&(i.sort=a.first)}},decls:39,vars:11,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary",3,"matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource","matSortChange"],["matColumnDef","targetUser"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","habitname"],["matColumnDef","recordDate"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","subID"],["matColumnDef","completeFact"],["matColumnDef","ruleID"],["matColumnDef","contDays"],["matColumnDef","comment"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],["mat-icon-button","","color","warn",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""]],template:function(e,i){1&e&&(t.TgZ(0,"mat-toolbar")(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.TgZ(5,"button",1),t.NdJ("click",function(){return i.onCreateRecord()}),t.ALo(6,"transloco"),t.TgZ(7,"mat-icon"),t._uU(8,"add_circle"),t.qZA()()(),t.TgZ(9,"div",2)(10,"div",3)(11,"table",4),t.NdJ("matSortChange",function(){return i.resetPaging()}),t.ynx(12,5),t.YNc(13,ce,3,3,"th",6),t.YNc(14,me,2,2,"td",7),t.BQk(),t.ynx(15,8),t.YNc(16,ue,3,3,"th",6),t.YNc(17,pe,2,1,"td",7),t.BQk(),t.ynx(18,9),t.YNc(19,de,3,3,"th",10),t.YNc(20,_e,2,1,"td",7),t.BQk(),t.ynx(21,11),t.YNc(22,he,3,3,"th",6),t.YNc(23,Ce,10,7,"td",7),t.BQk(),t.ynx(24,12),t.YNc(25,fe,3,3,"th",6),t.YNc(26,ge,2,1,"td",7),t.BQk(),t.ynx(27,13),t.YNc(28,be,3,3,"th",6),t.YNc(29,Ze,2,1,"td",7),t.BQk(),t.ynx(30,14),t.YNc(31,Te,3,3,"th",6),t.YNc(32,Ae,2,1,"td",7),t.BQk(),t.ynx(33,15),t.YNc(34,xe,3,3,"th",6),t.YNc(35,Ue,2,1,"td",7),t.BQk(),t.YNc(36,qe,1,0,"tr",16),t.YNc(37,He,1,0,"tr",17),t.qZA()(),t._UZ(38,"mat-paginator",18),t.qZA()),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,7,"Habit.Records")),t.xp6(3),t.s9C("matTooltip",t.lcZ(6,9,"Common.Create")),t.xp6(6),t.Q6J("dataSource",i.arRecords),t.xp6(25),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.recordCount)("pageSize",20))},dependencies:[x.RK,G.Hw,Q.NW,U.YE,U.nU,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,S.Ye,B.gM,T.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}"]});class w{constructor(e,i,a,r,m){this._formBuilder=e,this.activateRoute=i,this.uiUtilSrv=a,this.authService=r,this.odataSrv=m,this.uiMode=h.sk.Create,this.currentMode="Common.Display",this.currentObject=null,this.detailFormGroup=this._formBuilder.group({targetuserCtrl:new n.p4("",n.kI.required),habitIDCtrl:new n.p4(-1),dateCtrl:new n.p4(b()(),n.kI.required),subIDCtrl:new n.p4(1,n.kI.required),compFactCtrl:new n.p4(1,n.kI.required),commentCtrl:new n.p4("")})}get arTargetUsers(){return this.authService.userDetail?this.authService.userDetail.awardUsers:[]}getUserDisplayAs(e){if(e&&this.authService.userDetail){const i=this.authService.userDetail.awardUsers.findIndex(a=>a.targetUser===e);if(-1!==i)return this.authService.userDetail.awardUsers[i].displayAs}return""}get isDisplayMode(){return this.uiMode===h.sk.Display}get isCreateMode(){return this.uiMode===h.sk.Create}get isUpdateMode(){return this.uiMode===h.sk.Update}get isEditable(){return this.uiMode===h.sk.Create||this.uiMode===h.sk.Update}ngOnInit(){this.activateRoute.url.subscribe({next:e=>{e instanceof Array&&e.length>0&&("record"===e[0].path&&"display"===e[1].path?(this.uiMode=h.sk.Display,this.currentMode="Common.Display"):"record"===e[0].path&&"edit"===e[1].path&&(this.uiMode=h.sk.Update,this.currentMode="Common.Change")),this.uiUtilSrv.currentUserHabitRecord?(this.detailFormGroup.get("targetuserCtrl")?.setValue(this.uiUtilSrv.currentUserHabitRecord.targetUser),this.detailFormGroup.get("habitIDCtrl")?.setValue(this.uiUtilSrv.currentUserHabitRecord.habitID),this.detailFormGroup.get("dateCtrl")?.setValue(this.uiUtilSrv.currentUserHabitRecord.recordDate),this.detailFormGroup.get("subIDCtrl")?.setValue(this.uiUtilSrv.currentUserHabitRecord.subID),this.detailFormGroup.get("compFactCtrl")?.setValue(this.uiUtilSrv.currentUserHabitRecord.completeFact),this.detailFormGroup.get("commentCtrl")?.setValue(this.uiUtilSrv.currentUserHabitRecord.comment),this.uiMode===h.sk.Display?this.detailFormGroup.disable():this.detailFormGroup.enable(),this.uiUtilSrv.clearHabitRecordDisplay()):(this.uiMode=h.sk.Invalid,this.detailFormGroup.disable())},error:e=>{this.uiUtilSrv.showSnackInfo(e)}})}onOK(){}onReturnToList(){this.uiUtilSrv.navigateHabitRecordListPage()}onCreateNewOne(){this.detailFormGroup.reset()}}w.\u0275fac=function(e){return new(e||w)(t.Y36(n.QS),t.Y36(M.gz),t.Y36(u.dM),t.Y36(u.e8),t.Y36(u.CB))},w.\u0275cmp=t.Xpm({type:w,selectors:[["app-habit-record-detail"]],decls:59,vars:42,consts:[["appearance","outlined"],[3,"formGroup"],["appearance","fill",1,"control-full-width"],["required","","formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","formControlName","habitIDCtrl"],["appearance","fill"],["matInput","","formControlName","dateCtrl",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","type","number","formControlName","subIDCtrl"],["matInput","","type","number","formControlName","compFactCtrl"],["matInput","","type","string","formControlName","commentCtrl"],["mat-button","","color","primary",3,"disabled","click"],["mat-button","",3,"click"],["mat-button","",3,"disabled","click"],[3,"value"]],template:function(e,i){if(1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.ALo(7,"transloco"),t.qZA()(),t.TgZ(8,"mat-card-content")(9,"form",1)(10,"mat-form-field",2)(11,"mat-label"),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"mat-select",3),t.YNc(15,ve,2,2,"mat-option",4),t.qZA()(),t.TgZ(16,"mat-form-field",2)(17,"mat-label"),t._uU(18,"#"),t.qZA(),t._UZ(19,"input",5),t.qZA(),t.TgZ(20,"mat-form-field",6)(21,"mat-label"),t._uU(22),t.ALo(23,"transloco"),t.qZA(),t._UZ(24,"input",7)(25,"mat-datepicker-toggle",8)(26,"mat-datepicker",null,9),t.qZA(),t.TgZ(28,"mat-form-field",2)(29,"mat-label"),t._uU(30),t.ALo(31,"transloco"),t.qZA(),t._UZ(32,"input",10),t.TgZ(33,"mat-hint"),t._uU(34),t.ALo(35,"transloco"),t.qZA()(),t.TgZ(36,"mat-form-field",2)(37,"mat-label"),t._uU(38),t.ALo(39,"transloco"),t.qZA(),t._UZ(40,"input",11),t.TgZ(41,"mat-hint"),t._uU(42),t.ALo(43,"transloco"),t.qZA()(),t.TgZ(44,"mat-form-field",2)(45,"mat-label"),t._uU(46),t.ALo(47,"transloco"),t.qZA(),t._UZ(48,"input",12),t.qZA()()(),t.TgZ(49,"mat-card-actions")(50,"button",13),t.NdJ("click",function(){return i.onOK()}),t._uU(51),t.ALo(52,"transloco"),t.qZA(),t.TgZ(53,"button",14),t.NdJ("click",function(){return i.onReturnToList()}),t._uU(54),t.ALo(55,"transloco"),t.qZA(),t.TgZ(56,"button",15),t.NdJ("click",function(){return i.onCreateNewOne()}),t._uU(57),t.ALo(58,"transloco"),t.qZA()()()),2&e){const a=t.MAs(27);t.xp6(3),t.Oqu(t.lcZ(4,18,"Habit.Record")),t.xp6(3),t.Oqu(t.lcZ(7,20,i.currentMode)),t.xp6(3),t.Q6J("formGroup",i.detailFormGroup),t.xp6(3),t.Oqu(t.lcZ(13,22,"Award.TargetUser")),t.xp6(3),t.Q6J("ngForOf",i.arTargetUsers),t.xp6(7),t.Oqu(t.lcZ(23,24,"Quiz.Date")),t.xp6(2),t.Q6J("matDatepicker",a),t.xp6(1),t.Q6J("for",a),t.xp6(5),t.Oqu(t.lcZ(31,26,"Habit.SubID")),t.xp6(4),t.Oqu(t.lcZ(35,28,"Habit.SubIDHint")),t.xp6(4),t.Oqu(t.lcZ(39,30,"Habit.CompleteFact")),t.xp6(4),t.Oqu(t.lcZ(43,32,"Habit.CompleteFactHint")),t.xp6(4),t.Oqu(t.lcZ(47,34,"Common.Comment")),t.xp6(4),t.Q6J("disabled",!(i.isEditable&&i.detailFormGroup.valid)),t.xp6(1),t.Oqu(t.lcZ(52,36,"Common.Save")),t.xp6(3),t.Oqu(t.lcZ(55,38,"Common.ReturnToList")),t.xp6(2),t.Q6J("disabled",!i.isDisplayMode),t.xp6(1),t.Oqu(t.lcZ(58,40,"Common.CreateAnotherOne"))}},dependencies:[g.sg,n._Y,n.Fj,n.wV,n.JJ,n.JL,n.Q7,n.sg,n.u,H.ey,x.lW,C.a8,C.hq,C.dn,C.dk,C.$j,C.n5,d.Mq,d.hl,d.nW,R.Nt,_.KE,_.hX,_.bx,_.R9,v.gD,T.Ot]});var nt=s(4128),De=s(6709);function ye(o,e){1&o&&(t._uU(0),t.ALo(1,"transloco")),2&o&&t.Oqu(t.lcZ(1,1,"Habit.PickAnUser"))}function we(o,e){if(1&o&&(t.TgZ(0,"mat-option",27),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.Q6J("value",i.targetUser),t.xp6(1),t.Oqu(i.displayAs)}}function Oe(o,e){1&o&&(t._uU(0),t.ALo(1,"transloco")),2&o&&t.Oqu(t.lcZ(1,1,"Habit.AvailableHabits"))}function Le(o,e){1&o&&(t.TgZ(0,"th",28),t._uU(1,"ID"),t.qZA())}function Ne(o,e){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.HabitID)}}function Se(o,e){1&o&&(t.TgZ(0,"th",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Name")))}function Re(o,e){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.HabitName)}}function ke(o,e){1&o&&(t.TgZ(0,"th",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.Frequency")))}function Pe(o,e){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o){const i=e.$implicit,a=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,a.getHabitFrequencyName(i.Frequency)))}}function Fe(o,e){1&o&&(t.TgZ(0,"th",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.CompleteCategory")))}function Ye(o,e){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o){const i=e.$implicit,a=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,a.getHabitCompleteCategoryName(i.CompleteCategory)))}}function Me(o,e){1&o&&(t.TgZ(0,"th",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Habit.CompleteFact")))}function Qe(o,e){if(1&o){const i=t.EpF();t.TgZ(0,"div")(1,"mat-checkbox",33),t.NdJ("ngModelChange",function(r){t.CHM(i);const m=t.oxw().$implicit;return t.KtG(m.CompleteFact=r)}),t.qZA()()}if(2&o){const i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngModel",i.CompleteFact)}}function Je(o,e){if(1&o){const i=t.EpF();t.TgZ(0,"div")(1,"mat-form-field")(2,"input",34),t.NdJ("ngModelChange",function(r){t.CHM(i);const m=t.oxw().$implicit;return t.KtG(m.CompleteFact=r)}),t.ALo(3,"transloco"),t.qZA()()()}if(2&o){const i=t.oxw().$implicit;t.xp6(2),t.s9C("placeholder",t.lcZ(3,2,"Value")),t.Q6J("ngModel",i.CompleteFact)}}function Ie(o,e){1&o&&(t.TgZ(0,"div"),t._uU(1,"Nothing display"),t.qZA())}function Ge(o,e){if(1&o&&(t.TgZ(0,"td",29)(1,"div",30),t.YNc(2,Qe,2,1,"div",31),t.YNc(3,Je,4,4,"div",31),t.YNc(4,Ie,2,0,"div",32),t.qZA()()),2&o){const i=e.$implicit;t.xp6(1),t.Q6J("ngSwitch",i.completeCategoryString),t.xp6(1),t.Q6J("ngSwitchCase",0),t.xp6(1),t.Q6J("ngSwitchCase",1)}}function Be(o,e){1&o&&t._UZ(0,"tr",35)}function $e(o,e){1&o&&t._UZ(0,"tr",36)}function Ee(o,e){1&o&&(t._uU(0),t.ALo(1,"transloco")),2&o&&t.Oqu(t.lcZ(1,1,"Common.Done"))}class je{constructor(){this.HabitID=void 0,this.HabitName="",this.Frequency=c.Hs.Daily,this.CompleteCategory=c.Kd.NumberOfTimes,this.CompleteFact=null}get completeCategoryString(){return(+this.CompleteCategory).toString()}}class P{constructor(e,i,a,r){this._formBuilder=e,this.uiUtilSrv=i,this.authService=a,this.odataSrv=r,this.currentObject=null,this.arHabits=[],this.displayedColumns=["hid","name","frequency","compCategory","compFact"],this.firstFormGroup=this._formBuilder.group({targetuserCtrl:new n.p4("",n.kI.required),dateCtrl:new n.p4(b()(),n.kI.required)})}get arTargetUsers(){return this.authService.userDetail?this.authService.userDetail.awardUsers:[]}getUserDisplayAs(e){if(e&&this.authService.userDetail){const i=this.authService.userDetail.awardUsers.findIndex(a=>a.targetUser===e);if(-1!==i)return this.authService.userDetail.awardUsers[i].displayAs}return""}getHabitCompleteCategoryName(e){return(0,c.E0)(e)}getHabitFrequencyName(e){return(0,c.lC)(e)}onUserSelected(){const e=this.firstFormGroup.get("targetuserCtrl")?.value,i=this.firstFormGroup.get("dateCtrl")?.value.format(c.Jt);this.odataSrv.getUserHabits(100,0,void 0,void 0,`TargetUser eq '${e}' and ValidFrom le ${i} and ValidTo ge ${i}`).subscribe({next:a=>{this.arHabits=[],a.items.forEach(r=>{const m=new je;m.HabitID=r.ID,m.HabitName=r.name,m.Frequency=r.frequency,m.CompleteCategory=r.completeCategory,m.CompleteFact=null,this.arHabits.push(m)})},error:a=>{this.uiUtilSrv.showSnackInfo(a,1500)}})}get isHabitStepCompleted(){if(!this.arHabits)return!1;let e=!1;return this.arHabits.forEach(i=>{i.CompleteFact&&(e=!0)}),e}onSaveRecord(){const e=[];this.arHabits.forEach(i=>{if(null!==i.CompleteFact){const a=new c.Dh;a.completeFact=+i.CompleteFact,a.habitID=i.HabitID,a.recordDate=this.firstFormGroup.get("dateCtrl")?.value,e.push(this.odataSrv.createUserHabitRecord(a))}}),(0,nt.D)(e).subscribe({next:i=>{console.log(i)},error:i=>{this.uiUtilSrv.showSnackInfo(i,1500)}})}}P.\u0275fac=function(e){return new(e||P)(t.Y36(n.QS),t.Y36(u.dM),t.Y36(u.e8),t.Y36(u.CB))},P.\u0275cmp=t.Xpm({type:P,selectors:[["app-habit-record-create"]],decls:64,vars:35,consts:[[1,"toolbar-spacer"],["linear",""],["stepper",""],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],["appearance","fill",1,"control-full-width"],["required","","formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],["matInput","","formControlName","dateCtrl",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["mat-button","","color","primary","matStepperNext","",3,"disabled","click"],[3,"completed"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","hid"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","frequency"],["matColumnDef","compCategory"],["matColumnDef","compFact"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","","matStepperPrevious",""],["mat-button","","color","warn",3,"click"],[3,"value"],["mat-header-cell",""],["mat-cell",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"ngModel","ngModelChange"],["matInput","","type","number","name","compfact_num",3,"placeholder","ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""]],template:function(e,i){if(1&e){const a=t.EpF();t.TgZ(0,"mat-toolbar")(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.qZA(),t.TgZ(5,"mat-vertical-stepper",1,2)(7,"mat-step",3)(8,"form",4),t.YNc(9,ye,2,3,"ng-template",5),t.TgZ(10,"mat-form-field",6)(11,"mat-label"),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"mat-select",7),t.YNc(15,we,2,2,"mat-option",8),t.qZA()(),t.TgZ(16,"mat-form-field",9)(17,"mat-label"),t._uU(18),t.ALo(19,"transloco"),t.qZA(),t._UZ(20,"input",10)(21,"mat-datepicker-toggle",11)(22,"mat-datepicker",null,12),t.qZA()(),t.TgZ(24,"div")(25,"button",13),t.NdJ("click",function(){return i.onUserSelected()}),t._uU(26),t.ALo(27,"transloco"),t.qZA()()(),t.TgZ(28,"mat-step",14),t.YNc(29,Oe,2,3,"ng-template",5),t.TgZ(30,"table",15),t.ynx(31,16),t.YNc(32,Le,2,0,"th",17),t.YNc(33,Ne,2,1,"td",18),t.BQk(),t.ynx(34,19),t.YNc(35,Se,3,3,"th",17),t.YNc(36,Re,2,1,"td",18),t.BQk(),t.ynx(37,20),t.YNc(38,ke,3,3,"th",17),t.YNc(39,Pe,3,3,"td",18),t.BQk(),t.ynx(40,21),t.YNc(41,Fe,3,3,"th",17),t.YNc(42,Ye,3,3,"td",18),t.BQk(),t.ynx(43,22),t.YNc(44,Me,3,3,"th",17),t.YNc(45,Ge,5,3,"td",18),t.BQk(),t.YNc(46,Be,1,0,"tr",23),t.YNc(47,$e,1,0,"tr",24),t.qZA(),t.TgZ(48,"div")(49,"button",25),t._uU(50),t.ALo(51,"transloco"),t.qZA(),t.TgZ(52,"button",13),t.NdJ("click",function(){return i.onSaveRecord()}),t._uU(53),t.ALo(54,"transloco"),t.qZA()()(),t.TgZ(55,"mat-step"),t.YNc(56,Ee,2,3,"ng-template",5),t.TgZ(57,"p"),t._uU(58),t.ALo(59,"transloco"),t.qZA(),t.TgZ(60,"div")(61,"button",26),t.NdJ("click",function(){t.CHM(a);const m=t.MAs(6);return t.KtG(m.reset())}),t._uU(62),t.ALo(63,"transloco"),t.qZA()()()()}if(2&e){const a=t.MAs(23);t.xp6(2),t.Oqu(t.lcZ(3,19,"Habit.Records")),t.xp6(5),t.Q6J("stepControl",i.firstFormGroup),t.xp6(1),t.Q6J("formGroup",i.firstFormGroup),t.xp6(4),t.Oqu(t.lcZ(13,21,"Award.TargetUser")),t.xp6(3),t.Q6J("ngForOf",i.arTargetUsers),t.xp6(3),t.Oqu(t.lcZ(19,23,"Quiz.Date")),t.xp6(2),t.Q6J("matDatepicker",a),t.xp6(1),t.Q6J("for",a),t.xp6(4),t.Q6J("disabled",!i.firstFormGroup.valid),t.xp6(1),t.Oqu(t.lcZ(27,25,"Common.Next")),t.xp6(2),t.Q6J("completed",i.isHabitStepCompleted),t.xp6(2),t.Q6J("dataSource",i.arHabits),t.xp6(16),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(3),t.Oqu(t.lcZ(51,27,"Common.Previous")),t.xp6(2),t.Q6J("disabled",!i.isHabitStepCompleted),t.xp6(1),t.Oqu(t.lcZ(54,29,"Common.Next")),t.xp6(5),t.Oqu(t.lcZ(59,31,"Habit.HabitRecordCreatedInfo")),t.xp6(4),t.Oqu(t.lcZ(63,33,"Common.CreateAnotherOne"))}},dependencies:[g.sg,g.RF,g.n9,g.ED,n._Y,n.Fj,n.wV,n.JJ,n.JL,n.Q7,n.On,n.sg,n.u,H.ey,x.lW,De.oG,Z.C0,Z.VY,Z.Vq,Z.Ic,Z.fd,d.Mq,d.hl,d.nW,R.Nt,_.KE,_.hX,_.R9,v.gD,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,S.Ye,T.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}"]});var Ve=s(4850);function Ke(o,e){if(1&o&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.Q6J("value",i.targetUser),t.xp6(1),t.Oqu(i.displayAs)}}function ze(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1,"#"),t.qZA())}function Xe(o,e){if(1&o){const i=t.EpF();t.TgZ(0,"td",24),t._uU(1),t.TgZ(2,"button",25),t.NdJ("click",function(){const m=t.CHM(i).$implicit,p=t.oxw(2);return t.KtG(p.onDeleteManualPoint(m.ID))}),t.ALo(3,"transloco"),t.TgZ(4,"mat-icon"),t._uU(5,"remove_circle"),t.qZA()()()}if(2&o){const i=e.$implicit;t.xp6(1),t.hij("",i.ID," | "),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,2,"Common.Delete"))}}function We(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function to(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit,a=t.oxw(2);t.xp6(1),t.AsE("",a.getUserDisplayAs(i.targetUser)," (",i.targetUser,")")}}function eo(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Quiz.Date")))}function oo(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.recordDateString)}}function io(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function ao(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.point)}}function no(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Comment")))}function ro(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.comment)}}function lo(o,e){1&o&&t._UZ(0,"tr",26)}function so(o,e){1&o&&t._UZ(0,"tr",27)}function co(o,e){if(1&o){const i=t.EpF();t.TgZ(0,"div",11)(1,"mat-toolbar")(2,"h3"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t._UZ(5,"div",0),t.TgZ(6,"button",7),t.NdJ("click",function(){t.CHM(i);const r=t.oxw();return t.KtG(r.onHideManualPoints())}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"visibility_off"),t.qZA()()(),t.TgZ(10,"div",12)(11,"table",13),t.ynx(12,14),t.YNc(13,ze,2,0,"th",15),t.YNc(14,Xe,6,4,"td",16),t.BQk(),t.ynx(15,17),t.YNc(16,We,3,3,"th",15),t.YNc(17,to,2,2,"td",16),t.BQk(),t.ynx(18,18),t.YNc(19,eo,3,3,"th",15),t.YNc(20,oo,2,1,"td",16),t.BQk(),t.ynx(21,19),t.YNc(22,io,3,3,"th",15),t.YNc(23,ao,2,1,"td",16),t.BQk(),t.ynx(24,20),t.YNc(25,no,3,3,"th",15),t.YNc(26,ro,2,1,"td",16),t.BQk(),t.YNc(27,lo,1,0,"tr",21),t.YNc(28,so,1,0,"tr",22),t.qZA()()()}if(2&o){const i=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,5,"Award.Point")),t.xp6(3),t.s9C("matTooltip",t.lcZ(7,7,"Common.Hide")),t.xp6(5),t.Q6J("dataSource",i.dataSourceManualPoints),t.xp6(16),t.Q6J("matHeaderRowDef",i.displayedColumnsManualPoint),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumnsManualPoint)}}function mo(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function uo(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit,a=t.oxw(2);t.xp6(1),t.AsE("",a.getUserDisplayAs(i.targetUser)," (",i.targetUser,")")}}function po(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Quiz.Date")))}function _o(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.recordDateString)}}function ho(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1,"ID"),t.qZA())}function Co(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.habitID)}}function fo(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Name")))}function go(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.habitName)}}function bo(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1,"From"),t.qZA())}function Zo(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.ruleDaysFrom)}}function To(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1,"To"),t.qZA())}function Ao(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.ruleDaysTo)}}function xo(o,e){1&o&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function Uo(o,e){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.xp6(1),t.Oqu(i.rulePoint)}}function qo(o,e){1&o&&t._UZ(0,"tr",26)}function Ho(o,e){1&o&&t._UZ(0,"tr",27)}function vo(o,e){if(1&o){const i=t.EpF();t.TgZ(0,"div",11)(1,"mat-toolbar")(2,"h3"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t._UZ(5,"div",0),t.TgZ(6,"button",7),t.NdJ("click",function(){t.CHM(i);const r=t.oxw();return t.KtG(r.onHideHabitPoints())}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"visibility_off"),t.qZA()()(),t.TgZ(10,"div",12)(11,"table",13),t.ynx(12,17),t.YNc(13,mo,3,3,"th",15),t.YNc(14,uo,2,2,"td",16),t.BQk(),t.ynx(15,18),t.YNc(16,po,3,3,"th",15),t.YNc(17,_o,2,1,"td",16),t.BQk(),t.ynx(18,28),t.YNc(19,ho,2,0,"th",15),t.YNc(20,Co,2,1,"td",16),t.BQk(),t.ynx(21,29),t.YNc(22,fo,3,3,"th",15),t.YNc(23,go,2,1,"td",16),t.BQk(),t.ynx(24,30),t.YNc(25,bo,2,0,"th",15),t.YNc(26,Zo,2,1,"td",16),t.BQk(),t.ynx(27,31),t.YNc(28,To,2,0,"th",15),t.YNc(29,Ao,2,1,"td",16),t.BQk(),t.ynx(30,19),t.YNc(31,xo,3,3,"th",15),t.YNc(32,Uo,2,1,"td",16),t.BQk(),t.YNc(33,qo,1,0,"tr",21),t.YNc(34,Ho,1,0,"tr",22),t.qZA()()()}if(2&o){const i=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,5,"Award.Point")),t.xp6(3),t.s9C("matTooltip",t.lcZ(7,7,"Common.Hide")),t.xp6(5),t.Q6J("dataSource",i.dataSourceHabitPoints),t.xp6(22),t.Q6J("matHeaderRowDef",i.displayedColumnsHabitPoint),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumnsHabitPoint)}}function Do(o,e){if(1&o&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&o){const i=e.$implicit;t.Q6J("value",i.targetUser),t.xp6(1),t.hij(" ",i.displayAs," ")}}class F{constructor(e,i,a,r){this.odataSrv=e,this.dialog=i,this.authService=a,this.uiUtilSrv=r,this.displayedColumnsManualPoint=["id","targetUser","recordDate","point","comment"],this.dataSourceManualPoints=[],this.displayedColumnsHabitPoint=["targetUser","recordDate","habitid","habitName","ruleDaysFrom","ruleDaysTo","point"],this.dataSourceHabitPoints=[],this.selectedUser=null,this.selectedPeriod="2",this.showManualPointResult=!1,this.showHabitPointResult=!1}get arTargetUsers(){return this.authService.userDetail?this.authService.userDetail.awardUsers:[]}getUserDisplayAs(e){if(e&&this.authService.userDetail){const i=this.authService.userDetail.awardUsers.findIndex(a=>a.targetUser===e);if(-1!==i)return this.authService.userDetail.awardUsers[i].displayAs}return""}ngOnInit(){this.selectedPeriod="2"}onReportParameterSelectionChange(e){null!==this.selectedUser&&this.refreshData()}refreshData(){const e=b()();let i=b().duration(1,"months").asDays();"1"===this.selectedPeriod&&(i=b().duration(1,"weeks").asDays());const a=e.clone().subtract(i,"days"),r=[],m=i;for(;i>=0;)r.push(e.clone().subtract(i,"days").format(c.Jt)),i--;const p=`TargetUser eq '${this.selectedUser}' and RecordDate ge ${a.format(c.Jt)} and RecordDate le ${e.format(c.Jt)}`,f=[];(0,nt.D)([this.odataSrv.getHabitOpeningPointsByUserDate(this.selectedUser??"",m),this.odataSrv.getHabitPointsByUserDateReport(p),this.odataSrv.getUserOpeningPointReport(this.selectedUser,m),this.odataSrv.getUserHabitPointReports(p)]).subscribe({next:N=>{const rt=N[1],lt=N[3],st=[],ct=[],mt=[];let J=0,I=0,ut=N[0]+N[2];r.forEach(pt=>{const dt=rt.findIndex($=>$.recordDateString===pt);J=-1!==dt?rt[dt].point:0,st.push(J);const _t=lt.findIndex($=>$.recordDateString===pt);-1!==_t?I+=lt[_t].point:I=0,ct.push(I),ut+=J+I,mt.push(ut)}),f.push({name:"Points from Habits",type:"bar",emphasis:{focus:"series"},data:st}),f.push({name:"Manual Points",type:"bar",emphasis:{focus:"series"},data:ct}),f.push({name:"Total Points",type:"bar",emphasis:{focus:"series"},data:mt}),this.chartOption={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:r}],yAxis:[{type:"value"}],series:f}},error:N=>{this.uiUtilSrv.showSnackInfo(N)}})}onChartClick(e){0===e.seriesIndex?(this.showHabitPointResult=!0,this.dataSourceHabitPoints=[],this.odataSrv.getUserHabitRecordViews(100,0,void 0,void 0,`RecordDate eq ${e.name} and TargetUser eq '${this.selectedUser}' and RulePoint gt 0`).subscribe({next:a=>{this.dataSourceHabitPoints=a.items},error:a=>{this.uiUtilSrv.showSnackInfo(a)}})):1===e.seriesIndex&&e.name&&(this.showManualPointResult=!0,this.dataSourceManualPoints=[],this.odataSrv.getHabitPoints(`RecordDate eq ${e.name} and TargetUser eq '${this.selectedUser}'`).subscribe({next:a=>{this.dataSourceManualPoints=a},error:a=>{this.uiUtilSrv.showSnackInfo(a)}}))}onHideManualPoints(){this.showManualPointResult=!1}onHideHabitPoints(){this.showHabitPointResult=!1}onDeleteManualPoint(e){this.odataSrv.deleteHabitPoint(e).subscribe({next:()=>{this.uiUtilSrv.showSnackInfo("DONE"),this.showManualPointResult=!1,this.refreshData()},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})}onCreatePoint(){this.dialog.open(Y,{width:"600px",closeOnNavigation:!1,data:new c._Y}).afterClosed().subscribe(i=>{i&&this.odataSrv.createHabitPoint(i).subscribe({next:()=>{this.refreshData()},error:a=>{this.uiUtilSrv.showSnackInfo(a)}})})}}F.\u0275fac=function(e){return new(e||F)(t.Y36(u.CB),t.Y36(A.uw),t.Y36(u.e8),t.Y36(u.dM))},F.\u0275cmp=t.Xpm({type:F,selectors:[["app-habit-points-list"]],decls:32,vars:24,consts:[[1,"toolbar-spacer"],[1,"form-field-item"],["required","",3,"ngModel","ngModelChange","selectionChange"],["value","1"],["value","2"],[1,"form-field-user"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","color","primary",3,"matTooltip","click"],["echarts","",1,"demo-chart",2,"width","100%","height","450px",3,"options","chartClick"],["class","example-container mat-elevation-z8",4,"ngIf"],[3,"value"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","targetUser"],["matColumnDef","recordDate"],["matColumnDef","point"],["matColumnDef","comment"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","warn",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""],["matColumnDef","habitid"],["matColumnDef","habitName"],["matColumnDef","ruleDaysFrom"],["matColumnDef","ruleDaysTo"]],template:function(e,i){1&e&&(t.TgZ(0,"mat-toolbar")(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.qZA(),t.TgZ(5,"mat-toolbar")(6,"mat-form-field",1)(7,"mat-label"),t._uU(8),t.ALo(9,"transloco"),t.qZA(),t.TgZ(10,"mat-select",2),t.NdJ("ngModelChange",function(r){return i.selectedPeriod=r})("selectionChange",function(r){return i.onReportParameterSelectionChange(r)}),t.TgZ(11,"mat-option",3),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"mat-option",4),t._uU(15),t.ALo(16,"transloco"),t.qZA()()(),t.TgZ(17,"mat-form-field",5)(18,"mat-label"),t._uU(19),t.ALo(20,"transloco"),t.qZA(),t.TgZ(21,"mat-select",2),t.NdJ("ngModelChange",function(r){return i.selectedUser=r})("selectionChange",function(r){return i.onReportParameterSelectionChange(r)}),t.YNc(22,Ke,2,2,"mat-option",6),t.qZA()(),t.TgZ(23,"button",7),t.NdJ("click",function(){return i.onCreatePoint()}),t.ALo(24,"transloco"),t.TgZ(25,"mat-icon"),t._uU(26,"add_circle"),t.qZA()()(),t._UZ(27,"mat-divider"),t.TgZ(28,"div",8),t.NdJ("chartClick",function(r){return i.onChartClick(r)}),t.qZA(),t._UZ(29,"mat-divider"),t.YNc(30,co,29,9,"div",9),t.YNc(31,vo,35,9,"div",9)),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,12,"Award.Point")),t.xp6(6),t.Oqu(t.lcZ(9,14,"Habit.Frequency")),t.xp6(2),t.Q6J("ngModel",i.selectedPeriod),t.xp6(2),t.Oqu(t.lcZ(13,16,"Habit.ByWeek")),t.xp6(3),t.Oqu(t.lcZ(16,18,"Habit.ByMonth")),t.xp6(4),t.Oqu(t.lcZ(20,20,"Award.TargetUser")),t.xp6(2),t.Q6J("ngModel",i.selectedUser),t.xp6(1),t.Q6J("ngForOf",i.arTargetUsers),t.xp6(1),t.s9C("matTooltip",t.lcZ(24,22,"Common.Create")),t.xp6(5),t.Q6J("options",i.chartOption),t.xp6(2),t.Q6J("ngIf",i.showManualPointResult),t.xp6(1),t.Q6J("ngIf",i.showHabitPointResult))},dependencies:[g.sg,g.O5,n.JJ,n.Q7,n.On,H.ey,x.RK,Ve.d,G.Hw,_.KE,_.hX,v.gD,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,S.Ye,B.gM,j._w,T.Ot],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.form-field-item[_ngcontent-%COMP%]{width:150px}.form-field-user[_ngcontent-%COMP%]{width:200px}"]});class Y{constructor(e,i,a,r){this.dialogRef=e,this.oDataSrv=i,this.authService=a,this.data=r}onNoClick(){this.dialogRef.close()}}Y.\u0275fac=function(e){return new(e||Y)(t.Y36(A.so),t.Y36(u.CB),t.Y36(u.e8),t.Y36(A.WI))},Y.\u0275cmp=t.Xpm({type:Y,selectors:[["app-habit-point-crtdlg"]],decls:35,vars:27,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"example-form"],["appearance","fill",1,"control-full-width"],["name","targetuser",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],["matInput","","name","recorddate",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["matInput","","type","number","name","point",3,"ngModel","ngModelChange"],["matInput","","name","comment",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"disabled","mat-dialog-close"],[3,"value"]],template:function(e,i){if(1&e&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"transloco"),t.qZA(),t.TgZ(3,"div",1)(4,"form",2)(5,"mat-form-field",3)(6,"mat-label"),t._uU(7),t.ALo(8,"transloco"),t.qZA(),t.TgZ(9,"mat-select",4),t.NdJ("ngModelChange",function(r){return i.data.targetUser=r}),t.YNc(10,Do,2,2,"mat-option",5),t.qZA()(),t.TgZ(11,"mat-form-field",6)(12,"mat-label"),t._uU(13),t.ALo(14,"transloco"),t.qZA(),t.TgZ(15,"input",7),t.NdJ("ngModelChange",function(r){return i.data.recordDate=r}),t.qZA(),t._UZ(16,"mat-datepicker-toggle",8)(17,"mat-datepicker",null,9),t.qZA(),t.TgZ(19,"mat-form-field",3)(20,"mat-label"),t._uU(21),t.ALo(22,"transloco"),t.qZA(),t.TgZ(23,"input",10),t.NdJ("ngModelChange",function(r){return i.data.point=r}),t.qZA()(),t.TgZ(24,"mat-form-field",3)(25,"mat-label"),t._uU(26),t.ALo(27,"transloco"),t.qZA(),t.TgZ(28,"input",11),t.NdJ("ngModelChange",function(r){return i.data.comment=r}),t.qZA()()()(),t.TgZ(29,"div",12)(30,"button",13),t.NdJ("click",function(){return i.onNoClick()}),t._uU(31),t.ALo(32,"transloco"),t.qZA(),t.TgZ(33,"button",14),t._uU(34,"OK"),t.qZA()()),2&e){const a=t.MAs(18);t.xp6(1),t.Oqu(t.lcZ(2,15,"Habit.CreateManualPoint")),t.xp6(6),t.Oqu(t.lcZ(8,17,"Award.TargetUser")),t.xp6(2),t.Q6J("ngModel",i.data.targetUser),t.xp6(1),t.Q6J("ngForOf",null==i.authService.userDetail?null:i.authService.userDetail.awardUsers),t.xp6(3),t.Oqu(t.lcZ(14,19,"Quiz.Date")),t.xp6(2),t.Q6J("matDatepicker",a)("ngModel",i.data.recordDate),t.xp6(1),t.Q6J("for",a),t.xp6(5),t.Oqu(t.lcZ(22,21,"Award.Point")),t.xp6(2),t.Q6J("ngModel",i.data.point),t.xp6(3),t.Oqu(t.lcZ(27,23,"Common.Comment")),t.xp6(2),t.Q6J("ngModel",i.data.comment),t.xp6(3),t.Oqu(t.lcZ(32,25,"Common.NoThanks")),t.xp6(2),t.Q6J("disabled",!i.data.isValid)("mat-dialog-close",i.data)}},dependencies:[g.sg,n._Y,n.Fj,n.wV,n.JJ,n.JL,n.On,n.F,H.ey,x.lW,d.Mq,d.hl,d.nW,A.ZT,A.uh,A.xY,A.H8,R.Nt,_.KE,_.hX,_.R9,v.gD,T.Ot],encapsulation:2});const yo=[{path:"",component:q},{path:"points",component:F},{path:"list",component:q},{path:"create",component:k},{path:"edit/:id",component:D},{path:"display/:id",component:D},{path:"record",component:y},{path:"record/list",component:y},{path:"record/create",component:P},{path:"record/edit",component:w},{path:"record/display",component:w}];class O{}O.\u0275fac=function(e){return new(e||O)},O.\u0275mod=t.oAB({type:O}),O.\u0275inj=t.cJS({imports:[M.Bz.forChild(yo),M.Bz]});class L{}L.\u0275fac=function(e){return new(e||L)},L.\u0275mod=t.oAB({type:L}),L.\u0275inj=t.cJS({imports:[g.ez,n.u5,n.UX,ht.U,T.y4,Ct.D,j.Ns,O]})}}]);