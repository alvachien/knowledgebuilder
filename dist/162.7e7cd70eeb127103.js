"use strict";(self.webpackChunkknowledgebuilder=self.webpackChunkknowledgebuilder||[]).push([[162],{1162:(Y,v,s)=>{s.r(v),s.d(v,{PreviewModule:()=>z});var m=s(6814),a=s(6223),u=s(2164),Z=s(5437),x=s(2787),d=s(9611),h=s(8005),e=s(5879),p=s(7093),_=s(4601),P=s(3680),w=s(9038);let b=(()=>{class i{constructor(t,o,n,c){this._bottomSheetRef=t,this.odataSrv=o,this.authService=n,this.data=c}createNewScore(t,o){o.preventDefault();const n=new d.oh;n.RefID=this.data.excitemid,n.Score=t,this.authService.getUserData().subscribe(c=>{n.User=c.sub,this.odataSrv.createExerciseItemUserScore(n).subscribe({next:l=>{this.data.resultFlag=!0,this.data.newScore=l,this._bottomSheetRef.dismiss(this.data)},error:l=>{this.data.resultFlag=!1,this.data.newScore=null,this.data.errorInfo=l,this._bottomSheetRef.dismiss(this.data)}})})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(h.oL),e.Y36(p.CB),e.Y36(_.J_),e.Y36(h.OG))},i.\u0275cmp=e.Xpm({type:i,selectors:[["hkb-preview-newscore-sheet"]],decls:19,vars:9,consts:[["mat-list-item","",3,"click"],["mat-line",""]],template:function(t,o){1&t&&(e.TgZ(0,"mat-nav-list")(1,"a",0),e.NdJ("click",function(c){return o.createNewScore(0,c)}),e.TgZ(2,"span",1),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"span",1),e._uU(6,"Add a new score of 0"),e.qZA()(),e.TgZ(7,"a",0),e.NdJ("click",function(c){return o.createNewScore(60,c)}),e.TgZ(8,"span",1),e._uU(9),e.ALo(10,"transloco"),e.qZA(),e.TgZ(11,"span",1),e._uU(12,"Add a new score of 60"),e.qZA()(),e.TgZ(13,"a",0),e.NdJ("click",function(c){return o.createNewScore(100,c)}),e.TgZ(14,"span",1),e._uU(15),e.ALo(16,"transloco"),e.qZA(),e.TgZ(17,"span",1),e._uU(18,"Add a new score of 100"),e.qZA()()()),2&t&&(e.xp6(3),e.hij("",e.lcZ(4,3,"NewPractice"),": 0"),e.xp6(6),e.hij("",e.lcZ(10,5,"NewPractice"),": 60"),e.xp6(6),e.hij("",e.lcZ(16,7,"NewPractice"),": 100"))},dependencies:[P.X2,w.Hk,w.Tg,u.Ot],encapsulation:2}),i})();var S=s(1088),T=s(2296),A=s(5986),I=s(6385),C=s(4170),f=s(2202),U=s(2596),g=s(4611);function O(i,r){if(1&i&&(e.TgZ(0,"div",3)(1,"h3"),e._uU(2),e.qZA(),e._UZ(3,"mat-divider"),e.TgZ(4,"h3"),e._uU(5),e.ALo(6,"transloco"),e.qZA(),e._UZ(7,"mat-divider"),e.TgZ(8,"div",4),e._UZ(9,"markdown",5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("ID: ",t.selectedKnowledge.ID,""),e.xp6(3),e.AsE("",e.lcZ(6,5,"Title"),": ",t.selectedKnowledge.Title,""),e.xp6(4),e.Q6J("data",t.selectedKnowledge.Content)("katexOptions",t.mathOptions)}}function M(i,r){1&i&&(e.TgZ(0,"mat-label",16),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"FontSize")))}function N(i,r){if(1&i&&(e.TgZ(0,"mat-label")(1,"span"),e._uU(2),e.qZA(),e._uU(3),e.ALo(4,"date"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Tol(t.isSuccessScore?"success-score":"fail-score"),e.xp6(1),e.Oqu(t.selectedExerciseUserScore.Score),e.xp6(1),e.hij(" (",e.xi3(4,4,t.selectedExerciseUserScore.TakenDate,"yyyy-M-d"),")")}}function y(i,r){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij("ID: ",t.selectedExercise.ID,"")}}function E(i,r){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"transloco"),e.ALo(3,"transloco"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.AsE("",e.lcZ(2,2,"Type"),": ",e.lcZ(3,4,t.getExerciseItemTypeName(t.selectedExercise.ItemType)),"")}}function J(i,r){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.AsE("",e.lcZ(2,2,"Tags"),": ",t.selectedExercise.Tags.toString(),"")}}function j(i,r){1&i&&e._UZ(0,"mat-divider")}function L(i,r){if(1&i&&(e.TgZ(0,"div",14),e._UZ(1,"mat-divider"),e.TgZ(2,"h3"),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e._UZ(5,"markdown",5),e.qZA()),2&i){const t=e.oxw(2);e.Udp("font-size",t.fontSize,"px"),e.xp6(3),e.Oqu(e.lcZ(4,5,"Answer")),e.xp6(2),e.Q6J("data",t.selectedExercise.Answer)("katexOptions",t.mathOptions)}}function k(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",6)(2,"mat-checkbox",7),e.NdJ("ngModelChange",function(n){e.CHM(t);const c=e.oxw();return e.KtG(c.focusMode=n)}),e.ALo(3,"transloco"),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.TgZ(6,"mat-checkbox",8),e.NdJ("ngModelChange",function(n){e.CHM(t);const c=e.oxw();return e.KtG(c.hideAnswer=n)}),e.ALo(7,"transloco"),e._uU(8),e.ALo(9,"transloco"),e.qZA(),e.YNc(10,M,3,3,"mat-label",9),e.TgZ(11,"mat-slider",10),e.NdJ("ngModelChange",function(n){e.CHM(t);const c=e.oxw();return e.KtG(c.fontSize=n)}),e.ALo(12,"transloco"),e._UZ(13,"input",11),e.qZA()(),e.TgZ(14,"div",6),e.YNc(15,N,5,7,"mat-label",12),e.TgZ(16,"button",13),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onNewScore())}),e._uU(17),e.ALo(18,"transloco"),e.qZA()(),e._UZ(19,"mat-divider"),e.YNc(20,y,2,1,"h3",12),e.YNc(21,E,4,6,"h3",12),e.YNc(22,J,3,4,"h3",12),e.YNc(23,j,1,0,"mat-divider",12),e.TgZ(24,"div",14)(25,"h3"),e._uU(26),e.ALo(27,"transloco"),e.qZA(),e._UZ(28,"markdown",5),e.qZA(),e.YNc(29,L,6,7,"div",15),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.s9C("matTooltip",e.lcZ(3,21,"FocusMode")),e.Q6J("ngModel",t.focusMode),e.xp6(2),e.Oqu(e.lcZ(5,23,"FocusMode")),e.xp6(2),e.s9C("matTooltip",e.lcZ(7,25,"QuizMode")),e.Q6J("ngModel",t.hideAnswer),e.xp6(2),e.Oqu(e.lcZ(9,27,"QuizMode")),e.xp6(2),e.Q6J("ngIf",!t.mobileQuery.matches),e.xp6(1),e.s9C("matTooltip",e.lcZ(12,29,"FontSize")),e.Q6J("ngModel",t.fontSize),e.xp6(4),e.Q6J("ngIf",t.selectedExerciseUserScore),e.xp6(2),e.Oqu(e.lcZ(18,31,"NewPractice")),e.xp6(3),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Udp("font-size",t.fontSize,"px"),e.xp6(2),e.Oqu(e.lcZ(27,33,"Content")),e.xp6(2),e.Q6J("data",t.selectedExercise.Content)("katexOptions",t.mathOptions),e.xp6(1),e.Q6J("ngIf",!t.hideAnswer)}}const Q=[{path:"",component:(()=>{class i{constructor(t,o,n,c,l){this.odataSvc=t,this._bottomSheet=c,this.uiUtilSrv=l,this.selectedExerciseUserScore=null,this.listPreviewObjects=[],this.mathOptions={displayMode:!0,throwOnError:!1,errorColor:"#cc0000"},this.focusMode=!1,this.hideAnswer=!1,this.fontSize=20,this.mobileQuery=n.matchMedia("(max-width: 600px)"),this._mobileQueryListener=()=>o.detectChanges(),this.previewIdx=-1}getExerciseItemTypeName(t){return(0,d.of)(t)}get isSuccessScore(){return null!==this.selectedExerciseUserScore&&this.selectedExerciseUserScore.Score>=60}ngOnInit(){this.mobileQuery.addEventListener("change",this._mobileQueryListener),this.listPreviewObjects=this.uiUtilSrv.previewObjList.slice(),this.uiUtilSrv.previewObjList=[],this.listPreviewObjects.length>0&&(this.previewIdx=-1,this.onNextPreviewItem())}ngOnDestroy(){this.mobileQuery.removeEventListener("change",this._mobileQueryListener)}onPreviousPreviewItem(){this.previewIdx>0&&(this.previewIdx--,this.selectedObj=this.listPreviewObjects[this.previewIdx],this.fetchPreviewItem())}onNextPreviewItem(){this.previewIdx<this.listPreviewObjects.length&&(this.previewIdx++,this.selectedObj=this.listPreviewObjects[this.previewIdx],this.fetchPreviewItem())}get isNextPreviewButtonEnabled(){return this.previewIdx<this.listPreviewObjects.length-1}get isPreviousButtonEnabled(){return this.previewIdx>0}fetchPreviewItem(){this.previewIdx>-1&&this.previewIdx<this.listPreviewObjects.length&&(this.selectedObj?.refType===d.ik.KnowledgeItem?this.odataSvc.readKnowledgeItem(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:t=>{this.selectedKnowledge=t},error:t=>{this.uiUtilSrv.showSnackInfo(t)}}):this.selectedObj?.refType===d.ik.ExerciseItem&&(this.odataSvc.readExerciseItem(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:t=>{this.selectedExercise=t},error:t=>{this.uiUtilSrv.showSnackInfo(t)}}),this.odataSvc.getLastestExerciseItemUserScore(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:t=>{this.selectedExerciseUserScore=t},error:t=>{this.uiUtilSrv.showSnackInfo(t)}})))}onNewScore(){this._bottomSheet.open(b,{data:{excitemid:this.selectedExercise?.ID}}).afterDismissed().subscribe(o=>{o.resultFlag?o.newScore&&(this.selectedExerciseUserScore=o.newScore):this.uiUtilSrv.showSnackInfo(o.errorInfo)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(p.CB),e.Y36(e.sBO),e.Y36(S.vx),e.Y36(h.ch),e.Y36(p.dM))},i.\u0275cmp=e.Xpm({type:i,selectors:[["khb-preview"]],decls:22,vars:22,consts:[[1,"button-row"],["mat-raised-button","",3,"disabled","click"],["class","mat-typography","style","margin: 8px;",4,"ngIf"],[1,"mat-typography",2,"margin","8px"],[1,"control-full-width",2,"margin-top","16px","font-size","large"],["katex","",3,"data","katexOptions"],[1,"button-row",2,"margin","8px"],["color","primary","name","focusmode",2,"margin-left","4px",3,"ngModel","matTooltip","ngModelChange"],["color","primary","name","quizmode",2,"margin-left","4px",3,"ngModel","matTooltip","ngModelChange"],["style","margin-left: 4px;",4,"ngIf"],["thumbLabel","","step","2","min","10","max","40",3,"ngModel","matTooltip","ngModelChange"],["matSliderThumb",""],[4,"ngIf"],["mat-raised-button","",3,"click"],[1,"control-full-width",2,"margin-top","16px"],["class","control-full-width","style","margin-top: 16px;",3,"font-size",4,"ngIf"],[2,"margin-left","4px"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return o.onPreviousPreviewItem()}),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.TgZ(6,"button",1),e.NdJ("click",function(){return o.onNextPreviewItem()}),e._uU(7),e.ALo(8,"transloco"),e.qZA()(),e._UZ(9,"mat-divider"),e.YNc(10,O,10,7,"div",2),e.YNc(11,k,30,35,"div",2),e._UZ(12,"mat-divider"),e.TgZ(13,"div",0)(14,"div"),e._uU(15),e.qZA(),e.TgZ(16,"button",1),e.NdJ("click",function(){return o.onPreviousPreviewItem()}),e._uU(17),e.ALo(18,"transloco"),e.qZA(),e.TgZ(19,"button",1),e.NdJ("click",function(){return o.onNextPreviewItem()}),e._uU(20),e.ALo(21,"transloco"),e.qZA()()),2&t&&(e.xp6(2),e.AsE(" ",o.previewIdx+1," / ",o.listPreviewObjects.length,""),e.xp6(1),e.Q6J("disabled",!o.isPreviousButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(5,14,"Common.Previous")),e.xp6(2),e.Q6J("disabled",!o.isNextPreviewButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(8,16,"Common.Next")),e.xp6(3),e.Q6J("ngIf",o.selectedObj&&1===o.selectedObj.refType&&o.selectedKnowledge),e.xp6(1),e.Q6J("ngIf",o.selectedObj&&2===o.selectedObj.refType&&o.selectedExercise),e.xp6(4),e.AsE(" ",o.previewIdx+1," / ",o.listPreviewObjects.length,""),e.xp6(1),e.Q6J("disabled",!o.isPreviousButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(18,18,"Common.Previous")),e.xp6(2),e.Q6J("disabled",!o.isNextPreviewButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(21,20,"Common.Next")))},dependencies:[m.O5,a.JJ,a.On,T.lW,A.oG,I.d,C.hX,f.pH,f.$5,U.gM,g.lF,m.uU,u.Ot],styles:[".button-row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.button-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:16px}.input-fontsize[_ngcontent-%COMP%]{margin-left:24px;width:100px}mat-slide-toggle[_ngcontent-%COMP%]{width:80px}mat-slider[_ngcontent-%COMP%]{margin-left:8px;width:80px}.success-score[_ngcontent-%COMP%]{color:green;font-size:16px}.fail-score[_ngcontent-%COMP%]{color:red;font-size:16px}"]}),i})()}];let q=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[x.Bz.forChild(Q),x.Bz]}),i})(),z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.ez,a.u5,a.UX,u.y4,Z.U,g.JP,q]}),i})()}}]);