(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{V7M2:function(t,e,i){"use strict";i.r(e),i.d(e,"ExerciseItemsModule",function(){return Gt});var o=i("ofXK"),c=i("3Pt+"),n=i("0LvA"),a=i("lR5k"),r=i("QPBi"),l=i("jIBr"),s=i("dcRk"),b=i("tyNb"),d=i("fXoL"),m=i("M9IT"),u=i("Dh3D"),h=i("VRyK"),p=i("LRne"),f=i("JX91"),g=i("eIep"),E=i("nYR2"),v=i("lJxs"),C=i("JIr8"),w=i("VHTt"),V=i("NUjs"),y=i("o0su"),U=i("/t3+"),x=i("bTqV"),D=i("+0xr");function I(t,e){1&t&&(d.Vb(0,"th",17),d.Ec(1,"#"),d.Ub())}function M(t,e){if(1&t){const t=d.Wb();d.Vb(0,"td",18),d.Vb(1,"div"),d.Ec(2),d.Vb(3,"a",19),d.dc("click",function(){d.wc(t);const i=e.$implicit;return d.hc().onDisplayItem(i.ID)}),d.Ec(4),d.ic(5,"transloco"),d.Ub(),d.Vb(6,"a",19),d.dc("click",function(){d.wc(t);const i=e.$implicit;return d.hc().onChangeItem(i.ID)}),d.Ec(7),d.ic(8,"transloco"),d.Ub(),d.Vb(9,"a",19),d.dc("click",function(){d.wc(t);const i=e.$implicit;return d.hc().onDeleteItem(i.ID)}),d.Ec(10),d.ic(11,"transloco"),d.Ub(),d.Ub(),d.Ub()}if(2&t){const t=e.$implicit,i=d.hc();d.Eb(2),d.Gc(" ",t.ID," "),d.Eb(1),d.nc("disabled",!i.isExpertMode),d.Eb(1),d.Fc(d.jc(5,7,"Common.Display")),d.Eb(2),d.nc("disabled",!i.isExpertMode),d.Eb(1),d.Fc(d.jc(8,9,"Common.Change")),d.Eb(2),d.nc("disabled",!i.isExpertMode),d.Eb(1),d.Fc(d.jc(11,11,"Common.Delete"))}}function F(t,e){1&t&&(d.Vb(0,"th",17),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t&&(d.Eb(1),d.Fc(d.jc(2,1,"Type")))}function j(t,e){if(1&t&&(d.Vb(0,"td",18),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t){const t=e.$implicit,i=d.hc();d.Eb(1),d.Fc(d.jc(2,1,i.getExerciseItemTypeName(t.ItemType)))}}function O(t,e){1&t&&(d.Vb(0,"th",17),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t&&(d.Eb(1),d.Fc(d.jc(2,1,"Tag")))}function k(t,e){if(1&t&&(d.Vb(0,"td",18),d.Ec(1),d.Ub()),2&t){const t=e.$implicit;d.Eb(1),d.Fc(t.Tags.toString())}}function T(t,e){1&t&&(d.Vb(0,"th",17),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t&&(d.Eb(1),d.Fc(d.jc(2,1,"KnowledgeItem")))}function S(t,e){if(1&t&&(d.Vb(0,"td",18),d.Ec(1),d.Ub()),2&t){const t=e.$implicit;d.Eb(1),d.Fc(t.KnowledgeItemID)}}function $(t,e){1&t&&(d.Vb(0,"th",20),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t&&(d.Eb(1),d.Fc(d.jc(2,1,"CreatedAt")))}function P(t,e){if(1&t&&(d.Vb(0,"td",18),d.Ec(1),d.ic(2,"date"),d.Ub()),2&t){const t=e.$implicit;d.Eb(1),d.Fc(d.kc(2,1,t.CreatedAt,"yyyy-M-d HH:mm:ss"))}}function G(t,e){1&t&&d.Qb(0,"tr",21)}function R(t,e){1&t&&d.Qb(0,"tr",22)}let N=(()=>{class t{constructor(t,e){this.odataService=t,this.router=e,this.displayedColumns=["id","itemtype","tags","knowledgeitem","createdat"],this.dataSource=[],this.resultsLength=0,this.isLoadingResults=!0,this.refreshEvent=new d.o}getExerciseItemTypeName(t){return Object(V.d)(t)}get isExpertMode(){return this.odataService.expertMode}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),Object(h.a)(this.sort.sortChange,this.paginator.page,this.refreshEvent).pipe(Object(f.a)({}),Object(g.a)(()=>{this.isLoadingResults=!0;const t=this.paginator.pageSize;return this.odataService.getExerciseItems(t,t*this.paginator.pageIndex,this.sort.active,this.sort.direction)}),Object(E.a)(()=>this.isLoadingResults=!1),Object(v.a)(t=>(this.resultsLength=t.totalCount,t.items)),Object(C.a)(()=>Object(p.a)([]))).subscribe({next:t=>this.dataSource=t,error:t=>console.log(t)})}onGoToPreview(){const t=[];this.dataSource.forEach(e=>{t.push({refType:w.y.ExerciseItem,refId:e.ID})}),this.odataService.previewObjList=t,this.router.navigate(["preview"])}onGoToSearch(){this.router.navigate(["exercise-item","search"])}onDeleteItem(t){this.odataService.deleteExerciseItem(t).subscribe({next:t=>{this.onRefreshList()},error:t=>{console.error(t)}})}onRefreshList(){this.refreshEvent.emit()}resetPaging(){this.paginator.pageIndex=0}onDisplayItem(t){this.router.navigate(["exercise-item","display",t.toString()])}onChangeItem(t){this.router.navigate(["exercise-item","edit",t.toString()])}}return t.\u0275fac=function(e){return new(e||t)(d.Pb(y.b),d.Pb(b.b))},t.\u0275cmp=d.Jb({type:t,selectors:[["app-exercise-items"]],viewQuery:function(t,e){if(1&t&&(d.Jc(m.a,1),d.Jc(u.a,1)),2&t){let t;d.tc(t=d.ec())&&(e.paginator=t.first),d.tc(t=d.ec())&&(e.sort=t.first)}},decls:39,vars:24,consts:[[1,"toolbar-spacer"],["mat-stroked-button","","routerLink","create",3,"disabled"],["mat-stroked-button","",3,"disabled","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","itemtype"],["matColumnDef","tags"],["matColumnDef","knowledgeitem"],["matColumnDef","createdat"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-button","",3,"disabled","click"],["mat-header-cell","","mat-sort-header",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(d.Vb(0,"mat-toolbar-row"),d.Vb(1,"span"),d.Ec(2),d.ic(3,"transloco"),d.Ub(),d.Qb(4,"span",0),d.Vb(5,"section"),d.Vb(6,"a",1),d.Ec(7),d.ic(8,"transloco"),d.Ub(),d.Vb(9,"a",2),d.dc("click",function(){return e.onGoToSearch()}),d.Ec(10),d.ic(11,"transloco"),d.Ub(),d.Vb(12,"a",2),d.dc("click",function(){return e.onGoToPreview()}),d.Ec(13),d.ic(14,"transloco"),d.Ub(),d.Vb(15,"a",2),d.dc("click",function(){return e.onRefreshList()}),d.Ec(16),d.ic(17,"transloco"),d.Ub(),d.Ub(),d.Ub(),d.Vb(18,"div",3),d.Vb(19,"div",4),d.Vb(20,"table",5),d.dc("matSortChange",function(){return e.resetPaging()}),d.Tb(21,6),d.Dc(22,I,2,0,"th",7),d.Dc(23,M,12,13,"td",8),d.Sb(),d.Tb(24,9),d.Dc(25,F,3,3,"th",7),d.Dc(26,j,3,3,"td",8),d.Sb(),d.Tb(27,10),d.Dc(28,O,3,3,"th",7),d.Dc(29,k,2,1,"td",8),d.Sb(),d.Tb(30,11),d.Dc(31,T,3,3,"th",7),d.Dc(32,S,2,1,"td",8),d.Sb(),d.Tb(33,12),d.Dc(34,$,3,3,"th",13),d.Dc(35,P,3,4,"td",8),d.Sb(),d.Dc(36,G,1,0,"tr",14),d.Dc(37,R,1,0,"tr",15),d.Ub(),d.Ub(),d.Qb(38,"mat-paginator",16),d.Ub()),2&t&&(d.Eb(2),d.Fc(d.jc(3,14,"ExerciseItem")),d.Eb(4),d.nc("disabled",!e.isExpertMode),d.Eb(1),d.Fc(d.jc(8,16,"Common.Create")),d.Eb(2),d.nc("disabled",!e.isExpertMode||e.dataSource.length<=0),d.Eb(1),d.Fc(d.jc(11,18,"Common.Search")),d.Eb(2),d.nc("disabled",!e.isExpertMode||e.dataSource.length<=0),d.Eb(1),d.Fc(d.jc(14,20,"Common.Preview")),d.Eb(2),d.nc("disabled",!e.isExpertMode),d.Eb(1),d.Fc(d.jc(17,22,"Common.Refresh")),d.Eb(4),d.nc("dataSource",e.dataSource),d.Eb(16),d.nc("matHeaderRowDef",e.displayedColumns),d.Eb(1),d.nc("matRowDefColumns",e.displayedColumns),d.Eb(1),d.nc("length",e.resultsLength)("pageSize",20))},directives:[U.c,x.a,b.c,D.j,u.a,D.c,D.e,D.b,D.g,D.i,m.a,D.d,D.a,u.b,D.f,D.h],pipes:[r.d,o.e],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.example-loading-shade[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.mat-column-id[_ngcontent-%COMP%]{max-width:300px;width:250px}.mat-column-itemtype[_ngcontent-%COMP%]{max-width:120px;width:120px}.mat-column-tags[_ngcontent-%COMP%]{max-width:250px;width:150px}.mat-column-created[_ngcontent-%COMP%]{max-width:120px;width:120px}"]}),t})();var A=i("jtHE"),L=i("FtGj"),Q=i("rCpU"),_=i("HKRH"),H=i("0IaG"),z=i("Wp6s"),K=i("kmnG"),W=i("qFsG"),J=i("d3UM"),B=i("A5z7"),q=i("XiUz"),X=i("FKr1"),Y=i("NFeN");function Z(t,e){if(1&t&&(d.Vb(0,"mat-option",18),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t){const t=e.$implicit;d.nc("value",t.value),d.Eb(1),d.Fc(d.jc(2,2,t.i18nterm))}}function tt(t,e){1&t&&(d.Vb(0,"mat-icon",21),d.Ec(1,"cancel"),d.Ub())}function et(t,e){if(1&t){const t=d.Wb();d.Vb(0,"mat-chip",19),d.dc("removed",function(){d.wc(t);const i=e.$implicit;return d.hc().removeTag(i)}),d.Ec(1),d.Dc(2,tt,2,0,"mat-icon",20),d.Ub()}if(2&t){const t=e.$implicit,i=d.hc();d.nc("selectable",i.selectable)("removable",i.isEditable),d.Eb(1),d.Gc(" ",t," "),d.Eb(1),d.nc("ngIf",i.isEditable)}}function it(t,e){if(1&t&&(d.Vb(0,"div",22),d.Vb(1,"div",23),d.Vb(2,"mat-form-field",1),d.Vb(3,"mat-label"),d.Ec(4),d.ic(5,"transloco"),d.Ub(),d.Qb(6,"input",24),d.ic(7,"transloco"),d.ic(8,"date"),d.Ub(),d.Ub(),d.Vb(9,"div",23),d.Vb(10,"mat-form-field",1),d.Vb(11,"mat-label"),d.Ec(12),d.ic(13,"transloco"),d.Ub(),d.Qb(14,"input",24),d.ic(15,"transloco"),d.ic(16,"date"),d.Ub(),d.Ub(),d.Ub()),2&t){const t=d.hc();d.Eb(4),d.Fc(d.jc(5,6,"CreatedAt")),d.Eb(2),d.oc("placeholder",d.jc(7,8,"CreatedAt")),d.nc("ngModel",d.kc(8,10,t.itemObject.CreatedAt,"yyyy-M-d HH:mm:ss")),d.Eb(6),d.Fc(d.jc(13,13,"ModifiedAt")),d.Eb(2),d.oc("placeholder",d.jc(15,15,"ModifiedAt")),d.nc("ngModel",d.kc(16,17,t.itemObject.ModifiedAt,"yyyy-M-d HH:mm:ss"))}}function ot(t,e){if(1&t){const t=d.Wb();d.Vb(0,"mat-toolbar"),d.Vb(1,"h3"),d.Ec(2),d.ic(3,"transloco"),d.Ub(),d.Qb(4,"div",25),d.Vb(5,"button",26),d.dc("click",function(){return d.wc(t),d.hc().openUploadDialog()}),d.Ec(6,"Upload"),d.Ub(),d.Ub()}2&t&&(d.Eb(2),d.Fc(d.jc(3,1,"Content")))}function ct(t,e){if(1&t){const t=d.Wb();d.Vb(0,"div",23),d.Vb(1,"ngx-monaco-editor",27),d.dc("ngModelChange",function(e){return d.wc(t),d.hc().content=e}),d.Ub(),d.Ub()}if(2&t){const t=d.hc();d.Eb(1),d.nc("options",t.editorOptions)("ngModel",t.content)}}function nt(t,e){if(1&t){const t=d.Wb();d.Vb(0,"mat-toolbar"),d.Vb(1,"h3"),d.Ec(2),d.ic(3,"transloco"),d.Ub(),d.Qb(4,"div",25),d.Vb(5,"button",26),d.dc("click",function(){return d.wc(t),d.hc().openAnswerUploadDialog()}),d.Vb(6,"mat-icon"),d.Ec(7,"file_upload"),d.Ub(),d.Ub(),d.Ub()}2&t&&(d.Eb(2),d.Fc(d.jc(3,1,"Answer")))}function at(t,e){if(1&t){const t=d.Wb();d.Vb(0,"div",23),d.Vb(1,"ngx-monaco-editor",27),d.dc("ngModelChange",function(e){return d.wc(t),d.hc().answerContent=e}),d.Ub(),d.Ub()}if(2&t){const t=d.hc();d.Eb(1),d.nc("options",t.editorOptions)("ngModel",t.answerContent)}}let rt=(()=>{class t{constructor(t,e,i,o){this.dialog=t,this.activateRoute=e,this.router=i,this.odataService=o,this.routerID=-1,this.uiMode=Q.b.Create,this.currentMode="",this.editorOptions={theme:"vs-dark",wordWrap:"on",roundedSelection:!0},this.content="New Exercise Item",this.answerContent="",this.mathOptions={displayMode:!0,throwOnError:!1,errorColor:"#cc0000"},this.selectable=!0,this.addOnBlur=!0,this.separatorKeysCodes=[L.g,L.c],this.tags=[],this.arExerciseTypes=[],this.arExerciseTypes=Object(V.e)(),this.itemFormGroup=new c.f({idControl:new c.d({value:null,disabled:!0}),typeControl:new c.d({value:V.c.Question}),knowledgeControl:new c.d,tagControl:new c.d})}get isDisplayMode(){return this.uiMode===Q.b.Display}get isCreateMode(){return this.uiMode===Q.b.Create}get isUpdateMode(){return this.uiMode===Q.b.Update}get isEditable(){return this.uiMode===Q.b.Create||this.uiMode===Q.b.Update}ngOnInit(){this.destroyed$=new A.a(1),this.activateRoute.url.subscribe({next:t=>{t instanceof Array&&t.length>0&&("create"===t[0].path?(this.routerID=-1,this.uiMode=Q.b.Create,this.currentMode="Common.Create"):"edit"===t[0].path?(this.routerID=+t[1].path,this.uiMode=Q.b.Update,this.currentMode="Common.Change"):"display"===t[0].path&&(this.routerID=+t[1].path,this.uiMode=Q.b.Display,this.currentMode="Common.Display")),-1!==this.routerID&&this.odataService.readExerciseItem(this.routerID,this.uiMode===Q.b.Update).subscribe({next:t=>{this.onSetItemData(t),this.itemObject=t},error:t=>{console.error(t)}})},error:t=>{console.error(t)}})}ngOnDestroy(){this.destroyed$&&(this.destroyed$.complete(),this.destroyed$=void 0)}onOK(){var t,e;if(this.isCreateMode){if(!this.itemFormGroup.valid)return void(this.itemFormGroup.errors&&console.error(this.itemFormGroup.errors));this.itemObject=new V.a,this.itemObject.ItemType=null===(t=this.itemFormGroup.get("typeControl"))||void 0===t?void 0:t.value,this.itemObject.Content=this.content,this.itemObject.Tags=this.tags,this.itemObject.Answer=this.answerContent,this.odataService.createExerciseItem(this.itemObject).subscribe({next:t=>{this.router.navigate(["/exercise-item/display",t.ID])},error:t=>{console.error(t)}})}else if(this.isUpdateMode){if(!this.itemFormGroup.valid)return void(this.itemFormGroup.errors&&console.log(this.itemFormGroup.errors));this.itemObject&&(this.itemObject.ItemType=null===(e=this.itemFormGroup.get("typeControl"))||void 0===e?void 0:e.value,this.itemObject.Content=this.content,this.itemObject.Tags=this.tags,this.itemObject.Answer=this.answerContent,this.odataService.changeExerciseItem(this.itemObject).subscribe({next:t=>{this.router.navigate(["/exercise-item/display",t.ID])},error:t=>{console.error(t)}}))}}openUploadDialog(){this.dialog.open(_.a,{width:"50%",height:"50%"}).afterClosed().subscribe({next:t=>{console.log(t),t.forEach(t=>{this.content+=`\n![Img](${t.url})\n          `})}})}openAnswerUploadDialog(){this.dialog.open(_.a,{width:"50%",height:"50%"}).afterClosed().subscribe({next:t=>{console.log(t),t.forEach(t=>{this.answerContent+=`\n  ![Img](${t.url})\n            `})}})}addTag(t){const e=t.input,i=t.value;(i||"").trim()&&this.tags.push(i.trim()),e&&(e.value="")}removeTag(t){const e=this.tags.indexOf(t);e>=0&&this.tags.splice(e,1)}onSetItemData(t){var e,i,o;null===(e=this.itemFormGroup.get("idControl"))||void 0===e||e.setValue(t.ID),null===(i=this.itemFormGroup.get("idControl"))||void 0===i||i.disable(),null===(o=this.itemFormGroup.get("typeControl"))||void 0===o||o.setValue(+t.ItemType),this.content=t.Content,this.tags=t.Tags,this.isDisplayMode?this.itemFormGroup.disable():this.itemFormGroup.markAsPristine()}onReturnToList(){this.router.navigate(["exercise-item"])}onCreateNewOne(){this.router.navigate(["exercise-item","create"])}}return t.\u0275fac=function(e){return new(e||t)(d.Pb(H.b),d.Pb(b.a),d.Pb(b.b),d.Pb(y.b))},t.\u0275cmp=d.Jb({type:t,selectors:[["app-exercise-item-detail"]],decls:54,vars:41,consts:[[3,"formGroup"],["appearance","fill",1,"control-full-width"],["matInput","","type","text","placeholder","ID","formControlName","idControl"],["required","","formControlName","typeControl"],[3,"value",4,"ngFor","ngForOf"],["formControlName","tagControl"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","New tag...",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["matInput","","type","text","placeholder","Knowledge ID","formControlName","knowledgeControl"],["fxLayout","row","class","control-full-width",4,"ngIf"],[4,"ngIf"],["fxLayout","row",1,"control-full-width",2,"height","500px"],["fxFlex","50",4,"ngIf"],["fxFlex","",2,"height","100%","overflow-y","scroll"],["katex","",3,"data","katexOptions"],["mat-button","",3,"disabled","click"],["mat-button","",3,"click"],[3,"value"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],["fxLayout","row",1,"control-full-width"],["fxFlex","50"],["matInput","","type","text","disabled","",3,"placeholder","ngModel"],[1,"toolbar-spacer"],["mat-raised-button","",3,"click"],[2,"height","100%",3,"options","ngModel","ngModelChange"]],template:function(t,e){if(1&t&&(d.Vb(0,"mat-card"),d.Vb(1,"mat-card-header"),d.Vb(2,"mat-card-title"),d.Ec(3),d.ic(4,"transloco"),d.Ub(),d.Vb(5,"mat-card-subtitle"),d.Ec(6),d.ic(7,"transloco"),d.Ub(),d.Ub(),d.Vb(8,"mat-card-content"),d.Vb(9,"form",0),d.Vb(10,"mat-form-field",1),d.Vb(11,"mat-label"),d.Ec(12,"#"),d.Ub(),d.Qb(13,"input",2),d.Ub(),d.Vb(14,"mat-form-field",1),d.Vb(15,"mat-label"),d.Ec(16),d.ic(17,"transloco"),d.Ub(),d.Vb(18,"mat-select",3),d.Dc(19,Z,3,4,"mat-option",4),d.Ub(),d.Ub(),d.Vb(20,"mat-form-field",1),d.Vb(21,"mat-label"),d.Ec(22),d.ic(23,"transloco"),d.Ub(),d.Vb(24,"mat-chip-list",5,6),d.Dc(26,et,3,4,"mat-chip",7),d.Vb(27,"input",8),d.dc("matChipInputTokenEnd",function(t){return e.addTag(t)}),d.Ub(),d.Ub(),d.Ub(),d.Vb(28,"mat-form-field",1),d.Vb(29,"mat-label"),d.Ec(30),d.ic(31,"transloco"),d.Ub(),d.Qb(32,"input",9),d.Ub(),d.Ub(),d.Dc(33,it,17,20,"div",10),d.Dc(34,ot,7,3,"mat-toolbar",11),d.Vb(35,"div",12),d.Dc(36,ct,2,2,"div",13),d.Vb(37,"div",14),d.Qb(38,"markdown",15),d.Ub(),d.Ub(),d.Dc(39,nt,8,3,"mat-toolbar",11),d.Vb(40,"div",12),d.Dc(41,at,2,2,"div",13),d.Vb(42,"div",14),d.Qb(43,"markdown",15),d.Ub(),d.Ub(),d.Ub(),d.Vb(44,"mat-card-actions"),d.Vb(45,"button",16),d.dc("click",function(){return e.onOK()}),d.Ec(46),d.ic(47,"transloco"),d.Ub(),d.Vb(48,"button",17),d.dc("click",function(){return e.onReturnToList()}),d.Ec(49),d.ic(50,"transloco"),d.Ub(),d.Vb(51,"button",16),d.dc("click",function(){return e.onCreateNewOne()}),d.Ec(52),d.ic(53,"transloco"),d.Ub(),d.Ub(),d.Ub()),2&t){const t=d.uc(25);d.Eb(3),d.Fc(d.jc(4,25,"ExerciseItem")),d.Eb(3),d.Fc(d.jc(7,27,e.currentMode)),d.Eb(3),d.nc("formGroup",e.itemFormGroup),d.Eb(7),d.Fc(d.jc(17,29,"Type")),d.Eb(3),d.nc("ngForOf",e.arExerciseTypes),d.Eb(3),d.Fc(d.jc(23,31,"Tags")),d.Eb(4),d.nc("ngForOf",e.tags),d.Eb(1),d.nc("matChipInputFor",t)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes)("matChipInputAddOnBlur",e.addOnBlur),d.Eb(3),d.Fc(d.jc(31,33,"KnowledgeItem")),d.Eb(3),d.nc("ngIf",!e.isCreateMode&&e.itemObject),d.Eb(1),d.nc("ngIf",e.isCreateMode),d.Eb(2),d.nc("ngIf",!e.isDisplayMode),d.Eb(2),d.nc("data",e.content)("katexOptions",e.mathOptions),d.Eb(1),d.nc("ngIf",e.isCreateMode),d.Eb(2),d.nc("ngIf",e.isCreateMode),d.Eb(2),d.nc("data",e.answerContent)("katexOptions",e.mathOptions),d.Eb(2),d.nc("disabled",!(e.isEditable&&e.itemFormGroup.valid)),d.Eb(1),d.Fc(d.jc(47,35,"Save")),d.Eb(3),d.Fc(d.jc(50,37,"Common.ReturnToList")),d.Eb(2),d.nc("disabled",!e.isDisplayMode),d.Eb(1),d.Fc(d.jc(53,39,"Common.CreateAnotherOne"))}},directives:[z.a,z.d,z.g,z.f,z.c,c.u,c.n,c.g,K.c,K.g,W.b,c.c,c.m,c.e,J.a,c.s,o.l,B.c,B.b,o.m,q.c,q.a,a.a,z.b,x.b,X.n,B.a,Y.a,B.d,c.p,U.a,n.a],pipes:[r.d,o.e],styles:[".example-form[_ngcontent-%COMP%]{margin:8px;min-width:150px;max-width:500px;width:100%}.mat-card-actions[_ngcontent-%COMP%]{margin-top:10px}"]}),t})();var lt=i("2Vo4"),st=i("f0Cb"),bt=i("iadO"),dt=i("bSwM"),mt=i("pFkP");function ut(t,e){if(1&t&&(d.Vb(0,"mat-option",26),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t){const t=e.$implicit;d.nc("value",t.value),d.Eb(1),d.Gc(" ",d.jc(2,2,t.displayas)," ")}}function ht(t,e){if(1&t&&(d.Vb(0,"mat-option",26),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t){const t=e.$implicit;d.nc("value",t.value),d.Eb(1),d.Gc(" ",d.jc(2,2,t.i18nterm)," ")}}function pt(t,e){if(1&t){const t=d.Wb();d.Vb(0,"mat-form-field"),d.Vb(1,"input",27),d.dc("ngModelChange",function(e){return d.wc(t),d.hc().$implicit.value[0]=e}),d.ic(2,"transloco"),d.Ub(),d.Ub()}if(2&t){const t=d.hc().$implicit;d.Eb(1),d.oc("placeholder",d.jc(2,2,"Value")),d.nc("ngModel",t.value[0])}}function ft(t,e){if(1&t){const t=d.Wb();d.Vb(0,"mat-form-field"),d.Vb(1,"input",28),d.dc("ngModelChange",function(e){return d.wc(t),d.hc().$implicit.value[1]=e}),d.ic(2,"transloco"),d.Ub(),d.Ub()}if(2&t){const t=d.hc().$implicit;d.Eb(1),d.oc("placeholder",d.jc(2,2,"Value")),d.nc("ngModel",t.value[1])}}function gt(t,e){if(1&t){const t=d.Wb();d.Vb(0,"mat-form-field"),d.Vb(1,"input",29),d.dc("ngModelChange",function(e){return d.wc(t),d.hc().$implicit.value[0]=e}),d.ic(2,"transloco"),d.Ub(),d.Ub()}if(2&t){const t=d.hc().$implicit;d.Eb(1),d.oc("placeholder",d.jc(2,2,"Value")),d.nc("ngModel",t.value[0])}}function Et(t,e){if(1&t){const t=d.Wb();d.Vb(0,"mat-form-field"),d.Vb(1,"input",30),d.dc("ngModelChange",function(e){return d.wc(t),d.hc().$implicit.value[0]=e}),d.ic(2,"transloco"),d.Ub(),d.Qb(3,"mat-datepicker-toggle",31),d.Qb(4,"mat-datepicker",null,32),d.Ub()}if(2&t){const t=d.uc(5),e=d.hc().$implicit;d.Eb(1),d.oc("placeholder",d.jc(2,4,"Value")),d.nc("ngModel",e.value[0])("matDatepicker",t),d.Eb(2),d.nc("for",t)}}function vt(t,e){if(1&t){const t=d.Wb();d.Vb(0,"mat-form-field"),d.Vb(1,"input",30),d.dc("ngModelChange",function(e){return d.wc(t),d.hc().$implicit.value[1]=e}),d.ic(2,"transloco"),d.Ub(),d.Qb(3,"mat-datepicker-toggle",31),d.Qb(4,"mat-datepicker",null,33),d.Ub()}if(2&t){const t=d.uc(5),e=d.hc().$implicit;d.Eb(1),d.oc("placeholder",d.jc(2,4,"Value")),d.nc("ngModel",e.value[1])("matDatepicker",t),d.Eb(2),d.nc("for",t)}}function Ct(t,e){if(1&t){const t=d.Wb();d.Vb(0,"div",34),d.Vb(1,"mat-checkbox",35),d.dc("ngModelChange",function(e){return d.wc(t),d.hc().$implicit.value[0]=e}),d.Ub(),d.Ub()}if(2&t){const t=d.hc().$implicit;d.Eb(1),d.nc("ngModel",t.value[0])}}function wt(t,e){if(1&t){const t=d.Wb();d.Vb(0,"div",18),d.Vb(1,"mat-form-field"),d.Vb(2,"mat-select",19),d.dc("ngModelChange",function(t){return e.$implicit.fieldName=t})("selectionChange",function(){d.wc(t);const i=e.$implicit;return d.hc().onFieldSelectionChanged(i)}),d.ic(3,"transloco"),d.Dc(4,ut,3,4,"mat-option",20),d.Ub(),d.Ub(),d.Vb(5,"mat-form-field"),d.Vb(6,"mat-select",21),d.dc("ngModelChange",function(t){return e.$implicit.operator=t}),d.ic(7,"transloco"),d.Dc(8,ht,3,4,"mat-option",20),d.ic(9,"operatorFilter"),d.Ub(),d.Ub(),d.Dc(10,pt,3,4,"mat-form-field",22),d.Dc(11,ft,3,4,"mat-form-field",22),d.Dc(12,gt,3,4,"mat-form-field",22),d.Dc(13,Et,6,6,"mat-form-field",22),d.Dc(14,vt,6,6,"mat-form-field",22),d.Dc(15,Ct,2,1,"div",23),d.Vb(16,"button",24),d.dc("click",function(){return d.wc(t),d.hc().onAddFilter()}),d.Vb(17,"mat-icon"),d.Ec(18,"add"),d.Ub(),d.Ub(),d.Vb(19,"button",25),d.dc("click",function(){d.wc(t);const i=e.index;return d.hc().onRemoveFilter(i)}),d.Vb(20,"mat-icon"),d.Ec(21,"close"),d.Ub(),d.Ub(),d.Ub()}if(2&t){const t=e.$implicit,i=d.hc();d.Eb(2),d.oc("placeholder",d.jc(3,12,"Field")),d.nc("ngModel",t.fieldName),d.Eb(2),d.nc("ngForOf",i.allFields),d.Eb(2),d.oc("placeholder",d.jc(7,14,"Operator")),d.nc("ngModel",t.operator),d.Eb(2),d.nc("ngForOf",d.kc(9,16,i.allOperators,t.valueType)),d.Eb(2),d.nc("ngIf",1===t.valueType),d.Eb(1),d.nc("ngIf",1===t.valueType),d.Eb(1),d.nc("ngIf",2===t.valueType),d.Eb(1),d.nc("ngIf",3===t.valueType),d.Eb(1),d.nc("ngIf",3===t.valueType),d.Eb(1),d.nc("ngIf",4===t.valueType)}}function Vt(t,e){1&t&&(d.Vb(0,"th",36),d.Ec(1,"#"),d.Ub())}function yt(t,e){if(1&t){const t=d.Wb();d.Vb(0,"td",37),d.Vb(1,"div"),d.Ec(2),d.Vb(3,"a",38),d.dc("click",function(){d.wc(t);const i=e.$implicit;return d.hc().onDisplayItem(i.ID)}),d.Ec(4),d.ic(5,"transloco"),d.Ub(),d.Ub(),d.Ub()}if(2&t){const t=e.$implicit;d.Eb(2),d.Gc(" ",t.ID," "),d.Eb(2),d.Fc(d.jc(5,2,"Common.Display"))}}function Ut(t,e){1&t&&(d.Vb(0,"th",36),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t&&(d.Eb(1),d.Fc(d.jc(2,1,"Type")))}function xt(t,e){if(1&t&&(d.Vb(0,"td",37),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t){const t=e.$implicit,i=d.hc();d.Eb(1),d.Fc(d.jc(2,1,i.getExerciseItemTypeName(t.ItemType)))}}function Dt(t,e){1&t&&(d.Vb(0,"th",36),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t&&(d.Eb(1),d.Fc(d.jc(2,1,"Tag")))}function It(t,e){if(1&t&&(d.Vb(0,"td",37),d.Ec(1),d.Ub()),2&t){const t=e.$implicit;d.Eb(1),d.Fc(t.Tags.toString())}}function Mt(t,e){1&t&&(d.Vb(0,"th",36),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t&&(d.Eb(1),d.Fc(d.jc(2,1,"KnowledgeItem")))}function Ft(t,e){if(1&t&&(d.Vb(0,"td",37),d.Ec(1),d.Ub()),2&t){const t=e.$implicit;d.Eb(1),d.Fc(t.KnowledgeItemID)}}function jt(t,e){1&t&&(d.Vb(0,"th",36),d.Ec(1),d.ic(2,"transloco"),d.Ub()),2&t&&(d.Eb(1),d.Fc(d.jc(2,1,"CreatedAt")))}function Ot(t,e){if(1&t&&(d.Vb(0,"td",37),d.Ec(1),d.ic(2,"date"),d.Ub()),2&t){const t=e.$implicit;d.Eb(1),d.Fc(d.kc(2,1,t.CreatedAt,"yyyy-M-d HH:mm:ss"))}}function kt(t,e){1&t&&d.Qb(0,"tr",39)}function Tt(t,e){1&t&&d.Qb(0,"tr",40)}const St=[{path:"",component:N},{path:"create",component:rt},{path:"display/:id",component:rt},{path:"edit/:id",component:rt},{path:"search",component:(()=>{class t{constructor(t,e){this.odataService=t,this.router=e,this.filters=[],this.allOperators=[],this.allFields=[],this.filterEditable=!0,this.pageSize=20,this.pageSizeOptions=[20,40,60,100],this.isLoadingResults=!1,this.subjFilters=new lt.a([]),this.displayedColumns=["id","itemtype","tags","knowledgeitem","createdat"],this.dataSource=[],this.resultsLength=0,this.allOperators=w.z.getGeneralFilterOperatorDisplayStrings(),this.allFields=[{displayas:"Content",value:"Content",valueType:2},{displayas:"Tag",value:"Tags",valueType:2},{displayas:"Type",value:"ExerciseType",valueType:2}]}ngOnInit(){this.onAddFilter()}ngAfterViewInit(){this.subjFilters.subscribe(()=>this.paginator.pageIndex=0),Object(h.a)(this.subjFilters,this.paginator.page).pipe(Object(f.a)({}),Object(g.a)(()=>{if(this.subjFilters.value.length<=0)return Object(p.a)([]);this.isLoadingResults=!0;const t=this.prepareFilters(this.subjFilters.value),e=this.paginator.pageSize;return this.odataService.searchExerciseItems(e,e*this.paginator.pageIndex,t)}),Object(E.a)(()=>this.isLoadingResults=!1),Object(v.a)(t=>(this.resultsLength=t.totalCount,t.items)),Object(C.a)(()=>Object(p.a)(void 0))).subscribe({next:t=>this.dataSource=t,error:t=>console.log(t)})}getExerciseItemTypeName(t){return Object(w.B)(t)}onAddFilter(){this.filters.push(new w.j)}onRemoveFilter(t){this.filters.splice(t,1),0===this.filters.length&&this.onAddFilter()}onFieldSelectionChanged(t){this.allFields.forEach(e=>{e.value===t.fieldName&&(t.valueType=e.valueType)})}prepareFilters(t){let e="";t.sort((t,e)=>t.fieldName.localeCompare(e.fieldName));let i=t.map(t=>t.fieldName);return i=Array.from(new Set(i)),i.forEach(i=>{let o="";t.forEach(t=>{t.fieldName===i&&("Content"!==t.fieldName&&"Tags"!==t.fieldName||(t.operator===w.k.Equal?o=o?`${o} or ${t.fieldName} eq '${t.lowValue}'`:`${t.fieldName} eq '${t.lowValue}'`:t.operator===w.k.Like&&(o=o?`${o} or contains(${t.fieldName},'${t.lowValue}')`:`contains(${t.fieldName},'${t.lowValue}')`)))}),e=e?`${e} and ${o}`:""+o}),e}onSearch(){const t=[];this.filters.forEach(e=>{const i={};switch(i.valueType=+e.valueType,e.valueType){case w.l.boolean:case w.l.date:case w.l.number:break;case w.l.string:i.fieldName=e.fieldName,i.operator=+e.operator,i.lowValue=e.value[0],i.highValue=e.operator===w.k.Between?e.value[1]:""}t.push(i)}),this.subjFilters.next(t)}onDisplayItem(t){this.router.navigate(["exercise-item","display",t.toString()])}onGoToPreview(){const t=[];this.dataSource.forEach(e=>{t.push({refType:w.y.ExerciseItem,refId:e.ID})}),this.odataService.previewObjList=t,this.router.navigate(["preview"])}}return t.\u0275fac=function(e){return new(e||t)(d.Pb(y.b),d.Pb(b.b))},t.\u0275cmp=d.Jb({type:t,selectors:[["app-exercise-item-search"]],viewQuery:function(t,e){if(1&t&&d.Jc(m.a,3),2&t){let t;d.tc(t=d.ec())&&(e.paginator=t.first)}},decls:44,vars:18,consts:[["class","demo-full-width",4,"ngFor","ngForOf"],[1,"control-full-width"],["mat-button","","aria-label","Search",3,"click"],[1,"table-container","mat-elevation-z8"],["color","primary"],["mat-flat-button","","color","primary",3,"click"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","itemtype"],["matColumnDef","tags"],["matColumnDef","knowledgeitem"],["matColumnDef","createdat"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],[1,"demo-full-width"],[3,"placeholder","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","ngModelChange"],[4,"ngIf"],["class","typechkbox",4,"ngIf"],["mat-button","","mat-icon-button","","aria-label","Add",3,"click"],["mat-button","","mat-icon-button","","aria-label","Clear",3,"click"],[3,"value"],["matInput","","type","number","name","lvalue_1",3,"placeholder","ngModel","ngModelChange"],["matInput","","type","number","name","hvalue_1",3,"placeholder","ngModel","ngModelChange"],["matInput","","type","text","name","lvalue_2",3,"placeholder","ngModel","ngModelChange"],["matInput","",3,"ngModel","matDatepicker","placeholder","ngModelChange"],["matSuffix","",3,"for"],["lvpicker",""],["hvpicker",""],[1,"typechkbox"],[3,"ngModel","ngModelChange"],["mat-header-cell",""],["mat-cell",""],["mat-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(d.Vb(0,"mat-card"),d.Vb(1,"mat-card-header"),d.Vb(2,"mat-card-title"),d.Ec(3),d.ic(4,"transloco"),d.Ub(),d.Vb(5,"mat-card-subtitle"),d.Ec(6),d.ic(7,"transloco"),d.Ub(),d.Ub(),d.Vb(8,"mat-card-content"),d.Vb(9,"div"),d.Dc(10,wt,22,19,"div",0),d.Vb(11,"div",1),d.Vb(12,"button",2),d.dc("click",function(){return e.onSearch()}),d.Vb(13,"mat-icon"),d.Ec(14,"search"),d.Ub(),d.Ec(15),d.ic(16,"transloco"),d.Ub(),d.Ub(),d.Ub(),d.Qb(17,"mat-divider"),d.Vb(18,"div",3),d.Vb(19,"mat-toolbar",4),d.Vb(20,"mat-toolbar-row"),d.Vb(21,"button",5),d.dc("click",function(){return e.onGoToPreview()}),d.Ec(22),d.ic(23,"transloco"),d.Ub(),d.Ub(),d.Ub(),d.Vb(24,"div",6),d.Vb(25,"table",7),d.Tb(26,8),d.Dc(27,Vt,2,0,"th",9),d.Dc(28,yt,6,4,"td",10),d.Sb(),d.Tb(29,11),d.Dc(30,Ut,3,3,"th",9),d.Dc(31,xt,3,3,"td",10),d.Sb(),d.Tb(32,12),d.Dc(33,Dt,3,3,"th",9),d.Dc(34,It,2,1,"td",10),d.Sb(),d.Tb(35,13),d.Dc(36,Mt,3,3,"th",9),d.Dc(37,Ft,2,1,"td",10),d.Sb(),d.Tb(38,14),d.Dc(39,jt,3,3,"th",9),d.Dc(40,Ot,3,4,"td",10),d.Sb(),d.Dc(41,kt,1,0,"tr",15),d.Dc(42,Tt,1,0,"tr",16),d.Ub(),d.Ub(),d.Qb(43,"mat-paginator",17),d.Ub(),d.Ub(),d.Ub()),2&t&&(d.Eb(3),d.Fc(d.jc(4,10,"ExerciseItem")),d.Eb(3),d.Fc(d.jc(7,12,"Common.Search")),d.Eb(4),d.nc("ngForOf",e.filters),d.Eb(5),d.Gc(" ",d.jc(16,14,"Common.Search")," "),d.Eb(7),d.Fc(d.jc(23,16,"Common.Preview")),d.Eb(3),d.nc("dataSource",e.dataSource),d.Eb(16),d.nc("matHeaderRowDef",e.displayedColumns),d.Eb(1),d.nc("matRowDefColumns",e.displayedColumns),d.Eb(1),d.nc("length",e.resultsLength)("pageSize",10))},directives:[z.a,z.d,z.g,z.f,z.c,o.l,x.b,Y.a,st.a,U.a,U.c,D.j,D.c,D.e,D.b,D.g,D.i,m.a,K.c,J.a,c.m,c.p,o.m,X.n,W.b,c.q,c.c,bt.d,bt.f,K.i,bt.c,dt.a,D.d,D.a,x.a,D.f,D.h],pipes:[r.d,mt.a,o.e],styles:[".table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;margin-top:16px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.data-loading-shade[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.mat-column-id[_ngcontent-%COMP%]{max-width:300px;width:250px}.mat-column-itemtype[_ngcontent-%COMP%]{max-width:120px;width:120px}.mat-column-tags[_ngcontent-%COMP%]{max-width:250px;width:150px}.mat-column-created[_ngcontent-%COMP%]{max-width:120px;width:120px}"]}),t})()}];let $t=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Nb({type:t}),t.\u0275inj=d.Mb({imports:[[b.d.forChild(St)],b.d]}),t})();var Pt=i("iasb");let Gt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Nb({type:t}),t.\u0275inj=d.Mb({providers:[],imports:[[o.c,c.h,c.r,l.a,s.a,n.b,a.b.forChild(),$t,r.c,Pt.a]]}),t})()}}]);