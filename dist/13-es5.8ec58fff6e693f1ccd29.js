!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"U+IK":function(e,n,a){"use strict";a.r(n),a.d(n,"KnowledgeItemsModule",function(){return $t});var i=a("ofXK"),c=a("3Pt+"),r=a("0LvA"),l=a("lR5k"),b=a("QPBi"),u=a("jIBr"),d=a("dcRk"),s=a("tyNb"),m=a("fXoL"),p=a("M9IT"),f=a("Dh3D"),h=a("VRyK"),g=a("LRne"),v=a("JX91"),C=a("eIep"),y=a("lJxs"),E=a("JIr8"),k=a("VHTt"),V=a("o0su"),w=a("/t3+"),F=a("bTqV"),W=a("Qu3c"),x=a("NFeN"),I=a("+0xr");function M(t,e){1&t&&(m.Wb(0,"th",17),m.Fc(1,"#"),m.Vb())}function j(t,e){if(1&t){var o=m.Xb();m.Wb(0,"td",18),m.Wb(1,"div"),m.Fc(2),m.Wb(3,"button",19),m.jc(4,"transloco"),m.Wb(5,"mat-icon"),m.Fc(6,"launch"),m.Vb(),m.Vb(),m.Wb(7,"button",20),m.jc(8,"transloco"),m.Wb(9,"mat-icon"),m.Fc(10,"edit"),m.Vb(),m.Vb(),m.Wb(11,"button",21),m.ec("click",function(){m.xc(o);var t=e.$implicit;return m.ic().onDeleteItem(t.ID)}),m.jc(12,"transloco"),m.Wb(13,"mat-icon"),m.Fc(14,"remove_circle"),m.Vb(),m.Vb(),m.Vb(),m.Vb()}if(2&t){var n=e.$implicit,a=m.ic();m.Eb(2),m.Hc(" ",n.ID," "),m.Eb(1),m.qc("routerLink","display/",n.ID,""),m.pc("matTooltip",m.kc(4,9,"Common.Display")),m.oc("disabled",!a.isExpertMode),m.Eb(4),m.qc("routerLink","edit/",n.ID,""),m.pc("matTooltip",m.kc(8,11,"Common.Change")),m.oc("disabled",!a.isExpertMode),m.Eb(4),m.pc("matTooltip",m.kc(12,13,"Common.Delete")),m.oc("disabled",!a.isExpertMode)}}function O(t,e){1&t&&(m.Wb(0,"th",17),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Category")))}function T(t,e){if(1&t&&(m.Wb(0,"td",18),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t){var o=e.$implicit,n=m.ic();m.Eb(1),m.Gc(m.kc(2,1,n.getKnowledgeItemCategoryName(o.ItemCategory)))}}function G(t,e){1&t&&(m.Wb(0,"th",17),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Title")))}function D(t,e){if(1&t&&(m.Wb(0,"td",18),m.Fc(1),m.Vb()),2&t){var o=e.$implicit;m.Eb(1),m.Gc(o.Title)}}function R(t,e){1&t&&(m.Wb(0,"th",22),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"CreatedAt")))}function S(t,e){if(1&t&&(m.Wb(0,"td",18),m.Fc(1),m.jc(2,"date"),m.Vb()),2&t){var o=e.$implicit;m.Eb(1),m.Gc(m.lc(2,1,o.CreatedAt,"yyyy-M-d HH:mm:ss"))}}function K(t,e){1&t&&m.Rb(0,"tr",23)}function $(t,e){1&t&&m.Rb(0,"tr",24)}var L,N=((L=function(){function e(o,n){t(this,e),this.odataService=o,this.router=n,this.displayedColumns=["id","category","title","createdat"],this.dataSource=[],this.resultsLength=0,this.isLoadingResults=!0,this.refreshEvent=new m.o}return o(e,[{key:"getKnowledgeItemCategoryName",value:function(t){return Object(k.F)(t)}},{key:"isExpertMode",get:function(){return this.odataService.expertMode}},{key:"ngAfterViewInit",value:function(){var t=this;this.sort.sortChange.subscribe(function(){return t.paginator.pageIndex=0}),Object(h.a)(this.sort.sortChange,this.paginator.page,this.refreshEvent).pipe(Object(v.a)({}),Object(C.a)(function(){t.isLoadingResults=!0;var e=t.paginator.pageSize;return t.odataService.getKnowledgeItems(e,e*t.paginator.pageIndex,t.sort.active,t.sort.direction)}),Object(y.a)(function(e){return t.isLoadingResults=!1,t.resultsLength=e.totalCount,e.items}),Object(E.a)(function(){return t.isLoadingResults=!1,Object(g.a)([])})).subscribe(function(e){return t.dataSource=e})}},{key:"onGoToPreview",value:function(){var t=[];this.dataSource.forEach(function(e){t.push({refType:k.z.KnowledgeItem,refId:e.ID})}),this.odataService.previewObjList=t,this.router.navigate(["preview"])}},{key:"onGoToSearch",value:function(){this.router.navigate(["knowledge-item","search"])}},{key:"onDeleteItem",value:function(t){var e=this;this.odataService.deleteExerciseItem(t).subscribe({next:function(t){e.onRefreshList()},error:function(t){console.error(t)}})}},{key:"onRefreshList",value:function(){this.refreshEvent.emit()}},{key:"resetPaging",value:function(){this.paginator.pageIndex=0}}]),e}()).\u0275fac=function(t){return new(t||L)(m.Qb(V.b),m.Qb(s.b))},L.\u0275cmp=m.Kb({type:L,selectors:[["app-knowledge-items"]],viewQuery:function(t,e){var o;1&t&&(m.Kc(p.a,1),m.Kc(f.a,1)),2&t&&(m.uc(o=m.fc())&&(e.paginator=o.first),m.uc(o=m.fc())&&(e.sort=o.first))},decls:39,vars:21,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary","routerLink","create",3,"disabled","matTooltip"],["mat-icon-button","","color","accent","matTooltip","'Common.Search' | transloco}}",3,"disabled","click"],["mat-icon-button","","color","accent",3,"disabled","matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"example-table-container"],["mat-table","","matSort","",1,"example-table",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","category"],["matColumnDef","title"],["matColumnDef","createdat"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"disabled","routerLink","matTooltip"],["mat-icon-button","","color","accent",3,"disabled","routerLink","matTooltip"],["mat-icon-button","","color","warn",3,"disabled","matTooltip","click"],["mat-header-cell","","mat-sort-header",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(m.Wb(0,"mat-toolbar-row"),m.Wb(1,"span"),m.Fc(2),m.jc(3,"transloco"),m.Vb(),m.Rb(4,"span",0),m.Wb(5,"section"),m.Wb(6,"button",1),m.jc(7,"transloco"),m.Wb(8,"mat-icon"),m.Fc(9,"add_circle"),m.Vb(),m.Vb(),m.Wb(10,"button",2),m.ec("click",function(){return e.onGoToSearch()}),m.Wb(11,"mat-icon"),m.Fc(12,"search"),m.Vb(),m.Vb(),m.Wb(13,"button",3),m.ec("click",function(){return e.onGoToPreview()}),m.jc(14,"transloco"),m.Wb(15,"mat-icon"),m.Fc(16,"slideshow"),m.Vb(),m.Vb(),m.Wb(17,"button",3),m.ec("click",function(){return e.onRefreshList()}),m.jc(18,"transloco"),m.Wb(19,"mat-icon"),m.Fc(20,"refresh"),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(21,"div",4),m.Wb(22,"div",5),m.Wb(23,"table",6),m.ec("matSortChange",function(){return e.resetPaging()}),m.Ub(24,7),m.Ec(25,M,2,0,"th",8),m.Ec(26,j,15,15,"td",9),m.Tb(),m.Ub(27,10),m.Ec(28,O,3,3,"th",8),m.Ec(29,T,3,3,"td",9),m.Tb(),m.Ub(30,11),m.Ec(31,G,3,3,"th",8),m.Ec(32,D,2,1,"td",9),m.Tb(),m.Ub(33,12),m.Ec(34,R,3,3,"th",13),m.Ec(35,S,3,4,"td",9),m.Tb(),m.Ec(36,K,1,0,"tr",14),m.Ec(37,$,1,0,"tr",15),m.Vb(),m.Vb(),m.Rb(38,"mat-paginator",16),m.Vb()),2&t&&(m.Eb(2),m.Gc(m.kc(3,13,"KnowledgeItem")),m.Eb(4),m.pc("matTooltip",m.kc(7,15,"Common.Create")),m.oc("disabled",!e.isExpertMode),m.Eb(4),m.oc("disabled",!e.isExpertMode||e.dataSource.length<=0),m.Eb(3),m.pc("matTooltip",m.kc(14,17,"Common.Preview")),m.oc("disabled",!e.isExpertMode||e.dataSource.length<=0),m.Eb(4),m.pc("matTooltip",m.kc(18,19,"Common.Refresh")),m.oc("disabled",!e.isExpertMode),m.Eb(6),m.oc("dataSource",e.dataSource),m.Eb(13),m.oc("matHeaderRowDef",e.displayedColumns),m.Eb(1),m.oc("matRowDefColumns",e.displayedColumns),m.Eb(1),m.oc("length",e.resultsLength)("pageSize",20))},directives:[w.c,F.b,s.c,W.a,x.a,I.j,f.a,I.c,I.e,I.b,I.g,I.i,p.a,I.d,I.a,f.b,I.f,I.h],pipes:[b.d,i.e],styles:[".example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.example-container[_ngcontent-%COMP%]{position:relative;min-height:500px}.example-table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.example-loading-shade[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.mat-column-id[_ngcontent-%COMP%]{max-width:100px}.mat-column-createdat[_ngcontent-%COMP%]{max-width:124px}"]}),L),P=a("jtHE"),A=a("FtGj"),H=a("rCpU"),_=a("HKRH"),U=a("0IaG"),z=a("Wp6s"),X=a("kmnG"),Q=a("qFsG"),q=a("d3UM"),B=a("A5z7"),J=a("XiUz"),Y=a("FKr1");function Z(t,e){if(1&t&&(m.Wb(0,"mat-option",21),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.value),m.Eb(1),m.Gc(m.kc(2,2,o.i18nterm))}}function tt(t,e){1&t&&(m.Wb(0,"mat-icon",24),m.Fc(1,"cancel"),m.Vb())}function et(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-chip",22),m.ec("removed",function(){m.xc(o);var t=e.$implicit;return m.ic().removeTag(t)}),m.Fc(1),m.Ec(2,tt,2,0,"mat-icon",23),m.Vb()}if(2&t){var n=e.$implicit,a=m.ic();m.oc("selectable",a.selectable)("removable",a.isEditable),m.Eb(1),m.Hc(" ",n," "),m.Eb(1),m.oc("ngIf",a.isEditable)}}function ot(t,e){if(1&t&&(m.Wb(0,"div",25),m.Wb(1,"div",26),m.Wb(2,"mat-form-field",6),m.Wb(3,"mat-label"),m.Fc(4),m.jc(5,"transloco"),m.Vb(),m.Rb(6,"input",27),m.jc(7,"transloco"),m.jc(8,"date"),m.Vb(),m.Vb(),m.Wb(9,"div",26),m.Wb(10,"mat-form-field",6),m.Wb(11,"mat-label"),m.Fc(12),m.jc(13,"transloco"),m.Vb(),m.Rb(14,"input",27),m.jc(15,"transloco"),m.jc(16,"date"),m.Vb(),m.Vb(),m.Vb()),2&t){var o=m.ic();m.Eb(4),m.Gc(m.kc(5,6,"CreatedAt")),m.Eb(2),m.pc("placeholder",m.kc(7,8,"CreatedAt")),m.oc("ngModel",m.lc(8,10,o.currentItem.CreatedAt,"yyyy-M-d HH:mm:ss")),m.Eb(6),m.Gc(m.kc(13,13,"ModifiedAt")),m.Eb(2),m.pc("placeholder",m.kc(15,15,"ModifiedAt")),m.oc("ngModel",m.lc(16,17,o.currentItem.ModifiedAt,"yyyy-M-d HH:mm:ss"))}}function nt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-toolbar"),m.Wb(1,"h3"),m.Fc(2),m.jc(3,"transloco"),m.Vb(),m.Rb(4,"div",28),m.Wb(5,"button",29),m.ec("click",function(){return m.xc(o),m.ic().openUploadDialog()}),m.Wb(6,"mat-icon"),m.Fc(7,"file_upload"),m.Vb(),m.Vb(),m.Vb()}2&t&&(m.Eb(2),m.Gc(m.kc(3,1,"Content")))}function at(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div",26),m.Wb(1,"ngx-monaco-editor",30),m.ec("ngModelChange",function(t){return m.xc(o),m.ic().content=t}),m.Vb(),m.Vb()}if(2&t){var n=m.ic();m.Eb(1),m.oc("options",n.editorOptions)("ngModel",n.content)}}var it,ct=((it=function(){function e(o,n,a,i){t(this,e),this.dialog=o,this.activateRoute=n,this.router=a,this.odataService=i,this.routerID=-1,this.uiMode=H.b.Create,this.currentMode="",this.editorOptions={theme:"vs-dark",wordWrap:"on"},this.content="New Knowledge Item",this.mathOptions={displayMode:!0,throwOnError:!1,errorColor:"#cc0000"},this.selectable=!0,this.addOnBlur=!0,this.separatorKeysCodes=[A.g,A.c],this.tags=[],this.arKnowledgeCtgies=[],this.arKnowledgeCtgies=Object(k.G)(),this.itemFormGroup=new c.f({idControl:new c.d({value:null,disabled:!0}),titleControl:new c.d("",c.t.required),ctgyControl:new c.d({value:k.p.Concept}),tagControl:new c.d})}return o(e,[{key:"isDisplayMode",get:function(){return this.uiMode===H.b.Display}},{key:"isCreateMode",get:function(){return this.uiMode===H.b.Create}},{key:"isUpdateMode",get:function(){return this.uiMode===H.b.Update}},{key:"isEditable",get:function(){return this.uiMode===H.b.Create||this.uiMode===H.b.Update}},{key:"ngOnInit",value:function(){var t=this;this.destroyed$=new P.a(1),this.activateRoute.url.subscribe({next:function(e){var o,n;e instanceof Array&&e.length>0&&("create"===e[0].path?(t.routerID=-1,t.uiMode=H.b.Create,t.currentMode="Common.Create"):"edit"===e[0].path?(t.routerID=+e[1].path,t.uiMode=H.b.Update,t.currentMode="Common.Change"):"display"===e[0].path&&(t.routerID=+e[1].path,t.uiMode=H.b.Display,t.currentMode="Common.Display")),-1!==t.routerID?t.odataService.readKnowledgeItem(t.routerID,t.uiMode===H.b.Update).subscribe({next:function(e){var o,n,a;null===(o=t.itemFormGroup.get("idControl"))||void 0===o||o.setValue(e.ID),null===(n=t.itemFormGroup.get("titleControl"))||void 0===n||n.setValue(e.Title),null===(a=t.itemFormGroup.get("ctgyControl"))||void 0===a||a.setValue(+e.ItemCategory),t.content=e.Content,t.tags=e.Tags,t.currentItem=e,t.isDisplayMode?t.itemFormGroup.disable():t.itemFormGroup.markAsPristine()},error:function(t){console.error(t)}}):(null===(o=t.itemFormGroup.get("idControl"))||void 0===o||o.setValue("NEW"),null===(n=t.itemFormGroup.get("idControl"))||void 0===n||n.disable(),t.itemFormGroup.markAsPristine(),t.itemFormGroup.markAsUntouched())},error:function(t){console.error(t)}})}},{key:"ngOnDestroy",value:function(){this.destroyed$&&(this.destroyed$.complete(),this.destroyed$=void 0)}},{key:"onOK",value:function(){var t,e,o,n,a=this;if(this.isCreateMode){if(!this.itemFormGroup.valid)return void(this.itemFormGroup.errors&&console.log(this.itemFormGroup.errors));var i=new k.o;i.ItemCategory=null===(t=this.itemFormGroup.get("ctgyControl"))||void 0===t?void 0:t.value,i.Content=this.content,i.Title=null===(e=this.itemFormGroup.get("titleControl"))||void 0===e?void 0:e.value,i.Tags=this.tags,this.odataService.createKnowledgeItem(i).subscribe({next:function(t){a.router.navigate(["knowledge-item/display",t.ID])},error:function(t){console.error(t)}})}else if(this.isUpdateMode){if(!this.itemFormGroup.valid)return void(this.itemFormGroup.errors&&console.log(this.itemFormGroup.errors));this.currentItem&&(this.currentItem.ItemCategory=null===(o=this.itemFormGroup.get("ctgyControl"))||void 0===o?void 0:o.value,this.currentItem.Content=this.content,this.currentItem.Title=null===(n=this.itemFormGroup.get("titleControl"))||void 0===n?void 0:n.value,this.currentItem.Tags=this.tags,this.odataService.changeKnowledgeItem(this.currentItem).subscribe({next:function(t){a.router.navigate(["knowledge-item/display",t.ID])},error:function(t){console.error(t)}}))}}},{key:"openUploadDialog",value:function(){var t=this;this.dialog.open(_.a,{width:"50%",height:"50%"}).afterClosed().subscribe({next:function(e){console.log(e),e.forEach(function(e){t.content+="\n![Img](".concat(e.url,")\n          ")})}})}},{key:"addTag",value:function(t){var e=t.input,o=t.value;(o||"").trim()&&this.tags.push(o.trim()),e&&(e.value="")}},{key:"removeTag",value:function(t){var e=this.tags.indexOf(t);e>=0&&this.tags.splice(e,1)}},{key:"onReturnToList",value:function(){this.router.navigate(["knowledge-item"])}},{key:"onCreateNewOne",value:function(){this.router.navigate(["knowledge-item","create"])}}]),e}()).\u0275fac=function(t){return new(t||it)(m.Qb(U.b),m.Qb(s.a),m.Qb(s.b),m.Qb(V.b))},it.\u0275cmp=m.Kb({type:it,selectors:[["app-knowledge-item-detail"]],decls:50,vars:38,consts:[[3,"formGroup"],[1,"control-full-width"],["matInput","","type","text","placeholder","#","formControlName","idControl"],["matInput","","type","text","formControlName","titleControl","required","","name","title","maxlength","30",3,"placeholder"],["title",""],["align","end"],["appearance","fill",1,"control-full-width"],["required","","formControlName","ctgyControl"],[3,"value",4,"ngFor","ngForOf"],["formControlName","tagControl"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","New tag...",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["fxLayout","row","class","control-full-width",4,"ngIf"],[4,"ngIf"],["fxLayout","row",1,"control-full-width",2,"height","500px"],["fxFlex","50",4,"ngIf"],["fxFlex","",2,"height","100%","overflow-y","scroll"],["katex","",3,"data","katexOptions"],["mat-button","",3,"disabled","click"],["mat-button","",3,"click"],[3,"value"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],["fxLayout","row",1,"control-full-width"],["fxFlex","50"],["matInput","","type","text","disabled","",3,"placeholder","ngModel"],[1,"toolbar-spacer"],["mat-raised-button","",3,"click"],[2,"height","100%",3,"options","ngModel","ngModelChange"]],template:function(t,e){if(1&t&&(m.Wb(0,"mat-card"),m.Wb(1,"mat-card-header"),m.Wb(2,"mat-card-title"),m.Fc(3),m.jc(4,"transloco"),m.Vb(),m.Wb(5,"mat-card-subtitle"),m.Fc(6),m.jc(7,"transloco"),m.Vb(),m.Vb(),m.Wb(8,"mat-card-content"),m.Wb(9,"form",0),m.Wb(10,"mat-form-field",1),m.Wb(11,"mat-label"),m.Fc(12,"#"),m.Vb(),m.Rb(13,"input",2),m.Vb(),m.Wb(14,"mat-form-field",1),m.Rb(15,"input",3,4),m.jc(17,"transloco"),m.Wb(18,"mat-hint",5),m.Fc(19),m.Vb(),m.Vb(),m.Wb(20,"mat-form-field",6),m.Wb(21,"mat-label"),m.Fc(22),m.jc(23,"transloco"),m.Vb(),m.Wb(24,"mat-select",7),m.Ec(25,Z,3,4,"mat-option",8),m.Vb(),m.Vb(),m.Wb(26,"mat-form-field",6),m.Wb(27,"mat-label"),m.Fc(28),m.jc(29,"transloco"),m.Vb(),m.Wb(30,"mat-chip-list",9,10),m.Ec(32,et,3,4,"mat-chip",11),m.Wb(33,"input",12),m.ec("matChipInputTokenEnd",function(t){return e.addTag(t)}),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Ec(34,ot,17,20,"div",13),m.Ec(35,nt,8,3,"mat-toolbar",14),m.Wb(36,"div",15),m.Ec(37,at,2,2,"div",16),m.Wb(38,"div",17),m.Rb(39,"markdown",18),m.Vb(),m.Vb(),m.Vb(),m.Wb(40,"mat-card-actions"),m.Wb(41,"button",19),m.ec("click",function(){return e.onOK()}),m.Fc(42),m.jc(43,"transloco"),m.Vb(),m.Wb(44,"button",20),m.ec("click",function(){return e.onReturnToList()}),m.Fc(45),m.jc(46,"transloco"),m.Vb(),m.Wb(47,"button",19),m.ec("click",function(){return e.onCreateNewOne()}),m.Fc(48),m.jc(49,"transloco"),m.Vb(),m.Vb(),m.Vb()),2&t){var o=m.vc(16),n=m.vc(31);m.Eb(3),m.Gc(m.kc(4,22,"KnowledgeItem")),m.Eb(3),m.Gc(m.kc(7,24,e.currentMode)),m.Eb(3),m.oc("formGroup",e.itemFormGroup),m.Eb(6),m.pc("placeholder",m.kc(17,26,"Title")),m.Eb(4),m.Hc("",o.value.length," / 30"),m.Eb(3),m.Gc(m.kc(23,28,"Category")),m.Eb(3),m.oc("ngForOf",e.arKnowledgeCtgies),m.Eb(3),m.Gc(m.kc(29,30,"Tags")),m.Eb(4),m.oc("ngForOf",e.tags),m.Eb(1),m.oc("matChipInputFor",n)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes)("matChipInputAddOnBlur",e.addOnBlur),m.Eb(1),m.oc("ngIf",!e.isCreateMode&&e.currentItem),m.Eb(1),m.oc("ngIf",e.isCreateMode),m.Eb(2),m.oc("ngIf",!e.isDisplayMode),m.Eb(2),m.oc("data",e.content)("katexOptions",e.mathOptions),m.Eb(2),m.oc("disabled",!(e.isEditable&&e.itemFormGroup.valid)),m.Eb(1),m.Gc(m.kc(43,32,"Save")),m.Eb(3),m.Gc(m.kc(46,34,"Common.ReturnToList")),m.Eb(2),m.oc("disabled",!e.isDisplayMode),m.Eb(1),m.Gc(m.kc(49,36,"Common.CreateAnotherOne"))}},directives:[z.a,z.d,z.g,z.f,z.c,c.u,c.n,c.g,X.c,X.g,Q.b,c.c,c.m,c.e,c.s,c.i,X.f,q.a,i.l,B.c,B.b,i.m,J.c,J.a,l.a,z.b,F.b,Y.n,B.a,x.a,B.d,c.p,w.a,r.a],pipes:[b.d,i.e],styles:[".example-form[_ngcontent-%COMP%]{margin:8px;min-width:150px;max-width:500px;width:100%}.mat-card-actions[_ngcontent-%COMP%]{margin-top:50px}"]}),it),rt=a("2Vo4"),lt=a("nYR2"),bt=a("f0Cb"),ut=a("iadO"),dt=a("bSwM"),st=a("pFkP");function mt(t,e){if(1&t&&(m.Wb(0,"mat-option",25),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.value),m.Eb(1),m.Hc(" ",m.kc(2,2,o.displayas)," ")}}function pt(t,e){if(1&t&&(m.Wb(0,"mat-option",25),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.value),m.Eb(1),m.Hc(" ",m.kc(2,2,o.i18nterm)," ")}}function ft(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-form-field"),m.Wb(1,"input",26),m.ec("ngModelChange",function(t){return m.xc(o),m.ic().$implicit.value[0]=t}),m.jc(2,"transloco"),m.Vb(),m.Vb()}if(2&t){var n=m.ic().$implicit;m.Eb(1),m.pc("placeholder",m.kc(2,2,"Value")),m.oc("ngModel",n.value[0])}}function ht(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-form-field"),m.Wb(1,"input",27),m.ec("ngModelChange",function(t){return m.xc(o),m.ic().$implicit.value[1]=t}),m.jc(2,"transloco"),m.Vb(),m.Vb()}if(2&t){var n=m.ic().$implicit;m.Eb(1),m.pc("placeholder",m.kc(2,2,"Value")),m.oc("ngModel",n.value[1])}}function gt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-form-field"),m.Wb(1,"input",28),m.ec("ngModelChange",function(t){return m.xc(o),m.ic().$implicit.value[0]=t}),m.jc(2,"transloco"),m.Vb(),m.Vb()}if(2&t){var n=m.ic().$implicit;m.Eb(1),m.pc("placeholder",m.kc(2,2,"Value")),m.oc("ngModel",n.value[0])}}function vt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-form-field"),m.Wb(1,"input",29),m.ec("ngModelChange",function(t){return m.xc(o),m.ic().$implicit.value[0]=t}),m.jc(2,"transloco"),m.Vb(),m.Rb(3,"mat-datepicker-toggle",30),m.Rb(4,"mat-datepicker",null,31),m.Vb()}if(2&t){var n=m.vc(5),a=m.ic().$implicit;m.Eb(1),m.pc("placeholder",m.kc(2,4,"Value")),m.oc("ngModel",a.value[0])("matDatepicker",n),m.Eb(2),m.oc("for",n)}}function Ct(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-form-field"),m.Wb(1,"input",29),m.ec("ngModelChange",function(t){return m.xc(o),m.ic().$implicit.value[1]=t}),m.jc(2,"transloco"),m.Vb(),m.Rb(3,"mat-datepicker-toggle",30),m.Rb(4,"mat-datepicker",null,32),m.Vb()}if(2&t){var n=m.vc(5),a=m.ic().$implicit;m.Eb(1),m.pc("placeholder",m.kc(2,4,"Value")),m.oc("ngModel",a.value[1])("matDatepicker",n),m.Eb(2),m.oc("for",n)}}function yt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div",33),m.Wb(1,"mat-checkbox",34),m.ec("ngModelChange",function(t){return m.xc(o),m.ic().$implicit.value[0]=t}),m.Vb(),m.Vb()}if(2&t){var n=m.ic().$implicit;m.Eb(1),m.oc("ngModel",n.value[0])}}function Et(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div",17),m.Wb(1,"mat-form-field"),m.Wb(2,"mat-select",18),m.ec("ngModelChange",function(t){return e.$implicit.fieldName=t})("selectionChange",function(){m.xc(o);var t=e.$implicit;return m.ic().onFieldSelectionChanged(t)}),m.jc(3,"transloco"),m.Ec(4,mt,3,4,"mat-option",19),m.Vb(),m.Vb(),m.Wb(5,"mat-form-field"),m.Wb(6,"mat-select",20),m.ec("ngModelChange",function(t){return e.$implicit.operator=t}),m.jc(7,"transloco"),m.Ec(8,pt,3,4,"mat-option",19),m.jc(9,"operatorFilter"),m.Vb(),m.Vb(),m.Ec(10,ft,3,4,"mat-form-field",21),m.Ec(11,ht,3,4,"mat-form-field",21),m.Ec(12,gt,3,4,"mat-form-field",21),m.Ec(13,vt,6,6,"mat-form-field",21),m.Ec(14,Ct,6,6,"mat-form-field",21),m.Ec(15,yt,2,1,"div",22),m.Wb(16,"button",23),m.ec("click",function(){return m.xc(o),m.ic().onAddFilter()}),m.Wb(17,"mat-icon"),m.Fc(18,"add"),m.Vb(),m.Vb(),m.Wb(19,"button",24),m.ec("click",function(){m.xc(o);var t=e.index;return m.ic().onRemoveFilter(t)}),m.Wb(20,"mat-icon"),m.Fc(21,"close"),m.Vb(),m.Vb(),m.Vb()}if(2&t){var n=e.$implicit,a=m.ic();m.Eb(2),m.pc("placeholder",m.kc(3,12,"Field")),m.oc("ngModel",n.fieldName),m.Eb(2),m.oc("ngForOf",a.allFields),m.Eb(2),m.pc("placeholder",m.kc(7,14,"Operator")),m.oc("ngModel",n.operator),m.Eb(2),m.oc("ngForOf",m.lc(9,16,a.allOperators,n.valueType)),m.Eb(2),m.oc("ngIf",1===n.valueType),m.Eb(1),m.oc("ngIf",1===n.valueType),m.Eb(1),m.oc("ngIf",2===n.valueType),m.Eb(1),m.oc("ngIf",3===n.valueType),m.Eb(1),m.oc("ngIf",3===n.valueType),m.Eb(1),m.oc("ngIf",4===n.valueType)}}function kt(t,e){1&t&&(m.Wb(0,"th",35),m.Fc(1,"#"),m.Vb())}function Vt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"td",36),m.Wb(1,"div"),m.Fc(2),m.Wb(3,"a",37),m.ec("click",function(){m.xc(o);var t=e.$implicit;return m.ic().onDisplayItem(t.ID)}),m.Fc(4),m.jc(5,"transloco"),m.Vb(),m.Vb(),m.Vb()}if(2&t){var n=e.$implicit;m.Eb(2),m.Hc(" ",n.ID," "),m.Eb(2),m.Gc(m.kc(5,2,"Common.Display"))}}function wt(t,e){1&t&&(m.Wb(0,"th",35),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Category")))}function Ft(t,e){if(1&t&&(m.Wb(0,"td",36),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t){var o=e.$implicit,n=m.ic();m.Eb(1),m.Gc(m.kc(2,1,n.getKnowledgeItemCategoryName(o.ItemCategory)))}}function Wt(t,e){1&t&&(m.Wb(0,"th",35),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"Title")))}function xt(t,e){if(1&t&&(m.Wb(0,"td",36),m.Fc(1),m.Vb()),2&t){var o=e.$implicit;m.Eb(1),m.Gc(o.Title)}}function It(t,e){1&t&&(m.Wb(0,"th",35),m.Fc(1),m.jc(2,"transloco"),m.Vb()),2&t&&(m.Eb(1),m.Gc(m.kc(2,1,"CreatedAt")))}function Mt(t,e){if(1&t&&(m.Wb(0,"td",36),m.Fc(1),m.jc(2,"date"),m.Vb()),2&t){var o=e.$implicit;m.Eb(1),m.Gc(m.lc(2,1,o.CreatedAt,"yyyy-M-d HH:mm:ss"))}}function jt(t,e){1&t&&m.Rb(0,"tr",38)}function Ot(t,e){1&t&&m.Rb(0,"tr",39)}var Tt,Gt,Dt,Rt=[{path:"",component:N},{path:"create",component:ct},{path:"display/:id",component:ct},{path:"edit/:id",component:ct},{path:"search",component:(Tt=function(){function e(o,n){t(this,e),this.odataService=o,this.router=n,this.filters=[],this.allOperators=[],this.allFields=[],this.filterEditable=!0,this.pageSize=20,this.pageSizeOptions=[20,40,60,100],this.isLoadingResults=!1,this.subjFilters=new rt.a([]),this.displayedColumns=["id","category","title","createdat"],this.dataSource=[],this.resultsLength=0,this.allOperators=k.A.getGeneralFilterOperatorDisplayStrings(),this.allFields=[{displayas:"Content",value:"Content",valueType:2}]}return o(e,[{key:"ngOnInit",value:function(){this.onAddFilter()}},{key:"ngAfterViewInit",value:function(){var t=this;this.subjFilters.subscribe(function(){return t.paginator.pageIndex=0}),Object(h.a)(this.subjFilters,this.paginator.page).pipe(Object(v.a)({}),Object(C.a)(function(){if(t.subjFilters.value.length<=0)return Object(g.a)([]);t.isLoadingResults=!0;var e=t.prepareFilters(t.subjFilters.value),o=t.paginator.pageSize;return t.odataService.getKnowledgeItems(o,o*t.paginator.pageIndex,void 0,void 0,e)}),Object(lt.a)(function(){return t.isLoadingResults=!1}),Object(y.a)(function(e){return t.resultsLength=e.totalCount,e.items}),Object(E.a)(function(){return Object(g.a)(void 0)})).subscribe({next:function(e){return t.dataSource=e},error:function(t){return console.log(t)}})}},{key:"getKnowledgeItemCategoryName",value:function(t){return Object(k.F)(t)}},{key:"onAddFilter",value:function(){this.filters.push(new k.k)}},{key:"onRemoveFilter",value:function(t){this.filters.splice(t,1),0===this.filters.length&&this.onAddFilter()}},{key:"onFieldSelectionChanged",value:function(t){this.allFields.forEach(function(e){e.value===t.fieldName&&(t.valueType=e.valueType)})}},{key:"prepareFilters",value:function(t){var e="";return t.sort(function(t,e){return t.fieldName.localeCompare(e.fieldName)}),t.forEach(function(t){"Content"===t.fieldName&&(t.operator===k.l.Equal?e=e?"".concat(e," and ").concat(t.fieldName," eq '").concat(t.lowValue,"'"):"".concat(t.fieldName," eq '").concat(t.lowValue,"'"):t.operator===k.l.Like&&(e=e?"".concat(e," and contains(").concat(t.fieldName,",'").concat(t.lowValue,"')"):"contains(".concat(t.fieldName,",'").concat(t.lowValue,"')")))}),e}},{key:"onSearch",value:function(){var t=[];this.filters.forEach(function(e){var o={};switch(o.valueType=+e.valueType,e.valueType){case k.m.boolean:case k.m.date:case k.m.number:break;case k.m.string:o.fieldName=e.fieldName,o.operator=+e.operator,o.lowValue=e.value[0],o.highValue=e.operator===k.l.Between?e.value[1]:""}t.push(o)}),this.subjFilters.next(t)}},{key:"onDisplayItem",value:function(t){this.router.navigate(["knowledge-item","display",t.toString()])}},{key:"onGoToPreview",value:function(){var t=[];this.dataSource.forEach(function(e){t.push({refType:k.z.KnowledgeItem,refId:e.ID})}),this.odataService.previewObjList=t,this.router.navigate(["preview"])}}]),e}(),Tt.\u0275fac=function(t){return new(t||Tt)(m.Qb(V.b),m.Qb(s.b))},Tt.\u0275cmp=m.Kb({type:Tt,selectors:[["app-knowledge-item-search"]],viewQuery:function(t,e){var o;1&t&&m.Kc(p.a,3),2&t&&m.uc(o=m.fc())&&(e.paginator=o.first)},decls:41,vars:18,consts:[["class","demo-full-width",4,"ngFor","ngForOf"],[1,"control-full-width"],["mat-button","","aria-label","Search",3,"click"],[1,"table-container","mat-elevation-z8"],["color","primary"],["mat-flat-button","","color","primary",3,"click"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","category"],["matColumnDef","title"],["matColumnDef","createdat"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],[1,"demo-full-width"],[3,"placeholder","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","ngModelChange"],[4,"ngIf"],["class","typechkbox",4,"ngIf"],["mat-button","","mat-icon-button","","aria-label","Add",3,"click"],["mat-button","","mat-icon-button","","aria-label","Clear",3,"click"],[3,"value"],["matInput","","type","number","name","lvalue_1",3,"placeholder","ngModel","ngModelChange"],["matInput","","type","number","name","hvalue_1",3,"placeholder","ngModel","ngModelChange"],["matInput","","type","text","name","lvalue_2",3,"placeholder","ngModel","ngModelChange"],["matInput","",3,"ngModel","matDatepicker","placeholder","ngModelChange"],["matSuffix","",3,"for"],["lvpicker",""],["hvpicker",""],[1,"typechkbox"],[3,"ngModel","ngModelChange"],["mat-header-cell",""],["mat-cell",""],["mat-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(m.Wb(0,"mat-card"),m.Wb(1,"mat-card-header"),m.Wb(2,"mat-card-title"),m.Fc(3),m.jc(4,"transloco"),m.Vb(),m.Wb(5,"mat-card-subtitle"),m.Fc(6),m.jc(7,"transloco"),m.Vb(),m.Vb(),m.Wb(8,"mat-card-content"),m.Wb(9,"div"),m.Ec(10,Et,22,19,"div",0),m.Wb(11,"div",1),m.Wb(12,"button",2),m.ec("click",function(){return e.onSearch()}),m.Wb(13,"mat-icon"),m.Fc(14,"search"),m.Vb(),m.Fc(15),m.jc(16,"transloco"),m.Vb(),m.Vb(),m.Vb(),m.Rb(17,"mat-divider"),m.Wb(18,"div",3),m.Wb(19,"mat-toolbar",4),m.Wb(20,"mat-toolbar-row"),m.Wb(21,"button",5),m.ec("click",function(){return e.onGoToPreview()}),m.Fc(22),m.jc(23,"transloco"),m.Vb(),m.Vb(),m.Vb(),m.Wb(24,"div",6),m.Wb(25,"table",7),m.Ub(26,8),m.Ec(27,kt,2,0,"th",9),m.Ec(28,Vt,6,4,"td",10),m.Tb(),m.Ub(29,11),m.Ec(30,wt,3,3,"th",9),m.Ec(31,Ft,3,3,"td",10),m.Tb(),m.Ub(32,12),m.Ec(33,Wt,3,3,"th",9),m.Ec(34,xt,2,1,"td",10),m.Tb(),m.Ub(35,13),m.Ec(36,It,3,3,"th",9),m.Ec(37,Mt,3,4,"td",10),m.Tb(),m.Ec(38,jt,1,0,"tr",14),m.Ec(39,Ot,1,0,"tr",15),m.Vb(),m.Vb(),m.Rb(40,"mat-paginator",16),m.Vb(),m.Vb(),m.Vb()),2&t&&(m.Eb(3),m.Gc(m.kc(4,10,"KnowledgeItem")),m.Eb(3),m.Gc(m.kc(7,12,"Common.Search")),m.Eb(4),m.oc("ngForOf",e.filters),m.Eb(5),m.Hc(" ",m.kc(16,14,"Common.Search")," "),m.Eb(7),m.Gc(m.kc(23,16,"Common.Preview")),m.Eb(3),m.oc("dataSource",e.dataSource),m.Eb(13),m.oc("matHeaderRowDef",e.displayedColumns),m.Eb(1),m.oc("matRowDefColumns",e.displayedColumns),m.Eb(1),m.oc("length",e.resultsLength)("pageSize",20))},directives:[z.a,z.d,z.g,z.f,z.c,i.l,F.b,x.a,bt.a,w.a,w.c,I.j,I.c,I.e,I.b,I.g,I.i,p.a,X.c,q.a,c.m,c.p,i.m,Y.n,Q.b,c.q,c.c,ut.d,ut.f,X.i,ut.c,dt.a,I.d,I.a,F.a,I.f,I.h],pipes:[b.d,st.a,i.e],styles:[".table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;margin-top:16px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.data-loading-shade[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.mat-column-id[_ngcontent-%COMP%]{max-width:300px;width:250px}.mat-column-itemtype[_ngcontent-%COMP%]{max-width:120px;width:120px}.mat-column-tags[_ngcontent-%COMP%]{max-width:250px;width:150px}.mat-column-created[_ngcontent-%COMP%]{max-width:120px;width:120px}"]}),Tt)}],St=((Gt=function e(){t(this,e)}).\u0275fac=function(t){return new(t||Gt)},Gt.\u0275mod=m.Ob({type:Gt}),Gt.\u0275inj=m.Nb({imports:[[s.e.forChild(Rt)],s.e]}),Gt),Kt=a("iasb"),$t=((Dt=function e(){t(this,e)}).\u0275fac=function(t){return new(t||Dt)},Dt.\u0275mod=m.Ob({type:Dt}),Dt.\u0275inj=m.Nb({providers:[],imports:[[i.c,c.h,c.r,u.a,d.a,r.b,l.b.forChild(),St,b.c,Kt.a]]}),Dt)}}])}();