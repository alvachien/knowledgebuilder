(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{V7M2:function(t,e,o){"use strict";o.r(e),o.d(e,"ExerciseItemsModule",function(){return Lt});var c=o("ofXK"),i=o("3Pt+"),a=o("0LvA"),n=o("lR5k"),r=o("QPBi"),l=o("jIBr"),s=o("dcRk"),b=o("tyNb"),m=o("fXoL"),d=o("M9IT"),u=o("Dh3D"),h=o("VRyK"),p=o("LRne"),g=o("JX91"),f=o("eIep"),C=o("nYR2"),S=o("lJxs"),T=o("JIr8"),v=o("VHTt"),w=o("NUjs"),y=o("o0su"),x=o("/t3+"),D=o("bTqV"),O=o("+0xr");function I(t,e){1&t&&(m.Tb(0,"th",18),m.Ec(1,"#"),m.Sb())}function F(t,e){if(1&t){const t=m.Ub();m.Tb(0,"td",19),m.Tb(1,"div"),m.Ec(2),m.Tb(3,"a",20),m.bc("click",function(){m.uc(t);const o=e.$implicit;return m.fc().onDisplayItem(o.ID)}),m.Ec(4),m.gc(5,"transloco"),m.Sb(),m.Tb(6,"a",20),m.bc("click",function(){m.uc(t);const o=e.$implicit;return m.fc().onChangeItem(o.ID)}),m.Ec(7),m.gc(8,"transloco"),m.Sb(),m.Tb(9,"a",20),m.bc("click",function(){m.uc(t);const o=e.$implicit;return m.fc().onDeleteItem(o.ID)}),m.Ec(10),m.gc(11,"transloco"),m.Sb(),m.Sb(),m.Sb()}if(2&t){const t=e.$implicit;m.Cb(2),m.Gc(" ",t.ID," "),m.Cb(2),m.Fc(m.hc(5,4,"Common.Display")),m.Cb(3),m.Fc(m.hc(8,6,"Common.Change")),m.Cb(3),m.Fc(m.hc(11,8,"Common.Delete"))}}function E(t,e){1&t&&(m.Tb(0,"th",18),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t&&(m.Cb(1),m.Fc(m.hc(2,1,"Type")))}function M(t,e){if(1&t&&(m.Tb(0,"td",19),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t){const t=e.$implicit,o=m.fc();m.Cb(1),m.Fc(m.hc(2,1,o.getExerciseItemTypeName(t.ItemType)))}}function k(t,e){1&t&&(m.Tb(0,"th",18),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t&&(m.Cb(1),m.Fc(m.hc(2,1,"Tag")))}function $(t,e){if(1&t&&(m.Tb(0,"td",19),m.Ec(1),m.Sb()),2&t){const t=e.$implicit;m.Cb(1),m.Fc(t.Tags.toString())}}function j(t,e){1&t&&(m.Tb(0,"th",18),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t&&(m.Cb(1),m.Fc(m.hc(2,1,"KnowledgeItem")))}function R(t,e){if(1&t&&(m.Tb(0,"td",19),m.Ec(1),m.Sb()),2&t){const t=e.$implicit;m.Cb(1),m.Fc(t.KnowledgeItemID)}}function N(t,e){1&t&&(m.Tb(0,"th",21),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t&&(m.Cb(1),m.Fc(m.hc(2,1,"CreatedAt")))}function G(t,e){if(1&t&&(m.Tb(0,"td",19),m.Ec(1),m.gc(2,"date"),m.Sb()),2&t){const t=e.$implicit;m.Cb(1),m.Fc(m.ic(2,1,t.CreatedAt,"yyyy-M-d HH:mm:ss"))}}function L(t,e){1&t&&m.Ob(0,"tr",22)}function A(t,e){1&t&&m.Ob(0,"tr",23)}let P=(()=>{class t{constructor(t,e){this.odataService=t,this.router=e,this.displayedColumns=["id","itemtype","tags","knowledgeitem","createdat"],this.dataSource=[],this.resultsLength=0,this.isLoadingResults=!0,this.refreshEvent=new m.o}getExerciseItemTypeName(t){return Object(w.c)(t)}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),Object(h.a)(this.sort.sortChange,this.paginator.page,this.refreshEvent).pipe(Object(g.a)({}),Object(f.a)(()=>{this.isLoadingResults=!0;const t=this.paginator.pageSize;return this.odataService.getExerciseItems(t,t*this.paginator.pageIndex,this.sort.active,this.sort.direction)}),Object(C.a)(()=>this.isLoadingResults=!1),Object(S.a)(t=>(this.resultsLength=t.totalCount,t.items)),Object(T.a)(()=>Object(p.a)([]))).subscribe({next:t=>this.dataSource=t,error:t=>console.log(t)})}onGoToPreview(){const t=[];this.dataSource.forEach(e=>{t.push({refType:v.t.ExerciseItem,refId:e.ID})}),this.odataService.previewObjList=t,this.router.navigate(["preview"])}onGoToSearch(){this.router.navigate(["exercise-item","search"])}onDeleteItem(t){this.odataService.deleteExerciseItem(t).subscribe({next:t=>{this.onRefreshList()},error:t=>{console.error(t)}})}onRefreshList(){this.refreshEvent.emit()}resetPaging(){this.paginator.pageIndex=0}onDisplayItem(t){this.router.navigate(["exercise-item","display",t.toString()])}onChangeItem(t){this.router.navigate(["exercise-item","edit",t.toString()])}}return t.\u0275fac=function(e){return new(e||t)(m.Nb(y.b),m.Nb(b.b))},t.\u0275cmp=m.Hb({type:t,selectors:[["app-exercise-items"]],viewQuery:function(t,e){if(1&t&&(m.Ic(d.a,!0),m.Ic(u.a,!0)),2&t){let t;m.rc(t=m.cc())&&(e.paginator=t.first),m.rc(t=m.cc())&&(e.sort=t.first)}},decls:39,vars:22,consts:[[1,"toolbar-spacer"],["mat-stroked-button","","routerLink","create"],["mat-stroked-button","",3,"disabled","click"],["mat-stroked-button","",3,"click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","itemtype"],["matColumnDef","tags"],["matColumnDef","knowledgeitem"],["matColumnDef","createdat"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-button","",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(m.Tb(0,"mat-toolbar-row"),m.Tb(1,"span"),m.Ec(2),m.gc(3,"transloco"),m.Sb(),m.Ob(4,"span",0),m.Tb(5,"section"),m.Tb(6,"a",1),m.Ec(7),m.gc(8,"transloco"),m.Sb(),m.Tb(9,"a",2),m.bc("click",function(){return e.onGoToSearch()}),m.Ec(10),m.gc(11,"transloco"),m.Sb(),m.Tb(12,"a",2),m.bc("click",function(){return e.onGoToPreview()}),m.Ec(13),m.gc(14,"transloco"),m.Sb(),m.Tb(15,"a",3),m.bc("click",function(){return e.onRefreshList()}),m.Ec(16),m.gc(17,"transloco"),m.Sb(),m.Sb(),m.Sb(),m.Tb(18,"div",4),m.Tb(19,"div",5),m.Tb(20,"table",6),m.bc("matSortChange",function(){return e.resetPaging()}),m.Rb(21,7),m.Dc(22,I,2,0,"th",8),m.Dc(23,F,12,10,"td",9),m.Qb(),m.Rb(24,10),m.Dc(25,E,3,3,"th",8),m.Dc(26,M,3,3,"td",9),m.Qb(),m.Rb(27,11),m.Dc(28,k,3,3,"th",8),m.Dc(29,$,2,1,"td",9),m.Qb(),m.Rb(30,12),m.Dc(31,j,3,3,"th",8),m.Dc(32,R,2,1,"td",9),m.Qb(),m.Rb(33,13),m.Dc(34,N,3,3,"th",14),m.Dc(35,G,3,4,"td",9),m.Qb(),m.Dc(36,L,1,0,"tr",15),m.Dc(37,A,1,0,"tr",16),m.Sb(),m.Sb(),m.Ob(38,"mat-paginator",17),m.Sb()),2&t&&(m.Cb(2),m.Fc(m.hc(3,12,"ExerciseItem")),m.Cb(5),m.Fc(m.hc(8,14,"Common.Create")),m.Cb(2),m.lc("disabled",e.dataSource.length<=0),m.Cb(1),m.Fc(m.hc(11,16,"Common.Search")),m.Cb(2),m.lc("disabled",e.dataSource.length<=0),m.Cb(1),m.Fc(m.hc(14,18,"Common.Preview")),m.Cb(3),m.Fc(m.hc(17,20,"Common.Refresh")),m.Cb(4),m.lc("dataSource",e.dataSource),m.Cb(16),m.lc("matHeaderRowDef",e.displayedColumns),m.Cb(1),m.lc("matRowDefColumns",e.displayedColumns),m.Cb(1),m.lc("length",e.resultsLength)("pageSize",20))},directives:[x.c,D.a,b.c,O.j,u.a,O.c,O.e,O.b,O.g,O.i,d.a,O.d,O.a,u.b,O.f,O.h],pipes:[r.d,c.e],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.example-loading-shade[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.mat-column-id[_ngcontent-%COMP%]{max-width:300px;width:250px}.mat-column-itemtype[_ngcontent-%COMP%]{max-width:120px;width:120px}.mat-column-tags[_ngcontent-%COMP%]{max-width:250px;width:150px}.mat-column-created[_ngcontent-%COMP%]{max-width:120px;width:120px}"]}),t})();var U=o("jtHE"),H=o("FtGj"),_=o("rCpU"),V=o("HKRH"),K=o("0IaG"),z=o("Wp6s"),Q=o("kmnG"),q=o("qFsG"),B=o("d3UM"),J=o("A5z7"),X=o("XiUz"),W=o("FKr1"),Y=o("NFeN");function Z(t,e){if(1&t&&(m.Tb(0,"mat-option",18),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t){const t=e.$implicit;m.lc("value",t.value),m.Cb(1),m.Fc(m.hc(2,2,t.i18nterm))}}function tt(t,e){1&t&&(m.Tb(0,"mat-icon",21),m.Ec(1,"cancel"),m.Sb())}function et(t,e){if(1&t){const t=m.Ub();m.Tb(0,"mat-chip",19),m.bc("removed",function(){m.uc(t);const o=e.$implicit;return m.fc().removeTag(o)}),m.Ec(1),m.Dc(2,tt,2,0,"mat-icon",20),m.Sb()}if(2&t){const t=e.$implicit,o=m.fc();m.lc("selectable",o.selectable)("removable",o.isEditable),m.Cb(1),m.Gc(" ",t," "),m.Cb(1),m.lc("ngIf",o.isEditable)}}function ot(t,e){if(1&t&&(m.Tb(0,"div",22),m.Tb(1,"div",23),m.Tb(2,"mat-form-field",1),m.Tb(3,"mat-label"),m.Ec(4),m.gc(5,"transloco"),m.Sb(),m.Ob(6,"input",24),m.gc(7,"transloco"),m.gc(8,"date"),m.Sb(),m.Sb(),m.Tb(9,"div",23),m.Tb(10,"mat-form-field",1),m.Tb(11,"mat-label"),m.Ec(12),m.gc(13,"transloco"),m.Sb(),m.Ob(14,"input",24),m.gc(15,"transloco"),m.gc(16,"date"),m.Sb(),m.Sb(),m.Sb()),2&t){const t=m.fc();m.Cb(4),m.Fc(m.hc(5,6,"CreatedAt")),m.Cb(2),m.mc("placeholder",m.hc(7,8,"CreatedAt")),m.lc("ngModel",m.ic(8,10,t.itemObject.CreatedAt,"yyyy-M-d HH:mm:ss")),m.Cb(6),m.Fc(m.hc(13,13,"ModifiedAt")),m.Cb(2),m.mc("placeholder",m.hc(15,15,"ModifiedAt")),m.lc("ngModel",m.ic(16,17,t.itemObject.ModifiedAt,"yyyy-M-d HH:mm:ss"))}}function ct(t,e){if(1&t){const t=m.Ub();m.Tb(0,"mat-toolbar"),m.Tb(1,"h3"),m.Ec(2),m.gc(3,"transloco"),m.Sb(),m.Ob(4,"div",25),m.Tb(5,"button",26),m.bc("click",function(){return m.uc(t),m.fc().openUploadDialog()}),m.Ec(6,"Upload"),m.Sb(),m.Sb()}2&t&&(m.Cb(2),m.Fc(m.hc(3,1,"Content")))}function it(t,e){if(1&t){const t=m.Ub();m.Tb(0,"div",23),m.Tb(1,"ngx-monaco-editor",27),m.bc("ngModelChange",function(e){return m.uc(t),m.fc().content=e}),m.Sb(),m.Sb()}if(2&t){const t=m.fc();m.Cb(1),m.lc("options",t.editorOptions)("ngModel",t.content)}}function at(t,e){if(1&t){const t=m.Ub();m.Tb(0,"mat-toolbar"),m.Tb(1,"h3"),m.Ec(2),m.gc(3,"transloco"),m.Sb(),m.Ob(4,"div",25),m.Tb(5,"button",26),m.bc("click",function(){return m.uc(t),m.fc().openAnswerUploadDialog()}),m.Tb(6,"mat-icon"),m.Ec(7,"file_upload"),m.Sb(),m.Sb(),m.Sb()}2&t&&(m.Cb(2),m.Fc(m.hc(3,1,"Answer")))}function nt(t,e){if(1&t){const t=m.Ub();m.Tb(0,"div",23),m.Tb(1,"ngx-monaco-editor",27),m.bc("ngModelChange",function(e){return m.uc(t),m.fc().answerContent=e}),m.Sb(),m.Sb()}if(2&t){const t=m.fc();m.Cb(1),m.lc("options",t.editorOptions)("ngModel",t.answerContent)}}let rt=(()=>{class t{constructor(t,e,o,c){this.dialog=t,this.activateRoute=e,this.router=o,this.odataService=c,this.routerID=-1,this.uiMode=_.c.Create,this.currentMode="",this.editorOptions={theme:"vs-dark"},this.content="New Exercise Item",this.answerContent="",this.mathOptions={displayMode:!0,throwOnError:!1,errorColor:"#cc0000"},this.selectable=!0,this.addOnBlur=!0,this.separatorKeysCodes=[H.g,H.c],this.tags=[],this.arExerciseTypes=[],this.arExerciseTypes=Object(w.d)(),this.itemFormGroup=new i.f({idControl:new i.d({value:null,disabled:!0}),typeControl:new i.d({value:w.b.Question}),knowledgeControl:new i.d,tagControl:new i.d})}get isDisplayMode(){return this.uiMode===_.c.Display}get isCreateMode(){return this.uiMode===_.c.Create}get isUpdateMode(){return this.uiMode===_.c.Update}get isEditable(){return this.uiMode===_.c.Create||this.uiMode===_.c.Update}ngOnInit(){this.destroyed$=new U.a(1),this.activateRoute.url.subscribe({next:t=>{t instanceof Array&&t.length>0&&("create"===t[0].path?(this.routerID=-1,this.uiMode=_.c.Create,this.currentMode="Common.Create"):"edit"===t[0].path?(this.routerID=+t[1].path,this.uiMode=_.c.Update,this.currentMode="Common.Change"):"display"===t[0].path&&(this.routerID=+t[1].path,this.uiMode=_.c.Display,this.currentMode="Common.Display")),-1!==this.routerID&&this.odataService.readExerciseItem(this.routerID,this.uiMode===_.c.Update).subscribe({next:t=>{this.onSetItemData(t),this.itemObject=t},error:t=>{console.error(t)}})},error:t=>{console.error(t)}})}ngOnDestroy(){this.destroyed$&&(this.destroyed$.complete(),this.destroyed$=void 0)}onOK(){var t;if(this.isCreateMode){if(!this.itemFormGroup.valid)return void(this.itemFormGroup.errors&&console.error(this.itemFormGroup.errors));this.itemObject=new w.a,this.itemObject.ItemType=null===(t=this.itemFormGroup.get("typeControl"))||void 0===t?void 0:t.value,this.itemObject.Content=this.content,this.itemObject.Tags=this.tags,this.itemObject.Answer=this.answerContent,this.odataService.createExerciseItem(this.itemObject).subscribe({next:t=>{this.router.navigate(["/exercise-item/display",t.ID])},error:t=>{console.error(t)}})}else if(this.isUpdateMode){if(!this.itemFormGroup.valid)return void(this.itemFormGroup.errors&&console.log(this.itemFormGroup.errors));this.itemObject&&(this.itemObject.ItemType=this.itemFormGroup.get("typeControl").value,this.itemObject.Content=this.content,this.itemObject.Tags=this.tags,this.itemObject.Answer=this.answerContent,this.odataService.changeExerciseItem(this.itemObject).subscribe({next:t=>{this.router.navigate(["/exercise-item/display",t.ID])},error:t=>{console.error(t)}}))}}openUploadDialog(){this.dialog.open(V.a,{width:"50%",height:"50%"}).afterClosed().subscribe({next:t=>{console.log(t),t.forEach(t=>{this.content+=`\n![Img](${t.url})\n          `})}})}openAnswerUploadDialog(){this.dialog.open(V.a,{width:"50%",height:"50%"}).afterClosed().subscribe({next:t=>{console.log(t),t.forEach(t=>{this.answerContent+=`\n  ![Img](${t.url})\n            `})}})}addTag(t){const e=t.input,o=t.value;(o||"").trim()&&this.tags.push(o.trim()),e&&(e.value="")}removeTag(t){const e=this.tags.indexOf(t);e>=0&&this.tags.splice(e,1)}onSetItemData(t){var e,o,c;null===(e=this.itemFormGroup.get("idControl"))||void 0===e||e.setValue(t.ID),null===(o=this.itemFormGroup.get("idControl"))||void 0===o||o.disable(),null===(c=this.itemFormGroup.get("typeControl"))||void 0===c||c.setValue(+t.ItemType),this.content=t.Content,this.tags=t.Tags,this.isDisplayMode?this.itemFormGroup.disable():this.itemFormGroup.markAsPristine()}onReturnToList(){this.router.navigate(["exercise-item"])}onCreateNewOne(){this.router.navigate(["exercise-item","create"])}}return t.\u0275fac=function(e){return new(e||t)(m.Nb(K.a),m.Nb(b.a),m.Nb(b.b),m.Nb(y.b))},t.\u0275cmp=m.Hb({type:t,selectors:[["app-exercise-item-detail"]],decls:54,vars:41,consts:[[3,"formGroup"],["appearance","fill",1,"control-full-width"],["matInput","","type","text","placeholder","ID","formControlName","idControl"],["required","","formControlName","typeControl"],[3,"value",4,"ngFor","ngForOf"],["formControlName","tagControl"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","New tag...",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["matInput","","type","text","placeholder","Knowledge ID","formControlName","knowledgeControl"],["fxLayout","row","class","control-full-width",4,"ngIf"],[4,"ngIf"],["fxLayout","row",1,"control-full-width",2,"height","500px"],["fxFlex","50",4,"ngIf"],["fxFlex","",2,"height","100%","overflow-y","scroll"],["katex","",3,"data","katexOptions"],["mat-button","",3,"disabled","click"],["mat-button","",3,"click"],[3,"value"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],["fxLayout","row",1,"control-full-width"],["fxFlex","50"],["matInput","","type","text","disabled","",3,"placeholder","ngModel"],[1,"toolbar-spacer"],["mat-raised-button","",3,"click"],[2,"height","100%",3,"options","ngModel","ngModelChange"]],template:function(t,e){if(1&t&&(m.Tb(0,"mat-card"),m.Tb(1,"mat-card-header"),m.Tb(2,"mat-card-title"),m.Ec(3),m.gc(4,"transloco"),m.Sb(),m.Tb(5,"mat-card-subtitle"),m.Ec(6),m.gc(7,"transloco"),m.Sb(),m.Sb(),m.Tb(8,"mat-card-content"),m.Tb(9,"form",0),m.Tb(10,"mat-form-field",1),m.Tb(11,"mat-label"),m.Ec(12,"#"),m.Sb(),m.Ob(13,"input",2),m.Sb(),m.Tb(14,"mat-form-field",1),m.Tb(15,"mat-label"),m.Ec(16),m.gc(17,"transloco"),m.Sb(),m.Tb(18,"mat-select",3),m.Dc(19,Z,3,4,"mat-option",4),m.Sb(),m.Sb(),m.Tb(20,"mat-form-field",1),m.Tb(21,"mat-label"),m.Ec(22),m.gc(23,"transloco"),m.Sb(),m.Tb(24,"mat-chip-list",5,6),m.Dc(26,et,3,4,"mat-chip",7),m.Tb(27,"input",8),m.bc("matChipInputTokenEnd",function(t){return e.addTag(t)}),m.Sb(),m.Sb(),m.Sb(),m.Tb(28,"mat-form-field",1),m.Tb(29,"mat-label"),m.Ec(30),m.gc(31,"transloco"),m.Sb(),m.Ob(32,"input",9),m.Sb(),m.Sb(),m.Dc(33,ot,17,20,"div",10),m.Dc(34,ct,7,3,"mat-toolbar",11),m.Tb(35,"div",12),m.Dc(36,it,2,2,"div",13),m.Tb(37,"div",14),m.Ob(38,"markdown",15),m.Sb(),m.Sb(),m.Dc(39,at,8,3,"mat-toolbar",11),m.Tb(40,"div",12),m.Dc(41,nt,2,2,"div",13),m.Tb(42,"div",14),m.Ob(43,"markdown",15),m.Sb(),m.Sb(),m.Sb(),m.Tb(44,"mat-card-actions"),m.Tb(45,"button",16),m.bc("click",function(){return e.onOK()}),m.Ec(46),m.gc(47,"transloco"),m.Sb(),m.Tb(48,"button",17),m.bc("click",function(){return e.onReturnToList()}),m.Ec(49),m.gc(50,"transloco"),m.Sb(),m.Tb(51,"button",16),m.bc("click",function(){return e.onCreateNewOne()}),m.Ec(52),m.gc(53,"transloco"),m.Sb(),m.Sb(),m.Sb()),2&t){const t=m.sc(25);m.Cb(3),m.Fc(m.hc(4,25,"ExerciseItem")),m.Cb(3),m.Fc(m.hc(7,27,e.currentMode)),m.Cb(3),m.lc("formGroup",e.itemFormGroup),m.Cb(7),m.Fc(m.hc(17,29,"Type")),m.Cb(3),m.lc("ngForOf",e.arExerciseTypes),m.Cb(3),m.Fc(m.hc(23,31,"Tags")),m.Cb(4),m.lc("ngForOf",e.tags),m.Cb(1),m.lc("matChipInputFor",t)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes)("matChipInputAddOnBlur",e.addOnBlur),m.Cb(3),m.Fc(m.hc(31,33,"KnowledgeItem")),m.Cb(3),m.lc("ngIf",!e.isCreateMode&&e.itemObject),m.Cb(1),m.lc("ngIf",e.isCreateMode),m.Cb(2),m.lc("ngIf",!e.isDisplayMode),m.Cb(2),m.lc("data",e.content)("katexOptions",e.mathOptions),m.Cb(1),m.lc("ngIf",e.isCreateMode),m.Cb(2),m.lc("ngIf",e.isCreateMode),m.Cb(2),m.lc("data",e.answerContent)("katexOptions",e.mathOptions),m.Cb(2),m.lc("disabled",!(e.isEditable&&e.itemFormGroup.valid)),m.Cb(1),m.Fc(m.hc(47,35,"Save")),m.Cb(3),m.Fc(m.hc(50,37,"Common.ReturnToList")),m.Cb(2),m.lc("disabled",!e.isDisplayMode),m.Cb(1),m.Fc(m.hc(53,39,"Common.CreateAnotherOne"))}},directives:[z.a,z.d,z.g,z.f,z.c,i.u,i.n,i.g,Q.c,Q.g,q.b,i.c,i.m,i.e,B.a,i.s,c.l,J.c,J.b,c.m,X.c,X.a,n.a,z.b,D.b,W.m,J.a,Y.a,J.d,i.p,x.a,a.a],pipes:[r.d,c.e],styles:[".example-form[_ngcontent-%COMP%]{margin:8px;min-width:150px;max-width:500px;width:100%}.mat-card-actions[_ngcontent-%COMP%]{margin-top:10px}"]}),t})();var lt=o("2Vo4"),st=o("f0Cb"),bt=o("iadO"),mt=o("bSwM"),dt=o("pFkP");function ut(t,e){if(1&t&&(m.Tb(0,"mat-option",26),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t){const t=e.$implicit;m.lc("value",t.value),m.Cb(1),m.Gc(" ",m.hc(2,2,t.displayas)," ")}}function ht(t,e){if(1&t&&(m.Tb(0,"mat-option",26),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t){const t=e.$implicit;m.lc("value",t.value),m.Cb(1),m.Gc(" ",m.hc(2,2,t.i18nterm)," ")}}function pt(t,e){if(1&t){const t=m.Ub();m.Tb(0,"mat-form-field"),m.Tb(1,"input",27),m.bc("ngModelChange",function(e){return m.uc(t),m.fc().$implicit.value[0]=e}),m.gc(2,"transloco"),m.Sb(),m.Sb()}if(2&t){const t=m.fc().$implicit;m.Cb(1),m.mc("placeholder",m.hc(2,2,"Value")),m.lc("ngModel",t.value[0])}}function gt(t,e){if(1&t){const t=m.Ub();m.Tb(0,"mat-form-field"),m.Tb(1,"input",28),m.bc("ngModelChange",function(e){return m.uc(t),m.fc().$implicit.value[1]=e}),m.gc(2,"transloco"),m.Sb(),m.Sb()}if(2&t){const t=m.fc().$implicit;m.Cb(1),m.mc("placeholder",m.hc(2,2,"Value")),m.lc("ngModel",t.value[1])}}function ft(t,e){if(1&t){const t=m.Ub();m.Tb(0,"mat-form-field"),m.Tb(1,"input",29),m.bc("ngModelChange",function(e){return m.uc(t),m.fc().$implicit.value[0]=e}),m.gc(2,"transloco"),m.Sb(),m.Sb()}if(2&t){const t=m.fc().$implicit;m.Cb(1),m.mc("placeholder",m.hc(2,2,"Value")),m.lc("ngModel",t.value[0])}}function Ct(t,e){if(1&t){const t=m.Ub();m.Tb(0,"mat-form-field"),m.Tb(1,"input",30),m.bc("ngModelChange",function(e){return m.uc(t),m.fc().$implicit.value[0]=e}),m.gc(2,"transloco"),m.Sb(),m.Ob(3,"mat-datepicker-toggle",31),m.Ob(4,"mat-datepicker",null,32),m.Sb()}if(2&t){const t=m.sc(5),e=m.fc().$implicit;m.Cb(1),m.mc("placeholder",m.hc(2,4,"Value")),m.lc("ngModel",e.value[0])("matDatepicker",t),m.Cb(2),m.lc("for",t)}}function St(t,e){if(1&t){const t=m.Ub();m.Tb(0,"mat-form-field"),m.Tb(1,"input",30),m.bc("ngModelChange",function(e){return m.uc(t),m.fc().$implicit.value[1]=e}),m.gc(2,"transloco"),m.Sb(),m.Ob(3,"mat-datepicker-toggle",31),m.Ob(4,"mat-datepicker",null,33),m.Sb()}if(2&t){const t=m.sc(5),e=m.fc().$implicit;m.Cb(1),m.mc("placeholder",m.hc(2,4,"Value")),m.lc("ngModel",e.value[1])("matDatepicker",t),m.Cb(2),m.lc("for",t)}}function Tt(t,e){if(1&t){const t=m.Ub();m.Tb(0,"div",34),m.Tb(1,"mat-checkbox",35),m.bc("ngModelChange",function(e){return m.uc(t),m.fc().$implicit.value[0]=e}),m.Sb(),m.Sb()}if(2&t){const t=m.fc().$implicit;m.Cb(1),m.lc("ngModel",t.value[0])}}function vt(t,e){if(1&t){const t=m.Ub();m.Tb(0,"div",18),m.Tb(1,"mat-form-field"),m.Tb(2,"mat-select",19),m.bc("ngModelChange",function(t){return e.$implicit.fieldName=t})("selectionChange",function(){m.uc(t);const o=e.$implicit;return m.fc().onFieldSelectionChanged(o)}),m.gc(3,"transloco"),m.Dc(4,ut,3,4,"mat-option",20),m.Sb(),m.Sb(),m.Tb(5,"mat-form-field"),m.Tb(6,"mat-select",21),m.bc("ngModelChange",function(t){return e.$implicit.operator=t}),m.gc(7,"transloco"),m.Dc(8,ht,3,4,"mat-option",20),m.gc(9,"operatorFilter"),m.Sb(),m.Sb(),m.Dc(10,pt,3,4,"mat-form-field",22),m.Dc(11,gt,3,4,"mat-form-field",22),m.Dc(12,ft,3,4,"mat-form-field",22),m.Dc(13,Ct,6,6,"mat-form-field",22),m.Dc(14,St,6,6,"mat-form-field",22),m.Dc(15,Tt,2,1,"div",23),m.Tb(16,"button",24),m.bc("click",function(){return m.uc(t),m.fc().onAddFilter()}),m.Tb(17,"mat-icon"),m.Ec(18,"add"),m.Sb(),m.Sb(),m.Tb(19,"button",25),m.bc("click",function(){m.uc(t);const o=e.index;return m.fc().onRemoveFilter(o)}),m.Tb(20,"mat-icon"),m.Ec(21,"close"),m.Sb(),m.Sb(),m.Sb()}if(2&t){const t=e.$implicit,o=m.fc();m.Cb(2),m.mc("placeholder",m.hc(3,12,"Field")),m.lc("ngModel",t.fieldName),m.Cb(2),m.lc("ngForOf",o.allFields),m.Cb(2),m.mc("placeholder",m.hc(7,14,"Operator")),m.lc("ngModel",t.operator),m.Cb(2),m.lc("ngForOf",m.ic(9,16,o.allOperators,t.valueType)),m.Cb(2),m.lc("ngIf",1===t.valueType),m.Cb(1),m.lc("ngIf",1===t.valueType),m.Cb(1),m.lc("ngIf",2===t.valueType),m.Cb(1),m.lc("ngIf",3===t.valueType),m.Cb(1),m.lc("ngIf",3===t.valueType),m.Cb(1),m.lc("ngIf",4===t.valueType)}}function wt(t,e){1&t&&(m.Tb(0,"th",36),m.Ec(1,"#"),m.Sb())}function yt(t,e){if(1&t){const t=m.Ub();m.Tb(0,"td",37),m.Tb(1,"div"),m.Ec(2),m.Tb(3,"a",38),m.bc("click",function(){m.uc(t);const o=e.$implicit;return m.fc().onDisplayItem(o.ID)}),m.Ec(4),m.gc(5,"transloco"),m.Sb(),m.Sb(),m.Sb()}if(2&t){const t=e.$implicit;m.Cb(2),m.Gc(" ",t.ID," "),m.Cb(2),m.Fc(m.hc(5,2,"Common.Display"))}}function xt(t,e){1&t&&(m.Tb(0,"th",36),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t&&(m.Cb(1),m.Fc(m.hc(2,1,"Type")))}function Dt(t,e){if(1&t&&(m.Tb(0,"td",37),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t){const t=e.$implicit,o=m.fc();m.Cb(1),m.Fc(m.hc(2,1,o.getExerciseItemTypeName(t.ItemType)))}}function Ot(t,e){1&t&&(m.Tb(0,"th",36),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t&&(m.Cb(1),m.Fc(m.hc(2,1,"Tag")))}function It(t,e){if(1&t&&(m.Tb(0,"td",37),m.Ec(1),m.Sb()),2&t){const t=e.$implicit;m.Cb(1),m.Fc(t.Tags.toString())}}function Ft(t,e){1&t&&(m.Tb(0,"th",36),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t&&(m.Cb(1),m.Fc(m.hc(2,1,"KnowledgeItem")))}function Et(t,e){if(1&t&&(m.Tb(0,"td",37),m.Ec(1),m.Sb()),2&t){const t=e.$implicit;m.Cb(1),m.Fc(t.KnowledgeItemID)}}function Mt(t,e){1&t&&(m.Tb(0,"th",36),m.Ec(1),m.gc(2,"transloco"),m.Sb()),2&t&&(m.Cb(1),m.Fc(m.hc(2,1,"CreatedAt")))}function kt(t,e){if(1&t&&(m.Tb(0,"td",37),m.Ec(1),m.gc(2,"date"),m.Sb()),2&t){const t=e.$implicit;m.Cb(1),m.Fc(m.ic(2,1,t.CreatedAt,"yyyy-M-d HH:mm:ss"))}}function $t(t,e){1&t&&m.Ob(0,"tr",39)}function jt(t,e){1&t&&m.Ob(0,"tr",40)}const Rt=[{path:"",component:P},{path:"create",component:rt},{path:"display/:id",component:rt},{path:"edit/:id",component:rt},{path:"search",component:(()=>{class t{constructor(t,e){this.odataService=t,this.router=e,this.filters=[],this.allOperators=[],this.allFields=[],this.filterEditable=!0,this.pageSize=20,this.pageSizeOptions=[20,40,60,100],this.isLoadingResults=!1,this.subjFilters=new lt.a([]),this.displayedColumns=["id","itemtype","tags","knowledgeitem","createdat"],this.dataSource=[],this.resultsLength=0,this.allOperators=v.u.getGeneralFilterOperatorDisplayStrings(),this.allFields=[{displayas:"Content",value:"Content",valueType:2},{displayas:"Tag",value:"Tags",valueType:2}]}ngOnInit(){this.onAddFilter()}ngAfterViewInit(){this.subjFilters.subscribe(()=>this.paginator.pageIndex=0),Object(h.a)(this.subjFilters,this.paginator.page).pipe(Object(g.a)({}),Object(f.a)(()=>{if(this.subjFilters.value.length<=0)return Object(p.a)([]);this.isLoadingResults=!0;const t=this.prepareFilters(this.subjFilters.value),e=this.paginator.pageSize;return this.odataService.searchExerciseItems(e,e*this.paginator.pageIndex,t)}),Object(C.a)(()=>this.isLoadingResults=!1),Object(S.a)(t=>(this.resultsLength=t.totalCount,t.items)),Object(T.a)(()=>Object(p.a)(void 0))).subscribe({next:t=>this.dataSource=t,error:t=>console.log(t)})}getExerciseItemTypeName(t){return Object(v.w)(t)}onAddFilter(){this.filters.push(new v.e)}onRemoveFilter(t){this.filters.splice(t,1),0===this.filters.length&&this.onAddFilter()}onFieldSelectionChanged(t){this.allFields.forEach(e=>{e.value===t.fieldName&&(t.valueType=e.valueType)})}prepareFilters(t){let e="";t.sort((t,e)=>t.fieldName.localeCompare(e.fieldName));let o=t.map(t=>t.fieldName);return o=Array.from(new Set(o)),o.forEach(o=>{let c="";t.forEach(t=>{t.fieldName===o&&("Content"!==t.fieldName&&"Tags"!==t.fieldName||(t.operator===v.f.Equal?c=c?`${c} or ${t.fieldName} eq '${t.lowValue}'`:`${t.fieldName} eq '${t.lowValue}'`:t.operator===v.f.Like&&(c=c?`${c} or contains(${t.fieldName},'${t.lowValue}')`:`contains(${t.fieldName},'${t.lowValue}')`)))}),e=e?`${e} and ${c}`:""+c}),e}onSearch(){const t=[];this.filters.forEach(e=>{const o={};switch(o.valueType=+e.valueType,e.valueType){case v.g.boolean:case v.g.date:case v.g.number:break;case v.g.string:o.fieldName=e.fieldName,o.operator=+e.operator,o.lowValue=e.value[0],o.highValue=e.operator===v.f.Between?e.value[1]:""}t.push(o)}),this.subjFilters.next(t)}onDisplayItem(t){this.router.navigate(["exercise-item","display",t.toString()])}onGoToPreview(){const t=[];this.dataSource.forEach(e=>{t.push({refType:v.t.ExerciseItem,refId:e.ID})}),this.odataService.previewObjList=t,this.router.navigate(["preview"])}}return t.\u0275fac=function(e){return new(e||t)(m.Nb(y.b),m.Nb(b.b))},t.\u0275cmp=m.Hb({type:t,selectors:[["app-exercise-item-search"]],viewQuery:function(t,e){if(1&t&&m.zc(d.a,!0),2&t){let t;m.rc(t=m.cc())&&(e.paginator=t.first)}},decls:44,vars:18,consts:[["class","demo-full-width",4,"ngFor","ngForOf"],[1,"control-full-width"],["mat-button","","aria-label","Search",3,"click"],[1,"table-container","mat-elevation-z8"],["color","primary"],["mat-flat-button","","color","primary",3,"click"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","itemtype"],["matColumnDef","tags"],["matColumnDef","knowledgeitem"],["matColumnDef","createdat"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],[1,"demo-full-width"],[3,"placeholder","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","ngModelChange"],[4,"ngIf"],["class","typechkbox",4,"ngIf"],["mat-button","","mat-icon-button","","aria-label","Add",3,"click"],["mat-button","","mat-icon-button","","aria-label","Clear",3,"click"],[3,"value"],["matInput","","type","number","name","lvalue_1",3,"placeholder","ngModel","ngModelChange"],["matInput","","type","number","name","hvalue_1",3,"placeholder","ngModel","ngModelChange"],["matInput","","type","text","name","lvalue_2",3,"placeholder","ngModel","ngModelChange"],["matInput","",3,"ngModel","matDatepicker","placeholder","ngModelChange"],["matSuffix","",3,"for"],["lvpicker",""],["hvpicker",""],[1,"typechkbox"],[3,"ngModel","ngModelChange"],["mat-header-cell",""],["mat-cell",""],["mat-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(m.Tb(0,"mat-card"),m.Tb(1,"mat-card-header"),m.Tb(2,"mat-card-title"),m.Ec(3),m.gc(4,"transloco"),m.Sb(),m.Tb(5,"mat-card-subtitle"),m.Ec(6),m.gc(7,"transloco"),m.Sb(),m.Sb(),m.Tb(8,"mat-card-content"),m.Tb(9,"div"),m.Dc(10,vt,22,19,"div",0),m.Tb(11,"div",1),m.Tb(12,"button",2),m.bc("click",function(){return e.onSearch()}),m.Tb(13,"mat-icon"),m.Ec(14,"search"),m.Sb(),m.Ec(15),m.gc(16,"transloco"),m.Sb(),m.Sb(),m.Sb(),m.Ob(17,"mat-divider"),m.Tb(18,"div",3),m.Tb(19,"mat-toolbar",4),m.Tb(20,"mat-toolbar-row"),m.Tb(21,"button",5),m.bc("click",function(){return e.onGoToPreview()}),m.Ec(22),m.gc(23,"transloco"),m.Sb(),m.Sb(),m.Sb(),m.Tb(24,"div",6),m.Tb(25,"table",7),m.Rb(26,8),m.Dc(27,wt,2,0,"th",9),m.Dc(28,yt,6,4,"td",10),m.Qb(),m.Rb(29,11),m.Dc(30,xt,3,3,"th",9),m.Dc(31,Dt,3,3,"td",10),m.Qb(),m.Rb(32,12),m.Dc(33,Ot,3,3,"th",9),m.Dc(34,It,2,1,"td",10),m.Qb(),m.Rb(35,13),m.Dc(36,Ft,3,3,"th",9),m.Dc(37,Et,2,1,"td",10),m.Qb(),m.Rb(38,14),m.Dc(39,Mt,3,3,"th",9),m.Dc(40,kt,3,4,"td",10),m.Qb(),m.Dc(41,$t,1,0,"tr",15),m.Dc(42,jt,1,0,"tr",16),m.Sb(),m.Sb(),m.Ob(43,"mat-paginator",17),m.Sb(),m.Sb(),m.Sb()),2&t&&(m.Cb(3),m.Fc(m.hc(4,10,"ExerciseItem")),m.Cb(3),m.Fc(m.hc(7,12,"Common.Search")),m.Cb(4),m.lc("ngForOf",e.filters),m.Cb(5),m.Gc(" ",m.hc(16,14,"Common.Search")," "),m.Cb(7),m.Fc(m.hc(23,16,"Common.Preview")),m.Cb(3),m.lc("dataSource",e.dataSource),m.Cb(16),m.lc("matHeaderRowDef",e.displayedColumns),m.Cb(1),m.lc("matRowDefColumns",e.displayedColumns),m.Cb(1),m.lc("length",e.resultsLength)("pageSize",10))},directives:[z.a,z.d,z.g,z.f,z.c,c.l,D.b,Y.a,st.a,x.a,x.c,O.j,O.c,O.e,O.b,O.g,O.i,d.a,Q.c,B.a,i.m,i.p,c.m,W.m,q.b,i.q,i.c,bt.b,bt.d,Q.i,bt.a,mt.a,O.d,O.a,D.a,O.f,O.h],pipes:[r.d,dt.a,c.e],styles:[".table-container[_ngcontent-%COMP%]{position:relative;min-height:400px;margin-top:16px;overflow:auto}table[_ngcontent-%COMP%]{width:100%;height:100%}.data-loading-shade[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.mat-column-id[_ngcontent-%COMP%]{max-width:300px;width:250px}.mat-column-itemtype[_ngcontent-%COMP%]{max-width:120px;width:120px}.mat-column-tags[_ngcontent-%COMP%]{max-width:250px;width:150px}.mat-column-created[_ngcontent-%COMP%]{max-width:120px;width:120px}"]}),t})()}];let Nt=(()=>{class t{}return t.\u0275mod=m.Lb({type:t}),t.\u0275inj=m.Kb({factory:function(e){return new(e||t)},imports:[[b.d.forChild(Rt)],b.d]}),t})();var Gt=o("iasb");let Lt=(()=>{class t{}return t.\u0275mod=m.Lb({type:t}),t.\u0275inj=m.Kb({factory:function(e){return new(e||t)},providers:[],imports:[[c.c,i.h,i.r,l.a,s.a,a.b,n.b.forChild(),Nt,r.c,Gt.a]]}),t})()}}]);