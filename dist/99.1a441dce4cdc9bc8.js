"use strict";(self.webpackChunkknowledgebuilder=self.webpackChunkknowledgebuilder||[]).push([[99],{99:(_o,Y,p)=>{p.r(Y),p.d(Y,{AwardModule:()=>po});var C=p(9808),c=p(3075),A=p(7455),G=p(7607),F=p(558),S=p(4521),f=p(8966),B=p(5439),y=p.n(B),s=p(9144),t=p(5e3),Z=p(3984),U=p(4594),x=p(7423),R=p(7238),b=p(5245),l=p(8279),M=p(6087),J=p(4834),h=p(3489),O=p(4107),N=p(508),k=p(7531),g=p(6856);function $(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function H(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit,n=t.oxw();t.xp6(1),t.AsE("",n.getUserDisplayAs(o.targetUser)," (",o.targetUser,")")}}function E(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Quiz.Date")))}function W(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.getRecordDateDisplayString())}}function z(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function j(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",16),t._uU(1),t.TgZ(2,"button",17),t.NdJ("click",function(){const r=t.CHM(o).$implicit;return t.oxw().onGetPoints(r.targetUser,r.recordDate)}),t.ALo(3,"transloco"),t.TgZ(4,"mat-icon"),t._uU(5,"visibility"),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",o.point," | "),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,2,"Award.Point"))}}function V(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.AggregatedPoints")))}function K(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.aggPoint)}}function X(e,a){1&e&&t._UZ(0,"tr",18)}function tt(e,a){1&e&&t._UZ(0,"tr",19)}function et(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1,"#"),t.qZA())}function ot(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",16),t.TgZ(1,"button",24),t.NdJ("click",function(){const r=t.CHM(o).$implicit;return t.oxw(2).onDeletePoint(r.id)}),t.ALo(2,"transloco"),t.TgZ(3,"mat-icon"),t._uU(4,"remove_circle"),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(1),t.s9C("matTooltip",t.lcZ(2,2,"Common.Delete")),t.Q6J("disabled",o.matchedRuleID)}}function nt(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function at(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit,n=t.oxw(2);t.xp6(1),t.AsE("",n.getUserDisplayAs(o.targetUser)," (",o.targetUser,")")}}function it(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Quiz.Date")))}function rt(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.getRecordDateDisplayString())}}function lt(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1,"Rule ID"),t.qZA())}function ct(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.matchedRuleID)}}function st(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.ContinuousDays")))}function dt(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.countOfDay)}}function ut(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function mt(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.point)}}function pt(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Comment")))}function _t(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.comment)}}function gt(e,a){1&e&&t._UZ(0,"tr",18)}function ft(e,a){1&e&&t._UZ(0,"tr",19)}function Zt(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"mat-toolbar"),t.TgZ(2,"h3"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t._UZ(5,"div",0),t.TgZ(6,"button",17),t.NdJ("click",function(){return t.CHM(o),t.oxw().onHidePoints()}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"visibility_off"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div",2),t.TgZ(11,"div",3),t.TgZ(12,"table",4),t.ynx(13,20),t.YNc(14,et,2,0,"th",6),t.YNc(15,ot,5,4,"td",7),t.BQk(),t.ynx(16,5),t.YNc(17,nt,3,3,"th",6),t.YNc(18,at,2,2,"td",7),t.BQk(),t.ynx(19,8),t.YNc(20,it,3,3,"th",6),t.YNc(21,rt,2,1,"td",7),t.BQk(),t.ynx(22,21),t.YNc(23,lt,2,0,"th",6),t.YNc(24,ct,2,1,"td",7),t.BQk(),t.ynx(25,22),t.YNc(26,st,3,3,"th",6),t.YNc(27,dt,2,1,"td",7),t.BQk(),t.ynx(28,9),t.YNc(29,ut,3,3,"th",6),t.YNc(30,mt,2,1,"td",7),t.BQk(),t.ynx(31,23),t.YNc(32,pt,3,3,"th",6),t.YNc(33,_t,2,1,"td",7),t.BQk(),t.YNc(34,gt,1,0,"tr",11),t.YNc(35,ft,1,0,"tr",12),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=t.oxw();t.xp6(3),t.HOy("",t.lcZ(4,8,"Award.Point"),", ",o.getUserDisplayAs(o.selectedUserId)," (",o.selectedUserId,"), ",o.selectedDate,""),t.xp6(3),t.s9C("matTooltip",t.lcZ(7,10,"Common.Hide")),t.xp6(6),t.Q6J("dataSource",o.dataSourcePoints),t.xp6(22),t.Q6J("matHeaderRowDef",o.displayedPointColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedPointColumns)}}function ht(e,a){if(1&e&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.targetUser),t.xp6(1),t.hij(" ",o.displayAs," ")}}const Q="table[_ngcontent-%COMP%]{width:100%}.example-form[_ngcontent-%COMP%]{min-width:250px;max-width:500px;width:100%}.example-margin[_ngcontent-%COMP%]{margin:0 10px}";let Tt=(()=>{class e{constructor(o,n,i){this.oDataSrv=o,this.dialog=n,this.uiUtilSrv=i,this.dataSource=[],this.dataSourcePoints=[],this.recordCount=0,this.displayedColumns=["targetUser","recordDate","point","aggpoint"],this.displayedPointColumns=["action","targetUser","recordDate","matchedRuleID","countOfDay","point","comment"],this.selectedUserId="",this.selectedDate="",this.isPointShow=!1}ngOnInit(){this.refreshList()}get isExpertMode(){return this.oDataSrv.isLoggedin}getUserDisplayAs(o){if(o&&this.oDataSrv.currentUserDetail){const n=this.oDataSrv.currentUserDetail.awardUsers.findIndex(i=>i.targetUser===o);if(-1!==n)return this.oDataSrv.currentUserDetail.awardUsers[n].displayAs}return""}onCreateAward(){this.dialog.open(Ct,{width:"600px",closeOnNavigation:!1,data:new s.FI}).afterClosed().subscribe(n=>{console.log(`The dialog was closed with result: ${n}`),n&&this.oDataSrv.createAwardPoint(n).subscribe({next:i=>{this.refreshList()},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})})}refreshList(){this.oDataSrv.getAwardPointReports(100,0).subscribe({next:o=>{this.dataSource=o.items.slice(),this.recordCount=o.totalCount},error:o=>{this.uiUtilSrv.showSnackInfo(o)}})}onGetPoints(o,n){this.oDataSrv.getAwardPoints(100,0,void 0,`TargetUser eq '${o}' AND RecordDate eq ${n.format(s.Jt)}`).subscribe({next:i=>{this.selectedUserId=o,this.selectedDate=n.format(s.Jt),this.dataSourcePoints=[],this.dataSourcePoints=i.items.slice(),this.isPointShow=!0},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})}onHidePoints(){this.selectedDate="",this.selectedUserId="",this.dataSourcePoints=[],this.isPointShow=!1}onDeletePoint(o){this.oDataSrv.deleteAwardPoint(o).subscribe({next:n=>{this.onGetPoints(this.selectedUserId,y()(this.selectedDate))},error:n=>{this.uiUtilSrv.showSnackInfo(n)}})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(Z.CB),t.Y36(f.uw),t.Y36(Z.dM))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-overview"]],decls:29,vars:13,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary",3,"disabled","matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","targetUser"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","recordDate"],["matColumnDef","point"],["matColumnDef","aggpoint"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],[4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""],["matColumnDef","action"],["matColumnDef","matchedRuleID"],["matColumnDef","countOfDay"],["matColumnDef","comment"],["mat-icon-button","","color","warn",3,"disabled","matTooltip","click"]],template:function(o,n){1&o&&(t.TgZ(0,"mat-toolbar"),t.TgZ(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.TgZ(5,"button",1),t.NdJ("click",function(){return n.onCreateAward()}),t.ALo(6,"transloco"),t.TgZ(7,"mat-icon"),t._uU(8,"add_circle"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",2),t.TgZ(10,"div",3),t.TgZ(11,"table",4),t.ynx(12,5),t.YNc(13,$,3,3,"th",6),t.YNc(14,H,2,2,"td",7),t.BQk(),t.ynx(15,8),t.YNc(16,E,3,3,"th",6),t.YNc(17,W,2,1,"td",7),t.BQk(),t.ynx(18,9),t.YNc(19,z,3,3,"th",6),t.YNc(20,j,6,4,"td",7),t.BQk(),t.ynx(21,10),t.YNc(22,V,3,3,"th",6),t.YNc(23,K,2,1,"td",7),t.BQk(),t.YNc(24,X,1,0,"tr",11),t.YNc(25,tt,1,0,"tr",12),t.qZA(),t.qZA(),t._UZ(26,"mat-paginator",13),t.qZA(),t._UZ(27,"mat-divider"),t.YNc(28,Zt,36,12,"div",14)),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,9,"Award.Overview")),t.xp6(3),t.s9C("matTooltip",t.lcZ(6,11,"Common.Create")),t.Q6J("disabled",!n.isExpertMode),t.xp6(6),t.Q6J("dataSource",n.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("length",n.recordCount)("pageSize",20),t.xp6(2),t.Q6J("ngIf",n.isPointShow))},directives:[U.Ye,x.lW,R.gM,b.Hw,l.BZ,l.w1,l.fO,l.ge,l.Dz,l.ev,l.as,l.XQ,l.nj,l.Gk,M.NW,J.d,C.O5],pipes:[A.Ot],styles:[Q]}),e})(),Ct=(()=>{class e{constructor(o,n,i){this.dialogRef=o,this.oDataSrv=n,this.data=i}onNoClick(){this.dialogRef.close()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(f.so),t.Y36(Z.CB),t.Y36(f.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-overview-award-point-crtdlg"]],decls:33,vars:21,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"example-form"],["appearance","fill",1,"control-full-width"],["name","targetuser",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],["matInput","","name","recorddate",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["matInput","","type","number","name","point",3,"ngModel","ngModelChange"],["matInput","","name","comment",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"disabled","mat-dialog-close"],[3,"value"]],template:function(o,n){if(1&o&&(t.TgZ(0,"h1",0),t._uU(1,"CREATE AWARD POINT"),t.qZA(),t.TgZ(2,"div",1),t.TgZ(3,"form",2),t.TgZ(4,"mat-form-field",3),t.TgZ(5,"mat-label"),t._uU(6),t.ALo(7,"transloco"),t.qZA(),t.TgZ(8,"mat-select",4),t.NdJ("ngModelChange",function(r){return n.data.targetUser=r}),t.YNc(9,ht,2,2,"mat-option",5),t.qZA(),t.qZA(),t.TgZ(10,"mat-form-field",6),t.TgZ(11,"mat-label"),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"input",7),t.NdJ("ngModelChange",function(r){return n.data.recordDate=r}),t.qZA(),t._UZ(15,"mat-datepicker-toggle",8),t._UZ(16,"mat-datepicker",null,9),t.qZA(),t.TgZ(18,"mat-form-field",3),t.TgZ(19,"mat-label"),t._uU(20),t.ALo(21,"transloco"),t.qZA(),t.TgZ(22,"input",10),t.NdJ("ngModelChange",function(r){return n.data.point=r}),t.qZA(),t.qZA(),t.TgZ(23,"mat-form-field",3),t.TgZ(24,"mat-label"),t._uU(25),t.ALo(26,"transloco"),t.qZA(),t.TgZ(27,"input",11),t.NdJ("ngModelChange",function(r){return n.data.comment=r}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(28,"div",12),t.TgZ(29,"button",13),t.NdJ("click",function(){return n.onNoClick()}),t._uU(30,"No Thanks"),t.qZA(),t.TgZ(31,"button",14),t._uU(32,"OK"),t.qZA(),t.qZA()),2&o){const i=t.MAs(17);t.xp6(6),t.Oqu(t.lcZ(7,13,"Award.TargetUser")),t.xp6(2),t.Q6J("ngModel",n.data.targetUser),t.xp6(1),t.Q6J("ngForOf",null==n.oDataSrv.currentUserDetail?null:n.oDataSrv.currentUserDetail.awardUsers),t.xp6(3),t.Oqu(t.lcZ(13,15,"Quiz.Date")),t.xp6(2),t.Q6J("matDatepicker",i)("ngModel",n.data.recordDate),t.xp6(1),t.Q6J("for",i),t.xp6(5),t.Oqu(t.lcZ(21,17,"Award.Point")),t.xp6(2),t.Q6J("ngModel",n.data.point),t.xp6(3),t.Oqu(t.lcZ(26,19,"Common.Comment")),t.xp6(2),t.Q6J("ngModel",n.data.comment),t.xp6(4),t.Q6J("disabled",!n.data.isValid())("mat-dialog-close",n.data)}},directives:[f.uh,f.xY,c._Y,c.JL,c.F,h.KE,h.hX,O.gD,c.JJ,c.On,C.sg,N.ey,k.Nt,g.hl,c.Fj,g.nW,h.R9,g.Mq,c.wV,f.H8,x.lW,f.ZT],pipes:[A.Ot],styles:[Q]}),e})();var At=p(3500);function xt(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1,"#"),t.qZA())}function wt(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",16),t._uU(1),t.TgZ(2,"button",17),t.NdJ("click",function(){const r=t.CHM(o).$implicit;return t.oxw().onDisplayRuleGroup(r.id)}),t.ALo(3,"transloco"),t.TgZ(4,"mat-icon"),t._uU(5,"launch"),t.qZA(),t.qZA(),t.TgZ(6,"button",18),t.NdJ("click",function(){const r=t.CHM(o).$implicit;return t.oxw().onDeleteRuleGroup(r.id)}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"remove_circle"),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(1),t.hij("",o.id," | "),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,3,"Common.Display")),t.xp6(4),t.s9C("matTooltip",t.lcZ(7,5,"Common.Delete"))}}function Dt(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function qt(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit,n=t.oxw();t.xp6(1),t.AsE("",n.getUserDisplayAs(o.targetUser)," (",o.targetUser,")")}}function vt(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Type")))}function yt(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit,n=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,n.getAwardRuleTypeName(o.ruleType)))}}function Ut(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Validity")))}function bt(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.validity)}}function Ot(e,a){1&e&&(t.TgZ(0,"th",15),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Description")))}function Nt(e,a){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.desp)}}function kt(e,a){1&e&&t._UZ(0,"tr",19)}function St(e,a){1&e&&t._UZ(0,"tr",20)}let Rt=(()=>{class e{constructor(o,n,i){this.odataSrv=o,this.dialog=n,this.uiUtilSrv=i,this.dataSource=[],this.displayedColumns=["id","targetUser","ruleType","validity","desp"],this.recordCount=0}ngOnInit(){this.refreshList()}get isExpertMode(){return this.odataSrv.isLoggedin}getAwardRuleTypeName(o){return(0,At.$F)(o)}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const n=this.odataSrv.currentUserDetail.awardUsers.findIndex(i=>i.targetUser===o);if(-1!==n)return this.odataSrv.currentUserDetail.awardUsers[n].displayAs}return""}onCreateRuleGroup(){this.uiUtilSrv.navigateAwardRuleGenerationPage()}refreshList(){this.odataSrv.getAwardRuleGroups(100,0,void 0).subscribe({next:o=>{this.dataSource=o.items.slice(),this.recordCount=o.totalCount},error:o=>{this.uiUtilSrv.showSnackInfo(o)}})}onDeleteRuleGroup(o){this.odataSrv.deleteAwardRuleGroup(o).subscribe({next:n=>{this.refreshList()},error:n=>{this.uiUtilSrv.showSnackInfo(n)}})}onDisplayRuleGroup(o){this.uiUtilSrv.navigateAwardRuleGroupDisplayPage(o)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(Z.CB),t.Y36(f.uw),t.Y36(Z.dM))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-award-rule"]],decls:30,vars:12,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary",3,"disabled","matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","targetUser"],["matColumnDef","ruleType"],["matColumnDef","validity"],["matColumnDef","desp"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""]],template:function(o,n){1&o&&(t.TgZ(0,"mat-toolbar"),t.TgZ(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.TgZ(5,"button",1),t.NdJ("click",function(){return n.onCreateRuleGroup()}),t.ALo(6,"transloco"),t.TgZ(7,"mat-icon"),t._uU(8,"add_circle"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",2),t.TgZ(10,"div",3),t.TgZ(11,"table",4),t.ynx(12,5),t.YNc(13,xt,2,0,"th",6),t.YNc(14,wt,10,7,"td",7),t.BQk(),t.ynx(15,8),t.YNc(16,Dt,3,3,"th",6),t.YNc(17,qt,2,2,"td",7),t.BQk(),t.ynx(18,9),t.YNc(19,vt,3,3,"th",6),t.YNc(20,yt,3,3,"td",7),t.BQk(),t.ynx(21,10),t.YNc(22,Ut,3,3,"th",6),t.YNc(23,bt,2,1,"td",7),t.BQk(),t.ynx(24,11),t.YNc(25,Ot,3,3,"th",6),t.YNc(26,Nt,2,1,"td",7),t.BQk(),t.YNc(27,kt,1,0,"tr",12),t.YNc(28,St,1,0,"tr",13),t.qZA(),t.qZA(),t._UZ(29,"mat-paginator",14),t.qZA()),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,8,"Award.Rules")),t.xp6(3),t.s9C("matTooltip",t.lcZ(6,10,"Common.Create")),t.Q6J("disabled",!n.isExpertMode),t.xp6(6),t.Q6J("dataSource",n.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("length",n.recordCount)("pageSize",20))},directives:[U.Ye,x.lW,R.gM,b.Hw,l.BZ,l.w1,l.fO,l.ge,l.Dz,l.ev,l.as,l.XQ,l.nj,l.Gk,M.NW],pipes:[A.Ot],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),e})();var L=p(7446);function Mt(e,a){1&e&&t._UZ(0,"th",23)}function Yt(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",24),t.TgZ(1,"button",25),t.NdJ("click",function(){const r=t.CHM(o).$implicit;return t.oxw().onGetPoints(r.targetUser,r.recordDate)}),t.ALo(2,"transloco"),t.TgZ(3,"mat-icon"),t._uU(4,"visibility"),t.qZA(),t.qZA(),t.TgZ(5,"button",26),t.NdJ("click",function(){const r=t.CHM(o).$implicit;return t.oxw().onDeleteTrace(r.targetUser,r.recordDate)}),t.ALo(6,"transloco"),t.TgZ(7,"mat-icon"),t._uU(8,"remove_circle"),t.qZA(),t.qZA(),t.qZA()}2&e&&(t.xp6(1),t.s9C("matTooltip",t.lcZ(2,2,"Award.Point")),t.xp6(4),t.s9C("matTooltip",t.lcZ(6,4,"Common.Delete")))}function Jt(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function Qt(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit,n=t.oxw();t.xp6(1),t.AsE("",n.getUserDisplayAs(o.targetUser)," (",o.targetUser,")")}}function Lt(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Quiz.Date")))}function It(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.getRecordDateDisplayString())}}function Pt(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.SchoolWorkTime")))}function Gt(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.schoolWorkTime)}}function Ft(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.GoToBedTime")))}function Bt(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.goToBedTime)}}function $t(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.HomeworkCount")))}function Ht(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.homeWorkCount)}}function Et(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.BodyExerciseCount")))}function Wt(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.bodyExerciseCount)}}function zt(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.ErrorsCollection")))}function jt(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",24),t.TgZ(1,"mat-checkbox",27),t.NdJ("ngModelChange",function(i){return t.CHM(o).$implicit.errorsCollection=i}),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(1),t.Q6J("ngModel",o.errorsCollection)}}function Vt(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.HandWriting")))}function Kt(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",24),t.TgZ(1,"mat-checkbox",27),t.NdJ("ngModelChange",function(i){return t.CHM(o).$implicit.handWriting=i}),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(1),t.Q6J("ngModel",o.handWriting)}}function Xt(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.CleanDesk")))}function te(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",24),t.TgZ(1,"mat-checkbox",27),t.NdJ("ngModelChange",function(i){return t.CHM(o).$implicit.cleanDesk=i}),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(1),t.Q6J("ngModel",o.cleanDesk)}}function ee(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.HouseKeepingCount")))}function oe(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.houseKeepingCount)}}function ne(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.PoliteBehavior")))}function ae(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.politeBehavior)}}function ie(e,a){1&e&&t._UZ(0,"tr",28)}function re(e,a){1&e&&t._UZ(0,"tr",29)}function le(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1,"#"),t.qZA())}function ce(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",24),t._uU(1),t.TgZ(2,"button",34),t.NdJ("click",function(){const r=t.CHM(o).$implicit;return t.oxw(2).onDeletePoint(r.id)}),t.ALo(3,"transloco"),t.TgZ(4,"mat-icon"),t._uU(5,"remove_circle"),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",o.id," | "),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,3,"Common.Delete")),t.Q6J("disabled",o.matchedRuleID)}}function se(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TargetUser")))}function de(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.targetUser)}}function ue(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Quiz.Date")))}function me(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.getRecordDateDisplayString())}}function pe(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1,"Rule ID"),t.qZA())}function _e(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.matchedRuleID)}}function ge(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.ContinuousDays")))}function fe(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.countOfDay)}}function Ze(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function he(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.point)}}function Te(e,a){1&e&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Comment")))}function Ce(e,a){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.comment)}}function Ae(e,a){1&e&&t._UZ(0,"tr",28)}function xe(e,a){1&e&&t._UZ(0,"tr",29)}function we(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"mat-toolbar"),t.TgZ(2,"h3"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t._UZ(5,"div",0),t.TgZ(6,"button",25),t.NdJ("click",function(){return t.CHM(o),t.oxw().onHidePoints()}),t.ALo(7,"transloco"),t.TgZ(8,"mat-icon"),t._uU(9,"visibility_off"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div",2),t.TgZ(11,"div",3),t.TgZ(12,"table",4),t.ynx(13,5),t.YNc(14,le,2,0,"th",6),t.YNc(15,ce,6,5,"td",7),t.BQk(),t.ynx(16,8),t.YNc(17,se,3,3,"th",6),t.YNc(18,de,2,1,"td",7),t.BQk(),t.ynx(19,9),t.YNc(20,ue,3,3,"th",6),t.YNc(21,me,2,1,"td",7),t.BQk(),t.ynx(22,30),t.YNc(23,pe,2,0,"th",6),t.YNc(24,_e,2,1,"td",7),t.BQk(),t.ynx(25,31),t.YNc(26,ge,3,3,"th",6),t.YNc(27,fe,2,1,"td",7),t.BQk(),t.ynx(28,32),t.YNc(29,Ze,3,3,"th",6),t.YNc(30,he,2,1,"td",7),t.BQk(),t.ynx(31,33),t.YNc(32,Te,3,3,"th",6),t.YNc(33,Ce,2,1,"td",7),t.BQk(),t.YNc(34,Ae,1,0,"tr",19),t.YNc(35,xe,1,0,"tr",20),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=t.oxw();t.xp6(3),t.lnq("",t.lcZ(4,7,"Award.Point"),", ",o.selectedUser,", ",o.selectedDate,""),t.xp6(3),t.s9C("matTooltip",t.lcZ(7,9,"Common.Hide")),t.xp6(6),t.Q6J("dataSource",o.dataSourcePoints),t.xp6(22),t.Q6J("matHeaderRowDef",o.displayedPointColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedPointColumns)}}function De(e,a){if(1&e&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.targetUser),t.xp6(1),t.Oqu(o.displayAs)}}let qe=(()=>{class e{constructor(o,n,i){this.odataSrv=o,this.dialog=n,this.uiUtilSrv=i,this.dataSourceTrace=[],this.dataSourcePoints=[],this.traceLength=0,this.displayedColumns=["action","targetUser","recordDate","schoolWorkTime","goToBedTime","homeWorkCount","bodyExerciseCount","errorsCollection","handWriting","cleanDesk","houseKeepingCount","politeBehavior"],this.displayedPointColumns=["action","targetUser","recordDate","matchedRuleID","countOfDay","point","comment"],this.selectedUser="",this.selectedDate="",this.isPointShow=!1}ngOnInit(){this.refreshList()}get isExpertMode(){return this.odataSrv.isLoggedin}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const n=this.odataSrv.currentUserDetail.awardUsers.findIndex(i=>i.targetUser===o);if(-1!==n)return this.odataSrv.currentUserDetail.awardUsers[n].displayAs}return""}onCreateTrace(){this.dialog.open(ve,{width:"600px",closeOnNavigation:!1,data:new s.QM}).afterClosed().subscribe(n=>{console.log(`The dialog was closed with result: ${n}`),n&&this.odataSrv.createDailyTrace(n).subscribe({next:i=>{this.refreshList()},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})})}refreshList(){this.odataSrv.getDailyTrace(100,0).subscribe({next:o=>{this.dataSourceTrace=o.items.slice(),this.traceLength=o.totalCount},error:o=>{this.uiUtilSrv.showSnackInfo(o)}})}onGetPoints(o,n){this.odataSrv.getAwardPoints(100,0,void 0,`TargetUser eq '${o}' AND RecordDate eq ${n.format(s.Jt)}`).subscribe({next:i=>{this.selectedUser=o,this.selectedDate=n.format(s.Jt),this.dataSourcePoints=[],this.dataSourcePoints=i.items.slice(),this.isPointShow=!0},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})}onDeleteTrace(o,n){this.odataSrv.deleteDailyTrace(o,n).subscribe({next:i=>{this.isPointShow=!1,this.refreshList()},error:i=>{this.uiUtilSrv.showSnackInfo(i)}})}onHidePoints(){this.selectedDate="",this.selectedUser="",this.dataSourcePoints=[],this.isPointShow=!1}onDeletePoint(o){this.odataSrv.deleteAwardPoint(o).subscribe({next:n=>{this.onGetPoints(this.selectedUser,y()(this.selectedDate))},error:n=>{this.uiUtilSrv.showSnackInfo(n)}})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(Z.CB),t.Y36(f.uw),t.Y36(Z.dM))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-daily-trace"]],decls:53,vars:13,consts:[[1,"toolbar-spacer"],["mat-icon-button","","color","primary",3,"disabled","matTooltip","click"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","targetUser"],["matColumnDef","recordDate"],["matColumnDef","schoolWorkTime"],["matColumnDef","goToBedTime"],["matColumnDef","homeWorkCount"],["matColumnDef","bodyExerciseCount"],["matColumnDef","errorsCollection"],["matColumnDef","handWriting"],["matColumnDef","cleanDesk"],["matColumnDef","houseKeepingCount"],["matColumnDef","politeBehavior"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize"],[4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","warn",3,"matTooltip","click"],["disabled","",3,"ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""],["matColumnDef","matchedRuleID"],["matColumnDef","countOfDay"],["matColumnDef","point"],["matColumnDef","comment"],["mat-icon-button","","color","warn",3,"disabled","matTooltip","click"]],template:function(o,n){1&o&&(t.TgZ(0,"mat-toolbar"),t.TgZ(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.TgZ(5,"button",1),t.NdJ("click",function(){return n.onCreateTrace()}),t.ALo(6,"transloco"),t.TgZ(7,"mat-icon"),t._uU(8,"add_circle"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",2),t.TgZ(10,"div",3),t.TgZ(11,"table",4),t.ynx(12,5),t.YNc(13,Mt,1,0,"th",6),t.YNc(14,Yt,9,6,"td",7),t.BQk(),t.ynx(15,8),t.YNc(16,Jt,3,3,"th",6),t.YNc(17,Qt,2,2,"td",7),t.BQk(),t.ynx(18,9),t.YNc(19,Lt,3,3,"th",6),t.YNc(20,It,2,1,"td",7),t.BQk(),t.ynx(21,10),t.YNc(22,Pt,3,3,"th",6),t.YNc(23,Gt,2,1,"td",7),t.BQk(),t.ynx(24,11),t.YNc(25,Ft,3,3,"th",6),t.YNc(26,Bt,2,1,"td",7),t.BQk(),t.ynx(27,12),t.YNc(28,$t,3,3,"th",6),t.YNc(29,Ht,2,1,"td",7),t.BQk(),t.ynx(30,13),t.YNc(31,Et,3,3,"th",6),t.YNc(32,Wt,2,1,"td",7),t.BQk(),t.ynx(33,14),t.YNc(34,zt,3,3,"th",6),t.YNc(35,jt,2,1,"td",7),t.BQk(),t.ynx(36,15),t.YNc(37,Vt,3,3,"th",6),t.YNc(38,Kt,2,1,"td",7),t.BQk(),t.ynx(39,16),t.YNc(40,Xt,3,3,"th",6),t.YNc(41,te,2,1,"td",7),t.BQk(),t.ynx(42,17),t.YNc(43,ee,3,3,"th",6),t.YNc(44,oe,2,1,"td",7),t.BQk(),t.ynx(45,18),t.YNc(46,ne,3,3,"th",6),t.YNc(47,ae,2,1,"td",7),t.BQk(),t.YNc(48,ie,1,0,"tr",19),t.YNc(49,re,1,0,"tr",20),t.qZA(),t.qZA(),t._UZ(50,"mat-paginator",21),t.qZA(),t._UZ(51,"mat-divider"),t.YNc(52,we,36,11,"div",22)),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,9,"Award.DailyTrace")),t.xp6(3),t.s9C("matTooltip",t.lcZ(6,11,"Common.Create")),t.Q6J("disabled",!n.isExpertMode),t.xp6(6),t.Q6J("dataSource",n.dataSourceTrace),t.xp6(37),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("length",n.traceLength)("pageSize",20),t.xp6(2),t.Q6J("ngIf",n.isPointShow))},directives:[U.Ye,x.lW,R.gM,b.Hw,l.BZ,l.w1,l.fO,l.ge,l.Dz,l.ev,L.oG,c.JJ,c.On,l.as,l.XQ,l.nj,l.Gk,M.NW,J.d,C.O5],pipes:[A.Ot],styles:["table[_ngcontent-%COMP%]{width:100%}.example-form[_ngcontent-%COMP%]{min-width:250px;max-width:500px;width:100%}.example-margin[_ngcontent-%COMP%]{margin:0 10px}td[_ngcontent-%COMP%]{padding-right:8px}"]}),e})(),ve=(()=>{class e{constructor(o,n,i){this.dialogRef=o,this.odataSrv=n,this.data=i}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}onNoClick(){this.dialogRef.close()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(f.so),t.Y36(Z.CB),t.Y36(f.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-daily-trace-create-dialog"]],decls:63,vars:52,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"example-form"],["appearance","fill",1,"control-full-width"],["required","","name","targetuser",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],["matInput","","name","recorddate",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["matInput","","type","number","name","schoolworktime",3,"ngModel","ngModelChange"],["matInput","","type","number","name","gotobedtime",3,"ngModel","ngModelChange"],["matInput","","type","number","name","homeworkcount",3,"ngModel","ngModelChange"],["matInput","","type","number","name","bodyexercisecount",3,"ngModel","ngModelChange"],["name","errorcollection",1,"example-margin",3,"ngModel","ngModelChange"],["name","handwriting",1,"example-margin",3,"ngModel","ngModelChange"],["name","cleandesk",1,"example-margin",3,"ngModel","ngModelChange"],["matInput","","type","number","name","housekeepingcount",3,"ngModel","ngModelChange"],["matInput","","type","number","name","politebehavior",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"disabled","mat-dialog-close"],[3,"value"]],template:function(o,n){if(1&o&&(t.TgZ(0,"h1",0),t._uU(1,"CREATE DAILY TRACE"),t.qZA(),t.TgZ(2,"div",1),t.TgZ(3,"form",2),t.TgZ(4,"mat-form-field",3),t.TgZ(5,"mat-label"),t._uU(6),t.ALo(7,"transloco"),t.qZA(),t.TgZ(8,"mat-select",4),t.NdJ("ngModelChange",function(r){return n.data.targetUser=r}),t.YNc(9,De,2,2,"mat-option",5),t.qZA(),t.qZA(),t.TgZ(10,"mat-form-field",6),t.TgZ(11,"mat-label"),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"input",7),t.NdJ("ngModelChange",function(r){return n.data.recordDate=r}),t.qZA(),t._UZ(15,"mat-datepicker-toggle",8),t._UZ(16,"mat-datepicker",null,9),t.qZA(),t.TgZ(18,"mat-form-field",3),t.TgZ(19,"mat-label"),t._uU(20),t.ALo(21,"transloco"),t.qZA(),t.TgZ(22,"input",10),t.NdJ("ngModelChange",function(r){return n.data.schoolWorkTime=r}),t.qZA(),t.qZA(),t.TgZ(23,"mat-form-field",3),t.TgZ(24,"mat-label"),t._uU(25),t.ALo(26,"transloco"),t.qZA(),t.TgZ(27,"input",11),t.NdJ("ngModelChange",function(r){return n.data.goToBedTime=r}),t.qZA(),t.qZA(),t.TgZ(28,"mat-form-field",3),t.TgZ(29,"mat-label"),t._uU(30),t.ALo(31,"transloco"),t.qZA(),t.TgZ(32,"input",12),t.NdJ("ngModelChange",function(r){return n.data.homeWorkCount=r}),t.qZA(),t.qZA(),t.TgZ(33,"mat-form-field",3),t.TgZ(34,"mat-label"),t._uU(35),t.ALo(36,"transloco"),t.qZA(),t.TgZ(37,"input",13),t.NdJ("ngModelChange",function(r){return n.data.bodyExerciseCount=r}),t.qZA(),t.qZA(),t.TgZ(38,"mat-checkbox",14),t.NdJ("ngModelChange",function(r){return n.data.errorsCollection=r}),t._uU(39),t.ALo(40,"transloco"),t.qZA(),t.TgZ(41,"mat-checkbox",15),t.NdJ("ngModelChange",function(r){return n.data.handWriting=r}),t._uU(42),t.ALo(43,"transloco"),t.qZA(),t.TgZ(44,"mat-checkbox",16),t.NdJ("ngModelChange",function(r){return n.data.cleanDesk=r}),t._uU(45),t.ALo(46,"transloco"),t.qZA(),t.TgZ(47,"mat-form-field",3),t.TgZ(48,"mat-label"),t._uU(49),t.ALo(50,"transloco"),t.qZA(),t.TgZ(51,"input",17),t.NdJ("ngModelChange",function(r){return n.data.houseKeepingCount=r}),t.qZA(),t.qZA(),t.TgZ(52,"mat-form-field",3),t.TgZ(53,"mat-label"),t._uU(54),t.ALo(55,"transloco"),t.qZA(),t.TgZ(56,"input",18),t.NdJ("ngModelChange",function(r){return n.data.politeBehavior=r}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(57,"div",19),t.TgZ(58,"button",20),t.NdJ("click",function(){return n.onNoClick()}),t._uU(59),t.ALo(60,"transloco"),t.qZA(),t.TgZ(61,"button",21),t._uU(62,"OK"),t.qZA(),t.qZA()),2&o){const i=t.MAs(17);t.xp6(6),t.Oqu(t.lcZ(7,28,"Award.TargetUser")),t.xp6(2),t.Q6J("ngModel",n.data.targetUser),t.xp6(1),t.Q6J("ngForOf",n.arTargetUsers),t.xp6(3),t.Oqu(t.lcZ(13,30,"Quiz.Date")),t.xp6(2),t.Q6J("matDatepicker",i)("ngModel",n.data.recordDate),t.xp6(1),t.Q6J("for",i),t.xp6(5),t.Oqu(t.lcZ(21,32,"Award.SchoolWorkTime")),t.xp6(2),t.Q6J("ngModel",n.data.schoolWorkTime),t.xp6(3),t.Oqu(t.lcZ(26,34,"Award.GoToBedTime")),t.xp6(2),t.Q6J("ngModel",n.data.goToBedTime),t.xp6(3),t.Oqu(t.lcZ(31,36,"Award.HomeworkCount")),t.xp6(2),t.Q6J("ngModel",n.data.homeWorkCount),t.xp6(3),t.Oqu(t.lcZ(36,38,"Award.BodyExerciseCount")),t.xp6(2),t.Q6J("ngModel",n.data.bodyExerciseCount),t.xp6(1),t.Q6J("ngModel",n.data.errorsCollection),t.xp6(1),t.Oqu(t.lcZ(40,40,"Award.ErrorsCollection")),t.xp6(2),t.Q6J("ngModel",n.data.handWriting),t.xp6(1),t.Oqu(t.lcZ(43,42,"Award.HandWriting")),t.xp6(2),t.Q6J("ngModel",n.data.cleanDesk),t.xp6(1),t.Oqu(t.lcZ(46,44,"Award.CleanDesk")),t.xp6(4),t.Oqu(t.lcZ(50,46,"Award.HouseKeepingCount")),t.xp6(2),t.Q6J("ngModel",n.data.houseKeepingCount),t.xp6(3),t.Oqu(t.lcZ(55,48,"Award.PoliteBehavior")),t.xp6(2),t.Q6J("ngModel",n.data.politeBehavior),t.xp6(3),t.Oqu(t.lcZ(60,50,"Common.NoThanks")),t.xp6(2),t.Q6J("disabled",!n.data.isValid())("mat-dialog-close",n.data)}},directives:[f.uh,f.xY,c._Y,c.JL,c.F,h.KE,h.hX,O.gD,c.Q7,c.JJ,c.On,C.sg,N.ey,k.Nt,g.hl,c.Fj,g.nW,h.R9,g.Mq,c.wV,L.oG,f.H8,x.lW,f.ZT],pipes:[A.Ot],encapsulation:2}),e})();var D=p(5615),I=p(4623);function ye(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Header"))}function Ue(e,a){if(1&e&&(t.TgZ(0,"mat-option",30),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.targetUser),t.xp6(1),t.Oqu(o.displayAs)}}function be(e,a){if(1&e&&(t.TgZ(0,"mat-option",30),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.value),t.xp6(1),t.Oqu(t.lcZ(2,2,o.i18nterm))}}function Oe(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Dimension"))}function Ne(e,a){if(1&e&&(t.TgZ(0,"mat-list",31),t.TgZ(1,"mat-list-item"),t._uU(2),t.qZA(),t.qZA()),2&e){const o=a.$implicit;t.xp6(2),t.Oqu(o.toString())}}function ke(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Award.ContinuousDays"))}function Se(e,a){if(1&e&&(t.TgZ(0,"mat-list",31),t.TgZ(1,"mat-list-item"),t._uU(2),t.qZA(),t.qZA()),2&e){const o=a.$implicit;t.xp6(2),t.Oqu(o.toString())}}function Re(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Award.Point"))}function Me(e,a){1&e&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Dimension")," "))}function Ye(e,a){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const o=t.oxw(2).$implicit,n=t.oxw();t.xp6(1),t.hij(" ",n.getColumnHeaderForDays(o)," ")}}function Je(e,a){if(1&e&&(t.TgZ(0,"th",35),t.YNc(1,Me,3,3,"span",36),t.YNc(2,Ye,2,1,"span",36),t.qZA()),2&e){const o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","dimension"===o),t.xp6(1),t.Q6J("ngIf","dimension"!==o)}}function Qe(e,a){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const o=t.oxw().$implicit;t.xp6(1),t.hij(" ",o.dimInfo.toString()," ")}}function Le(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"span"),t.TgZ(1,"input",38),t.NdJ("ngModelChange",function(i){t.CHM(o);const r=t.oxw().$implicit,d=t.oxw().$implicit;return r.points[d]=i})("ngModelChange",function(i){return t.CHM(o),t.oxw(3).onPointCellChanged(i)}),t.qZA(),t.qZA()}if(2&e){const o=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngModel",o.points[n])}}function Ie(e,a){if(1&e&&(t.TgZ(0,"td",37),t.YNc(1,Qe,2,1,"span",36),t.YNc(2,Le,2,1,"span",36),t.qZA()),2&e){const o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","dimension"===o),t.xp6(1),t.Q6J("ngIf","dimension"!==o)}}function Pe(e,a){1&e&&(t.ynx(0,32),t.YNc(1,Je,3,2,"th",33),t.YNc(2,Ie,3,2,"td",34),t.BQk()),2&e&&t.Q6J("matColumnDef",a.$implicit)}function Ge(e,a){1&e&&t._UZ(0,"tr",39)}function Fe(e,a){1&e&&t._UZ(0,"tr",40)}function Be(e,a){1&e&&(t._uU(0),t.ALo(1,"transloco")),2&e&&t.Oqu(t.lcZ(1,1,"Common.Done"))}class w{constructor(){this.from=0,this.to=0,this.typeIsNumber=!0,this.cond=!1}toString(){return this.typeIsNumber?`[${this.from} - ${this.to})`:this.cond.toString()}}class P{constructor(){this.from=0,this.to=0}toString(){return`[${this.from} - ${this.to})`}}class $e{constructor(a){this.points={},this.isEdit=!1,this.dimInfo=a}}let He=(()=>{class e{constructor(o,n,i){this._formBuilder=o,this.uiUtilSrv=n,this.odataSrv=i,this.arRuleTypes=[],this.dimensions=[],this.contDays=[],this.displayedColumns=["dimension"],this.dataSource=[],this.pointCompleted=!1,this.createdGroupID=-1,this.arRuleTypes=(0,s.dI)(),this.firstFormGroup=this._formBuilder.group({targetuserCtrl:["",c.kI.required],validFromCtrl:[void 0,c.kI.required],validToCtrl:[void 0,c.kI.required],ruleTypeCtrl:[s.rs.GoToBedTime,c.kI.required],despCtrl:["",c.kI.required]}),this.secondFormGroup=this._formBuilder.group({rawCtrl:["",c.kI.required]}),this.thirdFormGroup=this._formBuilder.group({rawCtrl:["",c.kI.required]})}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const n=this.odataSrv.currentUserDetail.awardUsers.findIndex(i=>i.targetUser===o);if(-1!==n)return this.odataSrv.currentUserDetail.awardUsers[n].displayAs}return""}get isExpertMode(){return this.odataSrv.isLoggedin}ngOnInit(){var o,n,i,r;null===(o=this.firstFormGroup.get("validFromCtrl"))||void 0===o||o.setValue(y()()),null===(n=this.firstFormGroup.get("validToCtrl"))||void 0===n||n.setValue(y()().add(1,"month")),null===(i=this.secondFormGroup.get("rawCtrl"))||void 0===i||i.valueChanges.subscribe(d=>{this.onDimensionChange(d)}),null===(r=this.thirdFormGroup.get("rawCtrl"))||void 0===r||r.valueChanges.subscribe(d=>{this.onContDayChange(d)})}get selectedRuleType(){var o;const n=null===(o=this.firstFormGroup.get("ruleTypeCtrl"))||void 0===o?void 0:o.value;return void 0!==n?n:s.rs.GoToBedTime}onInitialDimensions(){var o,n;switch(this.selectedRuleType){case s.rs.HandWritingHabit:case s.rs.CleanDeakHabit:case s.rs.ErrorCollectionHabit:null===(o=this.secondFormGroup.get("rawCtrl"))||void 0===o||o.disable();break;default:null===(n=this.secondFormGroup.get("rawCtrl"))||void 0===n||n.enable()}}onDimensionCompleted(){switch(this.selectedRuleType){case s.rs.HandWritingHabit:case s.rs.CleanDeakHabit:case s.rs.ErrorCollectionHabit:{const o=new w;o.typeIsNumber=!1,o.cond=!0,this.dimensions.push(o);const n=new w;n.typeIsNumber=!1,n.cond=!1,this.dimensions.push(n);break}}}onDimensionChange(o){switch(this.dimensions=[],this.selectedRuleType){case s.rs.BodyExerciseCount:case s.rs.HomeWorkCount:case s.rs.HouseKeepingCount:case s.rs.PoliteBehavior:if(o){let i=o.split(";").map(u=>{if(u){const m=+u;if(!isNaN(m)&&m>0)return Math.trunc(m)}return 0});i=i.filter(u=>u>0),i.sort();let r=0;i.forEach(u=>{if(0!==r){const m=new w;m.from=r,m.to=u,this.dimensions.push(m)}r=u});const d=new w;d.from=r,d.to=9999,this.dimensions.push(d)}break;case s.rs.HandWritingHabit:case s.rs.CleanDeakHabit:case s.rs.ErrorCollectionHabit:break;default:if(o){let i=o.split(";").map(u=>{if(u){const m=+u;if(!isNaN(m)&&m<=23.99&&m>0)return m}return 0});i=i.filter(u=>u>0),i.sort();let r=0;i.forEach(u=>{const m=new w;m.from=r,m.to=u,this.dimensions.push(m),r=u});const d=new w;d.from=r,d.to=24,this.dimensions.push(d)}}}onContDayChange(o){if(this.contDays=[],o){let i=o.split(";").map(u=>{if(u){const m=+u;if(!isNaN(m)&&m>0)return Math.trunc(m)}return 0});i=i.filter(u=>u>0),i.sort();let r=0;i.forEach(u=>{if(0!==r){const m=new P;m.from=r,m.to=u,this.contDays.push(m)}r=u});const d=new P;d.from=r,d.to=9999,this.contDays.push(d)}}onInitialRules(){this.dataSource=[],this.displayedColumns=["dimension"];const o=[];for(let n=0;n<this.contDays.length;n++)o.push(`days${n}`);this.displayedColumns.push(...o),this.dimensions.forEach(n=>{const i=new $e(n);o.forEach(r=>{i.points[r]=0}),this.dataSource.push(i)})}onPointCellChanged(o){let n=0;this.dataSource.forEach(i=>{Object.keys(i.points).forEach(r=>{(isNaN(i.points[r])||0===i.points[r])&&n++})}),this.pointCompleted=0===n}getColumnHeaderForDays(o){if(o&&o.startsWith("days")){const n=+o.replace("days","");return this.contDays[n].toString()}return""}onSave(){var o,n,i,r;const d=new s.mf;switch(d.desp=null===(o=this.firstFormGroup.get("despCtrl"))||void 0===o?void 0:o.value,d.ruleType=this.selectedRuleType,d.targetUser=null===(n=this.firstFormGroup.get("targetuserCtrl"))||void 0===n?void 0:n.value,d.validFrom=null===(i=this.firstFormGroup.get("validFromCtrl"))||void 0===i?void 0:i.value,d.validTo=null===(r=this.firstFormGroup.get("validToCtrl"))||void 0===r?void 0:r.value,d.ruleType){case s.rs.BodyExerciseCount:case s.rs.HomeWorkCount:case s.rs.HouseKeepingCount:case s.rs.PoliteBehavior:this.dataSource.forEach(u=>{Object.keys(u.points).forEach(m=>{const _=new s.m_;_.countOfFactLow=u.dimInfo.from,_.countOfFactHigh=u.dimInfo.to;const T=+m.replace("days","");_.daysFrom=this.contDays[T].from,this.contDays[T].to!==Number.POSITIVE_INFINITY&&(_.daysTo=this.contDays[T].to),_.point=u.points[m],d.rules.push(_)})});break;case s.rs.HandWritingHabit:case s.rs.CleanDeakHabit:case s.rs.ErrorCollectionHabit:this.dataSource.forEach(u=>{Object.keys(u.points).forEach(m=>{const _=new s.m_;_.doneOfFact=u.dimInfo.cond;const T=+m.replace("days","");_.daysFrom=this.contDays[T].from,_.daysTo=this.contDays[T].to,_.point=u.points[m],d.rules.push(_)})});break;default:this.dataSource.forEach(u=>{Object.keys(u.points).forEach(m=>{const _=new s.m_;_.timeStart=u.dimInfo.from,_.timeEnd=u.dimInfo.to;const T=+m.replace("days","");_.daysFrom=this.contDays[T].from,_.daysTo=this.contDays[T].to,_.point=u.points[m],d.rules.push(_)})})}d.isValid()&&this.odataSrv.createAwardRuleGroup(d).subscribe({next:u=>{this.createdGroupID=u.id},error:u=>{this.uiUtilSrv.showSnackInfo(u)}})}openGroup(){this.uiUtilSrv.navigateAwardRuleGroupDisplayPage(this.createdGroupID)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(c.qu),t.Y36(Z.dM),t.Y36(Z.CB))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-award-rule-generation"]],decls:103,vars:73,consts:[[1,"toolbar-spacer"],["linear",""],["stepper",""],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],["appearance","fill",1,"control-full-width"],["required","","formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],[3,"rangePicker"],["matStartDate","","formControlName","validFromCtrl","placeholder","Start date"],["matEndDate","","formControlName","validToCtrl","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],["required","","formControlName","ruleTypeCtrl"],["matInput","","required","","formControlName","despCtrl"],["mat-button","","color","primary","matStepperNext","",3,"click"],["matInput","","formControlName","rawCtrl"],["dense","",4,"ngFor","ngForOf"],["mat-button","","matStepperPrevious",""],[3,"completed"],["mat-raised-button","","disabled",""],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","","color","primary","matStepperNext","",3,"disabled","click"],["mat-button","",3,"click"],["mat-button","","color","warn",3,"click"],[3,"value"],["dense",""],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],[4,"ngIf"],["mat-cell",""],["matInput","","type","number",3,"ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""]],template:function(o,n){if(1&o){const i=t.EpF();t.TgZ(0,"mat-toolbar"),t.TgZ(1,"h1"),t._uU(2),t.ALo(3,"transloco"),t.qZA(),t._UZ(4,"div",0),t.qZA(),t.TgZ(5,"mat-vertical-stepper",1,2),t.TgZ(7,"mat-step",3),t.TgZ(8,"form",4),t.YNc(9,ye,2,3,"ng-template",5),t.TgZ(10,"mat-form-field",6),t.TgZ(11,"mat-label"),t._uU(12),t.ALo(13,"transloco"),t.qZA(),t.TgZ(14,"mat-select",7),t.YNc(15,Ue,2,2,"mat-option",8),t.qZA(),t.qZA(),t.TgZ(16,"mat-form-field",9),t.TgZ(17,"mat-label"),t._uU(18),t.ALo(19,"transloco"),t.qZA(),t.TgZ(20,"mat-date-range-input",10),t._UZ(21,"input",11),t._UZ(22,"input",12),t.qZA(),t._UZ(23,"mat-datepicker-toggle",13),t._UZ(24,"mat-date-range-picker",null,14),t.qZA(),t.TgZ(26,"mat-form-field",6),t.TgZ(27,"mat-label"),t._uU(28),t.ALo(29,"transloco"),t.qZA(),t.TgZ(30,"mat-select",15),t.YNc(31,be,3,4,"mat-option",8),t.qZA(),t.qZA(),t.TgZ(32,"mat-form-field",6),t.TgZ(33,"mat-label"),t._uU(34),t.ALo(35,"transloco"),t.qZA(),t._UZ(36,"input",16),t.qZA(),t.TgZ(37,"div"),t.TgZ(38,"button",17),t.NdJ("click",function(){return n.onInitialDimensions()}),t._uU(39),t.ALo(40,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(41,"mat-step",3),t.TgZ(42,"form",4),t.YNc(43,Oe,2,3,"ng-template",5),t.TgZ(44,"mat-form-field"),t.TgZ(45,"mat-label"),t._uU(46),t.ALo(47,"transloco"),t.qZA(),t._UZ(48,"input",18),t.qZA(),t.YNc(49,Ne,3,1,"mat-list",19),t.TgZ(50,"div"),t.TgZ(51,"button",20),t._uU(52),t.ALo(53,"transloco"),t.qZA(),t.TgZ(54,"button",17),t.NdJ("click",function(){return n.onDimensionCompleted()}),t._uU(55),t.ALo(56,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(57,"mat-step",3),t.TgZ(58,"form",4),t.YNc(59,ke,2,3,"ng-template",5),t.TgZ(60,"mat-form-field"),t.TgZ(61,"mat-label"),t._uU(62),t.ALo(63,"transloco"),t.qZA(),t._UZ(64,"input",18),t.qZA(),t.YNc(65,Se,3,1,"mat-list",19),t.TgZ(66,"div"),t.TgZ(67,"button",20),t._uU(68),t.ALo(69,"transloco"),t.qZA(),t.TgZ(70,"button",17),t.NdJ("click",function(){return n.onInitialRules()}),t._uU(71),t.ALo(72,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(73,"mat-step",21),t.YNc(74,Re,2,3,"ng-template",5),t.TgZ(75,"mat-toolbar"),t.TgZ(76,"button",22),t._uU(77,"RESET RULES"),t.qZA(),t.qZA(),t.TgZ(78,"table",23),t.YNc(79,Pe,3,1,"ng-container",24),t.YNc(80,Ge,1,0,"tr",25),t.YNc(81,Fe,1,0,"tr",26),t.qZA(),t.TgZ(82,"button",20),t._uU(83),t.ALo(84,"transloco"),t.qZA(),t.TgZ(85,"button",27),t.NdJ("click",function(){return n.onSave()}),t._uU(86),t.ALo(87,"transloco"),t.qZA(),t.qZA(),t.TgZ(88,"mat-step"),t.YNc(89,Be,2,3,"ng-template",5),t.TgZ(90,"p"),t._uU(91),t.ALo(92,"transloco"),t.qZA(),t.TgZ(93,"p"),t._uU(94),t.ALo(95,"transloco"),t.qZA(),t.TgZ(96,"div"),t.TgZ(97,"button",28),t.NdJ("click",function(){return n.openGroup()}),t._uU(98),t.ALo(99,"transloco"),t.qZA(),t.TgZ(100,"button",29),t.NdJ("click",function(){return t.CHM(i),t.MAs(6).reset()}),t._uU(101),t.ALo(102,"transloco"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const i=t.MAs(25);t.xp6(2),t.Oqu(t.lcZ(3,37,"Award.RuleGeneration")),t.xp6(5),t.Q6J("stepControl",n.firstFormGroup),t.xp6(1),t.Q6J("formGroup",n.firstFormGroup),t.xp6(4),t.Oqu(t.lcZ(13,39,"Award.TargetUser")),t.xp6(3),t.Q6J("ngForOf",n.arTargetUsers),t.xp6(3),t.Oqu(t.lcZ(19,41,"Award.Validity")),t.xp6(2),t.Q6J("rangePicker",i),t.xp6(3),t.Q6J("for",i),t.xp6(5),t.Oqu(t.lcZ(29,43,"Type")),t.xp6(3),t.Q6J("ngForOf",n.arRuleTypes),t.xp6(3),t.Oqu(t.lcZ(35,45,"Common.Description")),t.xp6(5),t.Oqu(t.lcZ(40,47,"Common.Next")),t.xp6(2),t.Q6J("stepControl",n.secondFormGroup),t.xp6(1),t.Q6J("formGroup",n.secondFormGroup),t.xp6(4),t.Oqu(t.lcZ(47,49,"Dimension")),t.xp6(3),t.Q6J("ngForOf",n.dimensions),t.xp6(3),t.Oqu(t.lcZ(53,51,"Common.Previous")),t.xp6(3),t.Oqu(t.lcZ(56,53,"Common.Next")),t.xp6(2),t.Q6J("stepControl",n.thirdFormGroup),t.xp6(1),t.Q6J("formGroup",n.thirdFormGroup),t.xp6(4),t.Oqu(t.lcZ(63,55,"Award.ContinuousDays")),t.xp6(3),t.Q6J("ngForOf",n.contDays),t.xp6(3),t.Oqu(t.lcZ(69,57,"Common.Previous")),t.xp6(3),t.Oqu(t.lcZ(72,59,"Common.Next")),t.xp6(2),t.Q6J("completed",n.pointCompleted),t.xp6(5),t.Q6J("dataSource",n.dataSource),t.xp6(1),t.Q6J("ngForOf",n.displayedColumns),t.xp6(1),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(2),t.Oqu(t.lcZ(84,61,"Common.Previous")),t.xp6(2),t.Q6J("disabled",!n.pointCompleted),t.xp6(1),t.Oqu(t.lcZ(87,63,"Common.Next")),t.xp6(5),t.AsE("",t.lcZ(92,65,"AwardRuleGroupCreatedInfo1"),", ID: ",n.createdGroupID," "),t.xp6(3),t.Oqu(t.lcZ(95,67,"AwardRuleGroupCreatedInfo2")),t.xp6(4),t.Oqu(t.lcZ(99,69,"Common.Display")),t.xp6(3),t.Oqu(t.lcZ(102,71,"Common.CreateAnotherOne"))}},directives:[U.Ye,D.Vq,D.C0,c._Y,c.JL,c.sg,D.VY,h.KE,h.hX,O.gD,c.Q7,c.JJ,c.u,C.sg,N.ey,g.wx,g.zY,c.Fj,g.By,g.nW,h.R9,g._g,k.Nt,x.lW,D.Ic,I.i$,I.Tg,D.fd,l.BZ,l.w1,l.fO,l.ge,C.O5,l.Dz,l.ev,c.wV,c.On,l.as,l.XQ,l.nj,l.Gk],pipes:[A.Ot],styles:[".mat-form-field[_ngcontent-%COMP%]{margin-left:8px}.mat-table[_ngcontent-%COMP%]{margin-left:8px;width:90%;min-height:500px}"]}),e})();var Ee=p(4707),q=p(9224),v=p(1125);function We(e,a){if(1&e&&(t.TgZ(0,"mat-option",28),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.targetUser),t.xp6(1),t.Oqu(o.displayAs)}}function ze(e,a){if(1&e&&(t.TgZ(0,"mat-option",28),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o.value),t.xp6(1),t.Oqu(t.lcZ(2,2,o.i18nterm))}}function je(e,a){1&e&&(t.TgZ(0,"th",29),t._uU(1,"#"),t.qZA())}function Ve(e,a){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.id)}}function Ke(e,a){1&e&&(t.TgZ(0,"th",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.CountRange")))}function Xe(e,a){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.countString)}}function to(e,a){1&e&&(t.TgZ(0,"th",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.Done")))}function eo(e,a){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.doneString)}}function oo(e,a){1&e&&(t.TgZ(0,"th",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.TimeRange")))}function no(e,a){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.timeString)}}function ao(e,a){1&e&&(t.TgZ(0,"th",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.ContinuousDays")))}function io(e,a){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.dayString)}}function ro(e,a){1&e&&(t.TgZ(0,"th",29),t._uU(1),t.ALo(2,"transloco"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Award.Point")))}function lo(e,a){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.point)}}function co(e,a){1&e&&t._UZ(0,"tr",31)}function so(e,a){1&e&&t._UZ(0,"tr",32)}const uo=[{path:"",component:Tt},{path:"rules",component:Rt},{path:"rule-group-display/:id",component:(()=>{class e{constructor(o,n,i,r){this.activateRoute=o,this.uiUtilSrv=n,this.odataSrv=i,this.formBuilder=r,this.routerID=-1,this.arRuleTypes=[],this.dataSource=[],this.displayedColumns=[],this.arRuleTypes=(0,s.dI)(),this.headerFormGroup=this.formBuilder.group({targetuserCtrl:["",c.kI.required],validFromCtrl:[void 0,c.kI.required],validToCtrl:[void 0,c.kI.required],ruleTypeCtrl:[s.rs.GoToBedTime,c.kI.required],despCtrl:["",c.kI.required]})}get arTargetUsers(){return this.odataSrv.currentUserDetail?this.odataSrv.currentUserDetail.awardUsers:[]}getUserDisplayAs(o){if(o&&this.odataSrv.currentUserDetail){const n=this.odataSrv.currentUserDetail.awardUsers.findIndex(i=>i.targetUser===o);if(-1!==n)return this.odataSrv.currentUserDetail.awardUsers[n].displayAs}return""}get isExpertMode(){return this.odataSrv.isLoggedin}ngOnInit(){this.destroyed$=new Ee.t(1),this.activateRoute.url.subscribe({next:o=>{o instanceof Array&&o.length>0&&"rule-group-display"===o[0].path&&(this.routerID=+o[1].path),-1!==this.routerID&&this.odataSrv.readAwardRuleGroup(this.routerID).subscribe({next:n=>{var i,r,d,u,m;switch(null===(i=this.headerFormGroup.get("targetuserCtrl"))||void 0===i||i.setValue(n.targetUser),null===(r=this.headerFormGroup.get("despCtrl"))||void 0===r||r.setValue(n.desp),null===(d=this.headerFormGroup.get("validFromCtrl"))||void 0===d||d.setValue(n.validFrom),null===(u=this.headerFormGroup.get("validToCtrl"))||void 0===u||u.setValue(n.validTo),null===(m=this.headerFormGroup.get("ruleTypeCtrl"))||void 0===m||m.setValue(n.ruleType),this.headerFormGroup.disable(),n.ruleType){case s.rs.BodyExerciseCount:case s.rs.HomeWorkCount:case s.rs.HouseKeepingCount:case s.rs.PoliteBehavior:this.displayedColumns=["id","count","days","point"];break;case s.rs.HandWritingHabit:case s.rs.CleanDeakHabit:case s.rs.ErrorCollectionHabit:this.displayedColumns=["id","done","days","point"];break;default:this.displayedColumns=["id","time","days","point"]}this.dataSource=n.rules.slice()},error:n=>{this.uiUtilSrv.showSnackInfo(n)}})},error:o=>{this.uiUtilSrv.showSnackInfo(o)}})}ngOnDestroy(){this.destroyed$&&(this.destroyed$.complete(),this.destroyed$=void 0)}onReturnToList(){this.uiUtilSrv.navigateAwardRuleGroupListPage()}onCreateNewOne(){this.uiUtilSrv.navigateAwardRuleGenerationPage()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(S.gz),t.Y36(Z.dM),t.Y36(Z.CB),t.Y36(c.qu))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-award-rule-display"]],decls:80,vars:38,consts:[["multi","",1,"example-headers-align"],["expanded",""],[3,"formGroup"],["appearance","fill",1,"control-full-width"],["required","","formControlName","targetuserCtrl"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],[3,"rangePicker"],["matStartDate","","formControlName","validFromCtrl","placeholder","Start date"],["matEndDate","","formControlName","validToCtrl","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],["required","","formControlName","ruleTypeCtrl"],["matInput","","required","","formControlName","despCtrl"],[1,"example-container","mat-elevation-z8"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","count"],["matColumnDef","done"],["matColumnDef","time"],["matColumnDef","days"],["matColumnDef","point"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","",3,"click"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(o,n){if(1&o&&(t.TgZ(0,"mat-card"),t.TgZ(1,"mat-card-header"),t.TgZ(2,"mat-card-title"),t._uU(3),t.ALo(4,"transloco"),t.qZA(),t.qZA(),t.TgZ(5,"mat-card-content"),t.TgZ(6,"mat-accordion",0),t.TgZ(7,"mat-expansion-panel",1),t.TgZ(8,"mat-expansion-panel-header"),t.TgZ(9,"mat-panel-title"),t._uU(10),t.ALo(11,"transloco"),t.qZA(),t.TgZ(12,"mat-panel-description"),t._uU(13),t.ALo(14,"transloco"),t.TgZ(15,"mat-icon"),t._uU(16,"public"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"form",2),t.TgZ(18,"mat-form-field",3),t.TgZ(19,"mat-label"),t._uU(20),t.ALo(21,"transloco"),t.qZA(),t.TgZ(22,"mat-select",4),t.YNc(23,We,2,2,"mat-option",5),t.qZA(),t.qZA(),t.TgZ(24,"mat-form-field",6),t.TgZ(25,"mat-label"),t._uU(26),t.ALo(27,"transloco"),t.qZA(),t.TgZ(28,"mat-date-range-input",7),t._UZ(29,"input",8),t._UZ(30,"input",9),t.qZA(),t._UZ(31,"mat-datepicker-toggle",10),t._UZ(32,"mat-date-range-picker",null,11),t.qZA(),t.TgZ(34,"mat-form-field",3),t.TgZ(35,"mat-label"),t._uU(36),t.ALo(37,"transloco"),t.qZA(),t.TgZ(38,"mat-select",12),t.YNc(39,ze,3,4,"mat-option",5),t.qZA(),t.qZA(),t.TgZ(40,"mat-form-field",3),t.TgZ(41,"mat-label"),t._uU(42),t.ALo(43,"transloco"),t.qZA(),t._UZ(44,"input",13),t.qZA(),t.qZA(),t.qZA(),t.TgZ(45,"mat-expansion-panel"),t.TgZ(46,"mat-expansion-panel-header"),t.TgZ(47,"mat-panel-title"),t._uU(48),t.ALo(49,"transloco"),t.qZA(),t.qZA(),t.TgZ(50,"div",14),t.TgZ(51,"div",15),t.TgZ(52,"table",16),t.ynx(53,17),t.YNc(54,je,2,0,"th",18),t.YNc(55,Ve,2,1,"td",19),t.BQk(),t.ynx(56,20),t.YNc(57,Ke,3,3,"th",18),t.YNc(58,Xe,2,1,"td",19),t.BQk(),t.ynx(59,21),t.YNc(60,to,3,3,"th",18),t.YNc(61,eo,2,1,"td",19),t.BQk(),t.ynx(62,22),t.YNc(63,oo,3,3,"th",18),t.YNc(64,no,2,1,"td",19),t.BQk(),t.ynx(65,23),t.YNc(66,ao,3,3,"th",18),t.YNc(67,io,2,1,"td",19),t.BQk(),t.ynx(68,24),t.YNc(69,ro,3,3,"th",18),t.YNc(70,lo,2,1,"td",19),t.BQk(),t.YNc(71,co,1,0,"tr",25),t.YNc(72,so,1,0,"tr",26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(73,"mat-card-actions"),t.TgZ(74,"button",27),t.NdJ("click",function(){return n.onReturnToList()}),t._uU(75),t.ALo(76,"transloco"),t.qZA(),t.TgZ(77,"button",27),t.NdJ("click",function(){return n.onCreateNewOne()}),t._uU(78),t.ALo(79,"transloco"),t.qZA(),t.qZA(),t.qZA()),2&o){const i=t.MAs(33);t.xp6(3),t.Oqu(t.lcZ(4,18,"Award.Rules")),t.xp6(7),t.Oqu(t.lcZ(11,20,"Header")),t.xp6(3),t.Oqu(t.lcZ(14,22,"HeaderInfo")),t.xp6(4),t.Q6J("formGroup",n.headerFormGroup),t.xp6(3),t.Oqu(t.lcZ(21,24,"Award.TargetUser")),t.xp6(3),t.Q6J("ngForOf",n.arTargetUsers),t.xp6(3),t.Oqu(t.lcZ(27,26,"Award.Validity")),t.xp6(2),t.Q6J("rangePicker",i),t.xp6(3),t.Q6J("for",i),t.xp6(5),t.Oqu(t.lcZ(37,28,"Type")),t.xp6(3),t.Q6J("ngForOf",n.arRuleTypes),t.xp6(3),t.Oqu(t.lcZ(43,30,"Common.Description")),t.xp6(6),t.Oqu(t.lcZ(49,32,"Award.Rules")),t.xp6(4),t.Q6J("dataSource",n.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(3),t.Oqu(t.lcZ(76,34,"Common.ReturnToList")),t.xp6(3),t.Oqu(t.lcZ(79,36,"Common.CreateAnotherOne"))}},directives:[q.a8,q.dk,q.n5,q.dn,v.pp,v.ib,v.yz,v.yK,v.u4,b.Hw,c._Y,c.JL,c.sg,h.KE,h.hX,O.gD,c.Q7,c.JJ,c.u,C.sg,N.ey,g.wx,g.zY,c.Fj,g.By,g.nW,h.R9,g._g,k.Nt,l.BZ,l.w1,l.fO,l.ge,l.Dz,l.ev,l.as,l.XQ,l.nj,l.Gk,q.hq,x.lW],pipes:[A.Ot],styles:[".example-headers-align[_ngcontent-%COMP%]{margin:8px}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%], .example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{flex-basis:0}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{justify-content:space-between;align-items:center}.example-headers-align[_ngcontent-%COMP%]   .mat-select[_ngcontent-%COMP%]{margin-left:8px}.example-headers-align[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%] + .mat-form-field[_ngcontent-%COMP%]{margin-left:8px}table[_ngcontent-%COMP%]{width:100%}"]}),e})()},{path:"rule-generation",component:He},{path:"dailytrace",component:qe}];let mo=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[S.Bz.forChild(uo)],S.Bz]}),e})(),po=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[C.ez,c.u5,c.UX,G.U,A.y4,F.D,mo]]}),e})()}}]);