"use strict";(self.webpackChunkknowledgebuilder=self.webpackChunkknowledgebuilder||[]).push([[82],{4082:(z,v,s)=>{s.r(v),s.d(v,{PreviewModule:()=>Q});var d=s(9808),l=s(3075),m=s(7455),w=s(7607),h=s(4521),a=s(9144),p=s(7399),e=s(5e3),u=s(3984),x=s(4623),f=s(508);let Z=(()=>{class i{constructor(t,n,o){this._bottomSheetRef=t,this.odataSrv=n,this.data=o}createNewScore(t,n){n.preventDefault();const o=new a.oh;o.RefID=this.data.excitemid,o.Score=t,o.User=this.odataSrv.currentUser.getUserId(),this.odataSrv.createExerciseItemUserScore(o).subscribe({next:c=>{this.data.resultFlag=!0,this.data.newScore=c,this._bottomSheetRef.dismiss(this.data)},error:c=>{this.data.resultFlag=!1,this.data.newScore=null,this.data.errorInfo=c,this._bottomSheetRef.dismiss(this.data)}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(p.oL),e.Y36(u.CB),e.Y36(p.OG))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-preview-newscore-sheet"]],decls:19,vars:9,consts:[["mat-list-item","",3,"click"],["mat-line",""]],template:function(t,n){1&t&&(e.TgZ(0,"mat-nav-list"),e.TgZ(1,"a",0),e.NdJ("click",function(c){return n.createNewScore(0,c)}),e.TgZ(2,"span",1),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"span",1),e._uU(6,"Add a new score of 0"),e.qZA(),e.qZA(),e.TgZ(7,"a",0),e.NdJ("click",function(c){return n.createNewScore(60,c)}),e.TgZ(8,"span",1),e._uU(9),e.ALo(10,"transloco"),e.qZA(),e.TgZ(11,"span",1),e._uU(12,"Add a new score of 60"),e.qZA(),e.qZA(),e.TgZ(13,"a",0),e.NdJ("click",function(c){return n.createNewScore(100,c)}),e.TgZ(14,"span",1),e._uU(15),e.ALo(16,"transloco"),e.qZA(),e.TgZ(17,"span",1),e._uU(18,"Add a new score of 100"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.hij("",e.lcZ(4,3,"NewPractice"),": 0"),e.xp6(6),e.hij("",e.lcZ(10,5,"NewPractice"),": 60"),e.xp6(6),e.hij("",e.lcZ(16,7,"NewPractice"),": 100"))},directives:[x.Hk,x.Tg,f.X2],pipes:[m.Ot],encapsulation:2}),i})();var _=s(5113),P=s(7423),T=s(4834),g=s(9354),A=s(7446),S=s(7238),b=s(3489),I=s(8029);function C(i,r){if(1&i&&(e.TgZ(0,"div",3),e.TgZ(1,"h3"),e._uU(2),e.qZA(),e._UZ(3,"mat-divider"),e.TgZ(4,"h3"),e._uU(5),e.ALo(6,"transloco"),e.qZA(),e._UZ(7,"mat-divider"),e.TgZ(8,"div",4),e._UZ(9,"markdown",5),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.hij("ID: ",t.selectedKnowledge.ID,""),e.xp6(3),e.AsE("",e.lcZ(6,5,"Title"),": ",t.selectedKnowledge.Title,""),e.xp6(4),e.Q6J("data",t.selectedKnowledge.Content)("katexOptions",t.mathOptions)}}function U(i,r){1&i&&(e.TgZ(0,"mat-label",15),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"FontSize")))}function O(i,r){if(1&i&&(e.TgZ(0,"mat-label"),e.TgZ(1,"span"),e._uU(2),e.qZA(),e._uU(3),e.ALo(4,"date"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Tol(t.isSuccessScore?"success-score":"fail-score"),e.xp6(1),e.Oqu(t.selectedExerciseUserScore.Score),e.xp6(1),e.hij(" (",e.xi3(4,4,t.selectedExerciseUserScore.TakenDate,"yyyy-M-d"),")")}}function M(i,r){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij("ID: ",t.selectedExercise.ID,"")}}function N(i,r){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"transloco"),e.ALo(3,"transloco"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.AsE("",e.lcZ(2,2,"Type"),": ",e.lcZ(3,4,t.getExerciseItemTypeName(t.selectedExercise.ItemType)),"")}}function y(i,r){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.AsE("",e.lcZ(2,2,"Tags"),": ",t.selectedExercise.Tags.toString(),"")}}function E(i,r){1&i&&e._UZ(0,"mat-divider")}function J(i,r){if(1&i&&(e.TgZ(0,"div",13),e._UZ(1,"mat-divider"),e.TgZ(2,"h3"),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e._UZ(5,"markdown",5),e.qZA()),2&i){const t=e.oxw(2);e.Udp("font-size",t.fontSize,"px"),e.xp6(3),e.Oqu(e.lcZ(4,5,"Answer")),e.xp6(2),e.Q6J("data",t.selectedExercise.Answer)("katexOptions",t.mathOptions)}}function j(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",3),e.TgZ(1,"div",6),e.TgZ(2,"mat-checkbox",7),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().focusMode=o}),e.ALo(3,"transloco"),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.TgZ(6,"mat-checkbox",8),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().hideAnswer=o}),e.ALo(7,"transloco"),e._uU(8),e.ALo(9,"transloco"),e.qZA(),e.YNc(10,U,3,3,"mat-label",9),e.TgZ(11,"mat-slider",10),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().fontSize=o}),e.ALo(12,"transloco"),e.qZA(),e.qZA(),e.TgZ(13,"div",6),e.YNc(14,O,5,7,"mat-label",11),e.TgZ(15,"button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw().onNewScore()}),e._uU(16),e.ALo(17,"transloco"),e.qZA(),e.qZA(),e._UZ(18,"mat-divider"),e.YNc(19,M,2,1,"h3",11),e.YNc(20,N,4,6,"h3",11),e.YNc(21,y,3,4,"h3",11),e.YNc(22,E,1,0,"mat-divider",11),e.TgZ(23,"div",13),e.TgZ(24,"h3"),e._uU(25),e.ALo(26,"transloco"),e.qZA(),e._UZ(27,"markdown",5),e.qZA(),e.YNc(28,J,6,7,"div",14),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.s9C("matTooltip",e.lcZ(3,21,"FocusMode")),e.Q6J("ngModel",t.focusMode),e.xp6(2),e.Oqu(e.lcZ(5,23,"FocusMode")),e.xp6(2),e.s9C("matTooltip",e.lcZ(7,25,"QuizMode")),e.Q6J("ngModel",t.hideAnswer),e.xp6(2),e.Oqu(e.lcZ(9,27,"QuizMode")),e.xp6(2),e.Q6J("ngIf",!t.mobileQuery.matches),e.xp6(1),e.s9C("matTooltip",e.lcZ(12,29,"FontSize")),e.Q6J("ngModel",t.fontSize),e.xp6(3),e.Q6J("ngIf",t.selectedExerciseUserScore),e.xp6(2),e.Oqu(e.lcZ(17,31,"NewPractice")),e.xp6(3),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Q6J("ngIf",!t.focusMode),e.xp6(1),e.Udp("font-size",t.fontSize,"px"),e.xp6(2),e.Oqu(e.lcZ(26,33,"Content")),e.xp6(2),e.Q6J("data",t.selectedExercise.Content)("katexOptions",t.mathOptions),e.xp6(1),e.Q6J("ngIf",!t.hideAnswer)}}const q=[{path:"",component:(()=>{class i{constructor(t,n,o,c,k){this.odataSvc=t,this._bottomSheet=c,this.uiUtilSrv=k,this.selectedExerciseUserScore=null,this.listPreviewObjects=[],this.mathOptions={displayMode:!0,throwOnError:!1,errorColor:"#cc0000"},this.focusMode=!1,this.hideAnswer=!1,this.fontSize=20,this.mobileQuery=o.matchMedia("(max-width: 600px)"),this._mobileQueryListener=()=>n.detectChanges(),this.previewIdx=-1}getExerciseItemTypeName(t){return(0,a.of)(t)}get isSuccessScore(){return null!==this.selectedExerciseUserScore&&this.selectedExerciseUserScore.Score>=60}ngOnInit(){this.mobileQuery.addEventListener("change",this._mobileQueryListener),this.listPreviewObjects=this.uiUtilSrv.previewObjList.slice(),this.uiUtilSrv.previewObjList=[],this.listPreviewObjects.length>0&&(this.previewIdx=-1,this.onNextPreviewItem())}ngOnDestroy(){this.mobileQuery.removeEventListener("change",this._mobileQueryListener)}onPreviousPreviewItem(){this.previewIdx>0&&(this.previewIdx--,this.selectedObj=this.listPreviewObjects[this.previewIdx],this.fetchPreviewItem())}onNextPreviewItem(){this.previewIdx<this.listPreviewObjects.length&&(this.previewIdx++,this.selectedObj=this.listPreviewObjects[this.previewIdx],this.fetchPreviewItem())}get isNextPreviewButtonEnabled(){return this.previewIdx<this.listPreviewObjects.length-1}get isPreviousButtonEnabled(){return this.previewIdx>0}fetchPreviewItem(){var t,n;this.previewIdx>-1&&this.previewIdx<this.listPreviewObjects.length&&((null===(t=this.selectedObj)||void 0===t?void 0:t.refType)===a.ik.KnowledgeItem?this.odataSvc.readKnowledgeItem(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:o=>{this.selectedKnowledge=o},error:o=>{this.uiUtilSrv.showSnackInfo(o)}}):(null===(n=this.selectedObj)||void 0===n?void 0:n.refType)===a.ik.ExerciseItem&&(this.odataSvc.readExerciseItem(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:o=>{this.selectedExercise=o},error:o=>{this.uiUtilSrv.showSnackInfo(o)}}),this.odataSvc.getLastestExerciseItemUserScore(this.listPreviewObjects[this.previewIdx].refId).subscribe({next:o=>{this.selectedExerciseUserScore=o},error:o=>{this.uiUtilSrv.showSnackInfo(o)}})))}onNewScore(){var t;this._bottomSheet.open(Z,{data:{excitemid:null===(t=this.selectedExercise)||void 0===t?void 0:t.ID}}).afterDismissed().subscribe(o=>{o.resultFlag?o.newScore&&(this.selectedExerciseUserScore=o.newScore):this.uiUtilSrv.showSnackInfo(o.errorInfo)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.CB),e.Y36(e.sBO),e.Y36(_.vx),e.Y36(p.ch),e.Y36(u.dM))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-preview"]],decls:22,vars:22,consts:[[1,"button-row"],["mat-raised-button","",3,"disabled","click"],["class","mat-typography","style","margin: 8px;",4,"ngIf"],[1,"mat-typography",2,"margin","8px"],[1,"control-full-width",2,"margin-top","16px","font-size","large"],["katex","",3,"data","katexOptions"],[1,"button-row",2,"margin","8px"],["color","primary","name","focusmode",2,"margin-left","4px",3,"ngModel","matTooltip","ngModelChange"],["color","primary","name","quizmode",2,"margin-left","4px",3,"ngModel","matTooltip","ngModelChange"],["style","margin-left: 4px;",4,"ngIf"],["thumbLabel","","step","2","min","10","max","40",3,"ngModel","matTooltip","ngModelChange"],[4,"ngIf"],["mat-raised-button","",3,"click"],[1,"control-full-width",2,"margin-top","16px"],["class","control-full-width","style","margin-top: 16px;",3,"font-size",4,"ngIf"],[2,"margin-left","4px"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return n.onPreviousPreviewItem()}),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.TgZ(6,"button",1),e.NdJ("click",function(){return n.onNextPreviewItem()}),e._uU(7),e.ALo(8,"transloco"),e.qZA(),e.qZA(),e._UZ(9,"mat-divider"),e.YNc(10,C,10,7,"div",2),e.YNc(11,j,29,35,"div",2),e._UZ(12,"mat-divider"),e.TgZ(13,"div",0),e.TgZ(14,"div"),e._uU(15),e.qZA(),e.TgZ(16,"button",1),e.NdJ("click",function(){return n.onPreviousPreviewItem()}),e._uU(17),e.ALo(18,"transloco"),e.qZA(),e.TgZ(19,"button",1),e.NdJ("click",function(){return n.onNextPreviewItem()}),e._uU(20),e.ALo(21,"transloco"),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.AsE(" ",n.previewIdx+1," / ",n.listPreviewObjects.length,""),e.xp6(1),e.Q6J("disabled",!n.isPreviousButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(5,14,"Common.Previous")),e.xp6(2),e.Q6J("disabled",!n.isNextPreviewButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(8,16,"Common.Next")),e.xp6(3),e.Q6J("ngIf",n.selectedObj&&1===n.selectedObj.refType&&n.selectedKnowledge),e.xp6(1),e.Q6J("ngIf",n.selectedObj&&2===n.selectedObj.refType&&n.selectedExercise),e.xp6(4),e.AsE(" ",n.previewIdx+1," / ",n.listPreviewObjects.length,""),e.xp6(1),e.Q6J("disabled",!n.isPreviousButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(18,18,"Common.Previous")),e.xp6(2),e.Q6J("disabled",!n.isNextPreviewButtonEnabled),e.xp6(1),e.Oqu(e.lcZ(21,20,"Common.Next")))},directives:[P.lW,T.d,d.O5,g.lF,A.oG,l.JJ,l.On,S.gM,b.hX,I.pH],pipes:[m.Ot,d.uU],styles:[".button-row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.button-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:16px}.input-fontsize[_ngcontent-%COMP%]{margin-left:24px;width:100px}mat-slide-toggle[_ngcontent-%COMP%]{width:80px}mat-slider[_ngcontent-%COMP%]{margin-left:8px;width:80px}.success-score[_ngcontent-%COMP%]{color:green;font-size:16px}.fail-score[_ngcontent-%COMP%]{color:red;font-size:16px}"]}),i})()}];let L=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[h.Bz.forChild(q)],h.Bz]}),i})(),Q=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.ez,l.u5,l.UX,m.y4,w.U,g.JP,L]]}),i})()}}]);